<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>BIND 10 Guide</title><link rel="stylesheet" href="./bind10-guide.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><meta name="description" content="BIND 10 is a framework that features Domain Name System (DNS) suite and Dynamic Host Configuration Protocol (DHCP) servers with development managed by Internet Systems Consortium (ISC). It includes DNS libraries, modular components for controlling authoritative and recursive DNS servers, and experimental DHCPv4 and DHCPv6 servers. This is the reference guide for BIND 10 version 1.1.0. The most up-to-date version of this document (in PDF, HTML, and plain text formats), along with other documents for BIND 10, can be found at ."></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book" title="BIND 10 Guide"><div class="titlepage"><div><div><h1 class="title"><a name="idm65813424"></a>BIND 10 Guide</h1></div><div><h2 class="subtitle">Administrator Reference for BIND 10</h2></div><div><p class="releaseinfo">This is the reference guide for BIND 10 version
        1.1.0.</p></div><div><p class="copyright">Copyright © 2010-2013 Internet Systems Consortium, Inc.</p></div><div><div class="abstract" title="Abstract"><p class="title"><b>Abstract</b></p><p>BIND 10 is a framework that features Domain Name System
      (DNS) suite and Dynamic Host Configuration Protocol (DHCP)
      servers with development managed by Internet Systems Consortium (ISC).
      It includes DNS libraries, modular components for controlling
      authoritative and recursive DNS servers, and experimental DHCPv4
      and DHCPv6 servers.
      </p><p>
        This is the reference guide for BIND 10 version 1.1.0.
        The most up-to-date version of this document (in PDF, HTML,
        and plain text formats), along with other documents for
        BIND 10, can be found at <a class="ulink" href="http://bind10.isc.org/docs" target="_top">http://bind10.isc.org/docs</a>.
        </p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="preface"><a href="#idm65541424">Preface</a></span></dt><dd><dl><dt><span class="section"><a href="#acknowledgements">1. Acknowledgements</a></span></dt></dl></dd><dt><span class="chapter"><a href="#intro">1. Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#idm65352880">1.1. Supported Platforms</a></span></dt><dt><span class="section"><a href="#required-software">1.2. Required Software at Run-time</a></span></dt><dt><span class="section"><a href="#starting_stopping">1.3. Starting and Stopping the Server</a></span></dt><dt><span class="section"><a href="#managing_once_running">1.4. Managing BIND 10</a></span></dt></dl></dd><dt><span class="chapter"><a href="#quickstart">2. Quick start</a></span></dt><dd><dl><dt><span class="section"><a href="#quick-start-auth-dns">2.1. Quick start guide for authoritative DNS service</a></span></dt></dl></dd><dt><span class="chapter"><a href="#installation">3. Installation</a></span></dt><dd><dl><dt><span class="section"><a href="#packages">3.1. Packages</a></span></dt><dt><span class="section"><a href="#install-hierarchy">3.2. Install Hierarchy</a></span></dt><dt><span class="section"><a href="#build-requirements">3.3. Building Requirements</a></span></dt><dt><span class="section"><a href="#install">3.4. Installation from source</a></span></dt><dd><dl><dt><span class="section"><a href="#idm67049264">3.4.1. Download Tar File</a></span></dt><dt><span class="section"><a href="#idm67046960">3.4.2. Retrieve from Git</a></span></dt><dt><span class="section"><a href="#configure">3.4.3. Configure before the build</a></span></dt><dt><span class="section"><a href="#idm67024560">3.4.4. Build</a></span></dt><dt><span class="section"><a href="#idm67022768">3.4.5. Install</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#bind10">4. Starting BIND 10 with <span class="command"><strong>bind10</strong></span></a></span></dt><dd><dl><dt><span class="section"><a href="#start">4.1. Starting BIND 10</a></span></dt></dl></dd><dt><span class="chapter"><a href="#msgq">5. Command channel</a></span></dt><dt><span class="chapter"><a href="#cfgmgr">6. Configuration manager</a></span></dt><dt><span class="chapter"><a href="#cmdctl">7. Remote control daemon</a></span></dt><dd><dl><dt><span class="section"><a href="#cmdctl.spec">7.1. Configuration specification for b10-cmdctl</a></span></dt></dl></dd><dt><span class="chapter"><a href="#bindctl">8. Control and configure user interface</a></span></dt><dd><dl><dt><span class="section"><a href="#bindctl_commandline_options">8.1. bindctl command-line options</a></span></dt><dt><span class="section"><a href="#bindctl_general_syntax">8.2. General syntax of bindctl commands</a></span></dt><dt><span class="section"><a href="#bindctl_help">8.3. Bindctl help</a></span></dt><dt><span class="section"><a href="#bindctl_command_arguments">8.4. Command arguments</a></span></dt><dt><span class="section"><a href="#bindctl_module_commands">8.5. Module commands</a></span></dt><dt><span class="section"><a href="#idm66896944">8.6. Configuration commands</a></span></dt><dd><dl><dt><span class="section"><a href="#bindctl_configuration_command_list">8.6.1. List of configuration commands</a></span></dt><dt><span class="section"><a href="#bindctl_configuration_data_types">8.6.2. Configuration data types</a></span></dt></dl></dd><dt><span class="section"><a href="#idm66828080">8.7. The execute command</a></span></dt><dd><dl><dt><span class="section"><a href="#bindctl_execute_directives">8.7.1. Execute directives</a></span></dt><dt><span class="section"><a href="#bindctl_execute_notes">8.7.2. Notes on execute scripts</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#common">9. Common configuration elements</a></span></dt><dd><dl><dt><span class="section"><a href="#common-tsig">9.1. TSIG keys</a></span></dt><dd><dl><dt><span class="section"><a href="#tsig-key-syntax">9.1.1. Key anatomy and syntax</a></span></dt><dt><span class="section"><a href="#tsig-key-ring">9.1.2. Key ring</a></span></dt></dl></dd><dt><span class="section"><a href="#common-acl">9.2. ACLs</a></span></dt><dd><dl><dt><span class="section"><a href="#idm66783280">9.2.1. Matching properties</a></span></dt><dt><span class="section"><a href="#idm66780592">9.2.2. More complicated matches</a></span></dt><dt><span class="section"><a href="#idm66778160">9.2.3. Examples</a></span></dt><dt><span class="section"><a href="#idm66774576">9.2.4. Interaction with <span class="command"><strong>bindctl</strong></span></a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#bind10.config">10. bind10 Control and Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#bind10.shutdown">10.1. Stopping bind10</a></span></dt><dt><span class="section"><a href="#bind10.components">10.2. Configuration to start processes</a></span></dt></dl></dd><dt><span class="chapter"><a href="#authserver">11. Authoritative Server</a></span></dt><dd><dl><dt><span class="section"><a href="#idm66731952">11.1. Server Configurations</a></span></dt><dt><span class="section"><a href="#datasrc">11.2. Data Source Backends</a></span></dt><dd><dl><dt><span class="section"><a href="#datasource-types">11.2.1. Data source types</a></span></dt><dt><span class="section"><a href="#datasrc-examples">11.2.2. Examples</a></span></dt></dl></dd><dt><span class="section"><a href="#idm66675376">11.3. Loading Master Zones Files</a></span></dt></dl></dd><dt><span class="chapter"><a href="#xfrin">12. Incoming Zone Transfers</a></span></dt><dd><dl><dt><span class="section"><a href="#idm66661296">12.1. Configuration for Incoming Zone Transfers</a></span></dt><dt><span class="section"><a href="#idm66656816">12.2. TSIG</a></span></dt><dt><span class="section"><a href="#idm66654768">12.3. Enabling IXFR</a></span></dt><dt><span class="section"><a href="#zonemgr">12.4. Secondary Manager</a></span></dt><dt><span class="section"><a href="#idm66642096">12.5. Trigger an Incoming Zone Transfer Manually</a></span></dt><dt><span class="section"><a href="#idm66638896">12.6. Incoming Transfers with In-memory Datasource</a></span></dt></dl></dd><dt><span class="chapter"><a href="#xfrout">13. Outbound Zone Transfers</a></span></dt><dt><span class="chapter"><a href="#ddns">14. Dynamic DNS Update</a></span></dt><dd><dl><dt><span class="section"><a href="#idm66614960">14.1. Enabling Dynamic Update</a></span></dt><dt><span class="section"><a href="#idm66602544">14.2. Access Control</a></span></dt><dt><span class="section"><a href="#idm66579888">14.3. Miscellaneous Operational Issues</a></span></dt></dl></dd><dt><span class="chapter"><a href="#resolverserver">15. Recursive Name Server</a></span></dt><dd><dl><dt><span class="section"><a href="#idm66554160">15.1. Access Control</a></span></dt><dt><span class="section"><a href="#idm66548912">15.2. Forwarding</a></span></dt></dl></dd><dt><span class="chapter"><a href="#dhcp">16. DHCP</a></span></dt><dd><dl><dt><span class="section"><a href="#dhcp-install-configure">16.1. DHCP Database Installation and Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#idm66539312">16.1.1. Install MySQL</a></span></dt><dt><span class="section"><a href="#idm66538032">16.1.2. Build and Install BIND 10</a></span></dt><dt><span class="section"><a href="#dhcp-database-create">16.1.3. Create MySQL Database and BIND 10 User</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#dhcp4">17. The DHCPv4 Server</a></span></dt><dd><dl><dt><span class="section"><a href="#dhcp4-start-stop">17.1. Starting and Stopping the DHCPv4 Server</a></span></dt><dt><span class="section"><a href="#dhcp4-configuration">17.2. Configuring the DHCPv4 Server</a></span></dt><dd><dl><dt><span class="section"><a href="#idm66502448">17.2.1. Database Configuration</a></span></dt><dt><span class="section"><a href="#dhcp4-address-config">17.2.2. Configuration of Address Pools</a></span></dt><dt><span class="section"><a href="#dhcp4-std-options">17.2.3. Standard DHCPv4 options</a></span></dt><dt><span class="section"><a href="#dhcp4-custom-options">17.2.4. Custom DHCPv4 options</a></span></dt><dt><span class="section"><a href="#dhcp4-vendor-opts">17.2.5. DHCPv4 vendor specific options</a></span></dt><dt><span class="section"><a href="#dhcp4-option-spaces">17.2.6. Nested DHCPv4 options (custom option spaces)</a></span></dt></dl></dd><dt><span class="section"><a href="#dhcp4-serverid">17.3. Server Identifier in DHCPv4</a></span></dt><dt><span class="section"><a href="#dhcp4-std">17.4. Supported Standards</a></span></dt><dt><span class="section"><a href="#dhcp4-limit">17.5. DHCPv4 Server Limitations</a></span></dt></dl></dd><dt><span class="chapter"><a href="#dhcp6">18. The DHCPv6 Server</a></span></dt><dd><dl><dt><span class="section"><a href="#dhcp6-start-stop">18.1. Starting and Stopping the DHCPv6 Server</a></span></dt><dt><span class="section"><a href="#dhcp6-configuration">18.2. DHCPv6 Server Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#idm64310576">18.2.1. Database Configuration</a></span></dt><dt><span class="section"><a href="#idm63165104">18.2.2. Subnet and Address Pool</a></span></dt><dt><span class="section"><a href="#dhcp6-std-options">18.2.3. Standard DHCPv6 options</a></span></dt><dt><span class="section"><a href="#dhcp6-custom-options">18.2.4. Custom DHCPv6 options</a></span></dt><dt><span class="section"><a href="#dhcp6-vendor-opts">18.2.5. DHCPv6 vendor specific options</a></span></dt><dt><span class="section"><a href="#dhcp6-option-spaces">18.2.6. Nested DHCPv6 options (custom option spaces)</a></span></dt><dt><span class="section"><a href="#dhcp6-config-subnets">18.2.7. Subnet Selection</a></span></dt></dl></dd><dt><span class="section"><a href="#dhcp6-serverid">18.3. Server Identifier in DHCPv6</a></span></dt><dt><span class="section"><a href="#dhcp6-std">18.4. Supported Standards</a></span></dt><dt><span class="section"><a href="#dhcp6-limit">18.5. DHCPv6 Server Limitations</a></span></dt></dl></dd><dt><span class="chapter"><a href="#libdhcp">19. libdhcp++ library</a></span></dt><dd><dl><dt><span class="section"><a href="#iface-detect">19.1. Interface detection</a></span></dt></dl></dd><dt><span class="chapter"><a href="#statistics">20. Statistics</a></span></dt><dt><span class="chapter"><a href="#logging">21. Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#idm68223536">21.1. Logging configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#idm68222256">21.1.1. Loggers</a></span></dt><dt><span class="section"><a href="#idm68180784">21.1.2. Output Options</a></span></dt><dt><span class="section"><a href="#idm68158768">21.1.3. Example session</a></span></dt></dl></dd><dt><span class="section"><a href="#idm68133552">21.2. Logging Message Format</a></span></dt></dl></dd></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>10.1. <a href="#idm66757552">Special startup components</a></dt><dt>17.1. <a href="#dhcp4-std-options-list">List of standard DHCPv4 options</a></dt><dt>17.2. <a href="#dhcp-types">List of standard DHCP option types</a></dt><dt>18.1. <a href="#dhcp6-std-options-list">List of standard DHCPv6 options</a></dt></dl></div><div class="preface" title="Preface"><div class="titlepage"><div><div><h2 class="title"><a name="idm65541424"></a>Preface</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#acknowledgements">1. Acknowledgements</a></span></dt></dl></div><div class="section" title="1. Acknowledgements"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="acknowledgements"></a>1. Acknowledgements</h2></div></div></div><p>BIND 10 is a sponsored development project, and would not
      be possible without the generous support of the sponsors.</p><p><a class="ulink" href="http://jprs.co.jp/" target="_top">JPRS</a> and
      <a class="ulink" href="http://cira.ca/" target="_top">CIRA</a> are Patron Level
      sponsors.</p><p><a class="ulink" href="https://www.afnic.fr/" target="_top">AFNIC</a>,
      <a class="ulink" href="https://www.cnnic.net.cn/" target="_top">CNNIC</a>,
      <a class="ulink" href="https://www.nic.cz/" target="_top">CZ.NIC</a>,
      <a class="ulink" href="http://www.denic.de/" target="_top">DENIC eG</a>,
      <a class="ulink" href="https://www.google.com/" target="_top">Google</a>,
      <a class="ulink" href="https://www.ripe.net/" target="_top">RIPE NCC</a>,
      <a class="ulink" href="https://registro.br/" target="_top">Registro.br</a>,
      <a class="ulink" href="https://nzrs.net.nz/" target="_top">.nz Registry Services</a>, and
      <a class="ulink" href="https://www.tcinet.ru/" target="_top">Technical Center of Internet</a>
      are current sponsors.</p><p><a class="ulink" href="https://www.afilias.info/" target="_top">Afilias</a>,
      <a class="ulink" href="https://www.iis.se/" target="_top">IIS.SE</a>,
      <a class="ulink" href="http://www.nominet.org.uk/" target="_top">Nominet</a>, and
      <a class="ulink" href="https://www.sidn.nl/" target="_top">SIDN</a> were founding
      sponsors of the project.</p><p>Support for BIND 10 development of the DHCPv4 and DHCPv6
      components is provided by
      <a class="ulink" href="http://www.comcast.com/" target="_top">Comcast</a>.</p></div></div><div class="chapter" title="Chapter 1. Introduction"><div class="titlepage"><div><div><h2 class="title"><a name="intro"></a>Chapter 1. Introduction</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#idm65352880">1.1. Supported Platforms</a></span></dt><dt><span class="section"><a href="#required-software">1.2. Required Software at Run-time</a></span></dt><dt><span class="section"><a href="#starting_stopping">1.3. Starting and Stopping the Server</a></span></dt><dt><span class="section"><a href="#managing_once_running">1.4. Managing BIND 10</a></span></dt></dl></div><p>
      BIND is the popular implementation of a DNS server, developer
      interfaces, and DNS tools.
      BIND 10 is a rewrite of BIND 9 and ISC DHCP.
      BIND 10 is written in C++ and Python and provides a modular
      environment for serving, maintaining, and developing DNS and DHCP.
      BIND 10 provides a EDNS0- and DNSSEC-capable authoritative
      DNS server and a caching recursive name server which also
      provides forwarding.
      It also provides experimental DHCPv4 and DHCPv6 servers.
    </p><p>
      This guide covers BIND 10 version 1.1.0.
    </p><div class="section" title="1.1. Supported Platforms"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm65352880"></a>1.1. Supported Platforms</h2></div></div></div><p>
  BIND 10 builds have been tested on (in no particular order)
  Debian GNU/Linux 6 and unstable, Ubuntu 9.10, NetBSD 5,
  Solaris 10 and 11, FreeBSD 7 and 8, CentOS Linux 5.3,
  MacOS 10.6 and 10.7, and OpenBSD 5.1.

  It has been tested on Sparc, i386, and amd64 hardware
  platforms.

        It is planned for BIND 10 to build, install and run on
        Windows and standard Unix-type platforms.
      </p></div><div class="section" title="1.2. Required Software at Run-time"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="required-software"></a>1.2. Required Software at Run-time</h2></div></div></div><p>
        Running BIND 10 uses various extra software which may
        not be provided in some operating systems' default
        installations nor standard packages collections. You may
        need to install this required software separately.
        (For the build requirements, also see
        <a class="xref" href="#build-requirements" title="3.3. Building Requirements">Section 3.3, &#8220;Building Requirements&#8221;</a>.)
      </p><p>
        BIND 10 requires at least Python 3.1
        (<a class="ulink" href="http://www.python.org/" target="_top">http://www.python.org/</a>).
        It also works with Python 3.2.
      </p><p>
        BIND 10 uses the Botan crypto library for C++
        (<a class="ulink" href="http://botan.randombit.net/" target="_top">http://botan.randombit.net/</a>).
        It requires at least Botan version 1.8.
      </p><p>
        BIND 10 uses the log4cplus C++ logging library
        (<a class="ulink" href="http://log4cplus.sourceforge.net/" target="_top">http://log4cplus.sourceforge.net/</a>).
        It requires at least log4cplus version 1.0.3.

      </p><p>
        The authoritative DNS server uses SQLite3
        (<a class="ulink" href="http://www.sqlite.org/" target="_top">http://www.sqlite.org/</a>).

        It needs at least SQLite version 3.3.9.
      </p><p>
        The <span class="command"><strong>b10-ddns</strong></span>, <span class="command"><strong>b10-xfrin</strong></span>,
        <span class="command"><strong>b10-xfrout</strong></span>, and <span class="command"><strong>b10-zonemgr</strong></span>
        components require the libpython3 library and the Python
        _sqlite3.so module (which is included with Python).
        Python modules need to be built for the corresponding Python 3.
      </p></div><div class="section" title="1.3. Starting and Stopping the Server"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="starting_stopping"></a>1.3. Starting and Stopping the Server</h2></div></div></div><p>
        BIND 10 is modular.  Part of this modularity is
        accomplished using multiple cooperating processes which, together,
        provide the server functionality.  This is a change from
        the previous generation of BIND software, which used a
        single process.
      </p><p>
        At first, running many different processes may seem confusing.
        However, these processes are started by running a single
	command, <span class="command"><strong>bind10</strong></span>.  This command starts
	a master process, <span class="command"><strong>b10-init</strong></span>, which will
	start other required processes and other processes when
	configured.  The processes that may be started have names
	starting with "b10-", including:
      </p><p>

        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
              <span class="command"><strong>b10-auth</strong></span> &#8212;
              Authoritative DNS server.
              This process serves DNS requests.
            </li><li class="listitem">
              <span class="command"><strong>b10-cfgmgr</strong></span> &#8212;
              Configuration manager.
              This process maintains all of the configuration for BIND 10.
            </li><li class="listitem">
              <span class="command"><strong>b10-cmdctl</strong></span> &#8212;
              Command and control service.
              This process allows external control of the BIND 10 system.
            </li><li class="listitem">
              <span class="command"><strong>b10-ddns</strong></span> &#8212;
              Dynamic DNS update service.
              This process is used to handle incoming DNS update
              requests to allow granted clients to update zones
	      for which BIND 10 is serving as a primary server.
            </li><li class="listitem">
              <span class="command"><strong>b10-msgq</strong></span> &#8212;
              Message bus daemon.
              This process coordinates communication between all of the other
              BIND 10 processes.
            </li><li class="listitem">
              <span class="command"><strong>b10-resolver</strong></span> &#8212;
              Recursive name server.
              This process handles incoming DNS queries and provides
              answers from its cache or by recursively doing remote lookups.
              (This is an experimental proof of concept.)
            </li><li class="listitem">
              <span class="command"><strong>b10-sockcreator</strong></span> &#8212;
              Socket creator daemon.
              This process creates sockets used by
              network-listening BIND 10 processes.
            </li><li class="listitem">
              <span class="command"><strong>b10-stats</strong></span> &#8212;
              Statistics collection daemon.
              This process collects and reports statistics data.
            </li><li class="listitem">
              <span class="command"><strong>b10-stats-httpd</strong></span> &#8212;
              HTTP server for statistics reporting.
              This process reports statistics data in XML format over HTTP.
            </li><li class="listitem">
              <span class="command"><strong>b10-xfrin</strong></span> &#8212;
              Incoming zone transfer service.
              This process is used to transfer a new copy
              of a zone into BIND 10, when acting as a secondary server.
            </li><li class="listitem">
              <span class="command"><strong>b10-xfrout</strong></span> &#8212;
              Outgoing zone transfer service.
              This process is used to handle transfer requests to
              send a local zone to a remote secondary server.
            </li><li class="listitem">
              <span class="command"><strong>b10-zonemgr</strong></span> &#8212;
              Secondary zone manager.
              This process keeps track of timers and other
              necessary information for BIND 10 to act as a slave server.
            </li></ul></div><p>
      </p><p>
        These do not need to be manually started independently.
      </p></div><div class="section" title="1.4. Managing BIND 10"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="managing_once_running"></a>1.4. Managing BIND 10</h2></div></div></div><p>
        Once BIND 10 is running, a few commands are used to interact
        directly with the system:
        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
              <span class="command"><strong>bindctl</strong></span> &#8212;
              Interactive administration interface.
              This is a low-level command-line tool which allows
              a developer or an experienced administrator to control
              BIND 10.
            </li><li class="listitem">
              <span class="command"><strong>b10-loadzone</strong></span> &#8212;
              Zone file loader.
              This tool will load standard masterfile-format zone files into
              BIND 10.
            </li><li class="listitem">
              <span class="command"><strong>b10-cmdctl-usermgr</strong></span> &#8212;
              User access control.
              This tool allows an administrator to authorize additional users
              to manage BIND 10.
            </li></ul></div><p>
      </p></div><p>
      The tools and modules are covered in full detail in this guide.

      In addition, manual pages are also provided in the default installation.
    </p><p>
      BIND 10 also provides libraries and programmer interfaces
      for C++ and Python for the message bus, configuration backend,
      and, of course, DNS. These include detailed developer
      documentation and code examples.


    </p></div><div class="chapter" title="Chapter 2. Quick start"><div class="titlepage"><div><div><h2 class="title"><a name="quickstart"></a>Chapter 2. Quick start</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#quick-start-auth-dns">2.1. Quick start guide for authoritative DNS service</a></span></dt></dl></div><p>
        This quickly covers the standard steps for installing
        and deploying BIND 10.
        For further details, full customizations, and troubleshooting,
        see the respective chapters in the BIND 10 guide.
    </p><div class="section" title="2.1. Quick start guide for authoritative DNS service"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="quick-start-auth-dns"></a>2.1. Quick start guide for authoritative DNS service</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
            Install required run-time and build dependencies.
          </li><li class="listitem">
            Download the BIND 10 source tar file from
            <a class="ulink" href="ftp://ftp.isc.org/isc/bind10/" target="_top">ftp://ftp.isc.org/isc/bind10/</a>.
          </li><li class="listitem"><p>Extract the tar file:
          </p><pre class="screen">$ <strong class="userinput"><code>gzcat bind10-<em class="replaceable"><code>VERSION</code></em>.tar.gz | tar -xvf -</code></strong></pre><p>
          </p></li><li class="listitem"><p>Go into the source and run configure:
            </p><pre class="screen">$ <strong class="userinput"><code>cd bind10-<em class="replaceable"><code>VERSION</code></em></code></strong>
  $ <strong class="userinput"><code>./configure</code></strong></pre><p>
          </p></li><li class="listitem"><p>Build it:
            </p><pre class="screen">$ <strong class="userinput"><code>make</code></strong></pre><p>
          </p></li><li class="listitem"><p>Install it as root (to default /usr/local):
            </p><pre class="screen">$ <strong class="userinput"><code>make install</code></strong></pre><p>
          </p></li><li class="listitem"><p>Create a user for yourself:
            </p><pre class="screen">$ <strong class="userinput"><code>cd /usr/local/etc/bind10/</code></strong></pre><p>
            </p><pre class="screen">$ <strong class="userinput"><code>/usr/local/sbin/b10-cmdctl-usermgr</code></strong></pre><p>
          </p></li><li class="listitem"><p>Start the server (as root):
            </p><pre class="screen">$ <strong class="userinput"><code>/usr/local/sbin/bind10</code></strong></pre><p>
          </p></li><li class="listitem"><p>DNS and DHCP components are not started in the default
	    configuration.  In another console, enable the authoritative
	    DNS service (by using the <span class="command"><strong>bindctl</strong></span> utility
	    to configure the <span class="command"><strong>b10-auth</strong></span> component to
	    run): </p><pre class="screen">$ <strong class="userinput"><code>bindctl</code></strong></pre><p>
	    (Login with the username and password you used above to create a user.)
            </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Init/components b10-auth</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-auth/special auth</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-auth/kind needed</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
&gt; <strong class="userinput"><code>quit</code></strong>
            </pre><p>
          </p></li><li class="listitem"><p>Test it; for example:
            </p><pre class="screen">$ <strong class="userinput"><code>dig @127.0.0.1 -c CH -t TXT version.bind</code></strong></pre><p>
         </p></li><li class="listitem"><p>Load desired zone file(s), for example:
            </p><pre class="screen">$ <strong class="userinput"><code>b10-loadzone <em class="replaceable"><code>-c '{"database_file": "/usr/local/var/bind10/zone.sqlite3"}'</code></em> <em class="replaceable"><code>your.zone.example.org</code></em> <em class="replaceable"><code>your.zone.file</code></em></code></strong></pre><p>
          </p>
	  (If you use the sqlite3 data source with the default DB
	  file, you can omit the -c option).
        </li><li class="listitem">
            Test the new zone.
          </li></ol></div></div></div><div class="chapter" title="Chapter 3. Installation"><div class="titlepage"><div><div><h2 class="title"><a name="installation"></a>Chapter 3. Installation</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#packages">3.1. Packages</a></span></dt><dt><span class="section"><a href="#install-hierarchy">3.2. Install Hierarchy</a></span></dt><dt><span class="section"><a href="#build-requirements">3.3. Building Requirements</a></span></dt><dt><span class="section"><a href="#install">3.4. Installation from source</a></span></dt><dd><dl><dt><span class="section"><a href="#idm67049264">3.4.1. Download Tar File</a></span></dt><dt><span class="section"><a href="#idm67046960">3.4.2. Retrieve from Git</a></span></dt><dt><span class="section"><a href="#configure">3.4.3. Configure before the build</a></span></dt><dt><span class="section"><a href="#idm67024560">3.4.4. Build</a></span></dt><dt><span class="section"><a href="#idm67022768">3.4.5. Install</a></span></dt></dl></dd></dl></div><div class="section" title="3.1. Packages"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="packages"></a>3.1. Packages</h2></div></div></div><p>
        Some operating systems or software package vendors may
        provide ready-to-use, pre-built software packages for
        the BIND 10 suite.
        Installing a pre-built package means you do not need to
        install build-only prerequisites and do not need to
        <span class="emphasis"><em>make</em></span> the software.
      </p><p>
        FreeBSD ports, NetBSD pkgsrc, and Debian
        <span class="emphasis"><em>testing</em></span> package collections provide
        all the prerequisite packages.
      </p></div><div class="section" title="3.2. Install Hierarchy"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="install-hierarchy"></a>3.2. Install Hierarchy</h2></div></div></div><p>
        The following is the standard, common layout of the
        complete BIND 10 installation:
        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
              <code class="filename">bin/</code> &#8212;
              general tools and diagnostic clients.
            </li><li class="listitem">
            <code class="filename">etc/bind10/</code> &#8212;
            configuration files.
          </li><li class="listitem">
              <code class="filename">lib/</code> &#8212;
              libraries and python modules.
            </li><li class="listitem">
              <code class="filename">libexec/bind10/</code> &#8212;
              executables that a user wouldn't normally run directly and
              are not run independently.
              These are the BIND 10 modules which are daemons started by
              the <span class="command"><strong>b10-init</strong></span> master process.
            </li><li class="listitem">
              <code class="filename">sbin/</code> &#8212;
              commands used by the system administrator.
            </li><li class="listitem">
              <code class="filename">share/bind10/</code> &#8212;
              configuration specifications.
            </li><li class="listitem">
              <code class="filename">share/doc/bind10/</code> &#8212;
              this guide and other supplementary documentation.
            </li><li class="listitem">
              <code class="filename">share/man/</code> &#8212;
              manual pages (online documentation).
            </li><li class="listitem">
              <code class="filename">var/bind10/</code> &#8212;
              data source and configuration databases.
            </li></ul></div><p>
      </p></div><div class="section" title="3.3. Building Requirements"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="build-requirements"></a>3.3. Building Requirements</h2></div></div></div><p>
          In addition to the run-time requirements (listed in
          <a class="xref" href="#required-software" title="1.2. Required Software at Run-time">Section 1.2, &#8220;Required Software at Run-time&#8221;</a>), building BIND 10
          from source code requires various development include headers and
          program development tools.
        </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Some operating systems have split their distribution packages into
            a run-time and a development package.  You will need to install
            the development package versions, which include header files and
            libraries, to build BIND 10 from source code.
          </p></div><p>
          Building from source code requires the Boost
          build-time headers
          (<a class="ulink" href="http://www.boost.org/" target="_top">http://www.boost.org/</a>).
          At least Boost version 1.35 is required.
  
  
        </p><p>
          To build BIND 10, also install the Botan (at least version
          1.8) and the log4cplus (at least version 1.0.3)
          development include headers.
        </p><p>
          Building BIND 10 also requires a C++ compiler and
          standard development headers, make, and pkg-config.
          BIND 10 builds have been tested with GCC g++ 3.4.3, 4.1.2,
          4.1.3, 4.2.1, 4.3.2, and 4.4.1; Clang++ 2.8; and Sun C++ 5.10.
        </p><p>
          Visit the user-contributed wiki at <a class="ulink" href="http://bind10.isc.org/wiki/SystemSpecificNotes" target="_top">http://bind10.isc.org/wiki/SystemSpecificNotes</a>
          for system-specific installation tips.
        </p></div><div class="section" title="3.4. Installation from source"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="install"></a>3.4. Installation from source</h2></div></div></div><p>
        BIND 10 is open source software written in C++ and Python.
        It is freely available in source code form from ISC as a
        downloadable tar file or via BIND 10's Git code revision control
        service. (It may also be available in pre-compiled ready-to-use
        packages from operating system vendors.)
      </p><div class="section" title="3.4.1. Download Tar File"><div class="titlepage"><div><div><h3 class="title"><a name="idm67049264"></a>3.4.1. Download Tar File</h3></div></div></div><p>
          Downloading a release tar file is the recommended method to
          obtain the source code.
        </p><p>
          The BIND 10 releases are available as tar file downloads from
          <a class="ulink" href="ftp://ftp.isc.org/isc/bind10/" target="_top">ftp://ftp.isc.org/isc/bind10/</a>.
          Periodic development snapshots may also be available.
        </p></div><div class="section" title="3.4.2. Retrieve from Git"><div class="titlepage"><div><div><h3 class="title"><a name="idm67046960"></a>3.4.2. Retrieve from Git</h3></div></div></div><p>
          Downloading this "bleeding edge" code is recommended only for
          developers or advanced users.  Using development code in a production
          environment is not recommended.
        </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            When using source code retrieved via Git, additional
            software will be required:  automake (v1.11 or newer),
            libtoolize, and autoconf (2.59 or newer).
            These may need to be installed.
          </p></div><p>
          The latest development code (and temporary experiments
          and un-reviewed code) is available via the BIND 10 code revision
          control system. This is powered by Git and all the BIND 10
          development is public.
          The leading development is done in the <span class="quote">&#8220;<span class="quote">master</span>&#8221;</span>
          branch.
        </p><p>
          The code can be checked out from
          <code class="filename">git://git.bind10.isc.org/bind10</code>;
          for example:

        </p><pre class="screen">$ <strong class="userinput"><code>git clone git://git.bind10.isc.org/bind10</code></strong></pre><p>
        </p><p>
          When checking out the code from
          the code version control system, it doesn't include the
          generated configure script, Makefile.in files, nor their
          related build files.
          They can be created by running <span class="command"><strong>autoreconf</strong></span>
          with the <code class="option">--install</code> switch.
          This will run <span class="command"><strong>autoconf</strong></span>,
          <span class="command"><strong>aclocal</strong></span>,
          <span class="command"><strong>libtoolize</strong></span>,
          <span class="command"><strong>autoheader</strong></span>,
          <span class="command"><strong>automake</strong></span>,
          and related commands.
        </p></div><div class="section" title="3.4.3. Configure before the build"><div class="titlepage"><div><div><h3 class="title"><a name="configure"></a>3.4.3. Configure before the build</h3></div></div></div><p>
          BIND 10 uses the GNU Build System to discover build environment
          details.
          To generate the makefiles using the defaults, simply run:
          </p><pre class="screen">$ <strong class="userinput"><code>./configure</code></strong></pre><p>
        </p><p>
          Run <span class="command"><strong>./configure</strong></span> with the <code class="option">--help</code>
          switch to view the different options. Some commonly-used options are:

          </p><div class="variablelist"><dl><dt><span class="term">--prefix</span></dt><dd>Define the installation location (the
                default is <code class="filename">/usr/local/</code>).
              </dd><dt><span class="term">--with-boost-include</span></dt><dd>Define the path to find the Boost headers.
              </dd><dt><span class="term">--with-pythonpath</span></dt><dd>Define the path to Python 3.1 if it is not in the
                standard execution path.
              </dd><dt><span class="term">--with-gtest</span></dt><dd>Enable building the C++ Unit Tests using the
                Google Tests framework. Optionally this can define the
                path to the gtest header files and library.
              </dd><dt><span class="term">--without-werror</span></dt><dd>Disable the default use of the
		<code class="option">-Werror</code> compiler flag so that
		compiler warnings aren't build failures.
              </dd></dl></div><p>
          </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              For additional instructions concerning the building and installation of
              BIND 10 DHCP, see <a class="xref" href="#dhcp-install-configure" title="16.1. DHCP Database Installation and Configuration">Section 16.1, &#8220;DHCP Database Installation and Configuration&#8221;</a>.
            </p></div><p>
        </p><p>
          For example, the following configures it to
    find the Boost headers, find the
    Python interpreter, and sets the installation location:

          </p><pre class="screen">$ <strong class="userinput"><code>./configure \
      --with-boost-include=/usr/pkg/include \
      --with-pythonpath=/usr/pkg/bin/python3.1 \
      --prefix=/opt/bind10</code></strong></pre><p>
        </p><p>
          If the configure fails, it may be due to missing or old
          dependencies.
        </p></div><div class="section" title="3.4.4. Build"><div class="titlepage"><div><div><h3 class="title"><a name="idm67024560"></a>3.4.4. Build</h3></div></div></div><p>
    After the configure step is complete, to build the executables
    from the C++ code and prepare the Python scripts, run:

          </p><pre class="screen">$ <strong class="userinput"><code>make</code></strong></pre><p>
        </p></div><div class="section" title="3.4.5. Install"><div class="titlepage"><div><div><h3 class="title"><a name="idm67022768"></a>3.4.5. Install</h3></div></div></div><p>
          To install the BIND 10 executables, support files,
          and documentation, run:
          </p><pre class="screen">$ <strong class="userinput"><code>make install</code></strong></pre><p>
        </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The install step may require superuser privileges.</p></div><p>
	  If required, run <span class="command"><strong>ldconfig</strong></span> as root with
	  <code class="filename">/usr/local/lib</code> (or with ${prefix}/lib if
	  configured with --prefix) in
	  <code class="filename">/etc/ld.so.conf</code> (or the relevant linker
	  cache configuration file for your OS):
	  </p><pre class="screen">$ <strong class="userinput"><code>ldconfig</code></strong></pre><p>
        </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
	    If you do not run <span class="command"><strong>ldconfig</strong></span> where it is
	    required, you may see errors like the following:
            </p><pre class="screen">
	      program: error while loading shared libraries: libb10-something.so.1:
	      cannot open shared object file: No such file or directory
	    </pre><p>
	  </p></div></div></div></div><div class="chapter" title="Chapter 4. Starting BIND 10 with bind10"><div class="titlepage"><div><div><h2 class="title"><a name="bind10"></a>Chapter 4. Starting BIND 10 with <span class="command"><strong>bind10</strong></span></h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#start">4.1. Starting BIND 10</a></span></dt></dl></div><p>
      BIND 10 is started with the <span class="command"><strong>bind10</strong></span> command.
      It runs the <span class="command"><strong>b10-init</strong></span> daemon which
      starts up the required processes, and
      will also restart some processes that exit unexpectedly.
      <span class="command"><strong>bind10</strong></span> is the only command needed to start
      the BIND 10 system.
    </p><p>
      After starting the <span class="command"><strong>b10-msgq</strong></span> communications channel,
      <span class="command"><strong>b10-init</strong></span> connects to it,
      runs the configuration manager, and reads its own configuration.
      Then it starts the other modules.
    </p><p>
      The <span class="command"><strong>b10-sockcreator</strong></span>, <span class="command"><strong>b10-msgq</strong></span> and
      <span class="command"><strong>b10-cfgmgr</strong></span>
      services make up the core. The <span class="command"><strong>b10-msgq</strong></span> daemon
      provides the communication channel between every part of the system.
      The <span class="command"><strong>b10-cfgmgr</strong></span> daemon is always needed by every
      module, if only to send information about themselves somewhere,
      but more importantly to ask about their own settings, and
      about other modules. The <span class="command"><strong>b10-sockcreator</strong></span> daemon
      helps allocate Internet addresses and ports as needed for BIND 10
      network services.
    </p><p>
      In its default configuration, the <span class="command"><strong>b10-init</strong></span>
      master process will also start up
      <span class="command"><strong>b10-cmdctl</strong></span> for administration tools to
      communicate with the system, and
      <span class="command"><strong>b10-stats</strong></span> for statistics collection.
      The DNS and DHCP servers are not started by default.
      The configuration of components to start is covered in
      <a class="xref" href="#bind10.components" title="10.2. Configuration to start processes">Section 10.2, &#8220;Configuration to start processes&#8221;</a>.
    </p><div class="section" title="4.1. Starting BIND 10"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="start"></a>4.1. Starting BIND 10</h2></div></div></div><p>
        To start the BIND 10 service, simply run <span class="command"><strong>bind10</strong></span>
        as root.
        It will run in the foreground and your shell prompt will not
        be available. It will output various log messages as it starts up
        and is used.
        Run it with the <code class="option">--verbose</code> switch to
        get additional debugging or diagnostic output.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          If the setproctitle Python module is detected at start up,
          the process names for the Python-based daemons will be renamed
          to better identify them instead of just <span class="quote">&#8220;<span class="quote">python</span>&#8221;</span>.
          This is not needed on some operating systems.
        </p></div></div></div><div class="chapter" title="Chapter 5. Command channel"><div class="titlepage"><div><div><h2 class="title"><a name="msgq"></a>Chapter 5. Command channel</h2></div></div></div><p>
        The BIND 10 components use the <span class="command"><strong>b10-msgq</strong></span>
        message routing daemon to communicate with other BIND 10 components.
        The <span class="command"><strong>b10-msgq</strong></span> implements what is called the
        <span class="quote">&#8220;<span class="quote">Command Channel</span>&#8221;</span>.
        Processes intercommunicate by sending messages on the command
        channel.
        Example messages include shutdown, get configurations, and set
        configurations.
        This Command Channel is not used for DNS message passing.
        It is used only to control and monitor the BIND 10 system.
      </p><p>
        Administrators do not communicate directly with the
        <span class="command"><strong>b10-msgq</strong></span> daemon.
        By default, BIND 10 uses a UNIX domain socket file named
        <code class="filename">/usr/local/var/bind10/msg_socket</code>
        for this interprocess communication.
      </p></div><div class="chapter" title="Chapter 6. Configuration manager"><div class="titlepage"><div><div><h2 class="title"><a name="cfgmgr"></a>Chapter 6. Configuration manager</h2></div></div></div><p>
         The configuration manager, <span class="command"><strong>b10-cfgmgr</strong></span>,
         handles all BIND 10 system configuration.  It provides
         persistent storage for configuration, and notifies running
         modules of configuration changes.
      </p><p>
        The <span class="command"><strong>b10-auth</strong></span> and <span class="command"><strong>b10-xfrin</strong></span>
        daemons and other components receive their configurations
        from the configuration manager over the <span class="command"><strong>b10-msgq</strong></span>
        command channel.
      </p><p>The administrator doesn't connect to it directly, but
        uses a user interface to communicate with the configuration
        manager via <span class="command"><strong>b10-cmdctl</strong></span>'s REST-ful interface.
        <span class="command"><strong>b10-cmdctl</strong></span> is covered in <a class="xref" href="#cmdctl" title="Chapter 7. Remote control daemon">Chapter 7, <i>Remote control daemon</i></a>.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          The current release only provides
          <span class="command"><strong>bindctl</strong></span> as a user interface to
          <span class="command"><strong>b10-cmdctl</strong></span>.
          Upcoming releases will provide another interactive command-line
          interface and a web-based interface.
        </p></div><p>
        The <span class="command"><strong>b10-cfgmgr</strong></span> daemon can send all
        specifications and all current settings to the
        <span class="command"><strong>bindctl</strong></span> client (via
        <span class="command"><strong>b10-cmdctl</strong></span>).
        <span class="command"><strong>b10-cfgmgr</strong></span> relays configurations received
        from <span class="command"><strong>b10-cmdctl</strong></span> to the appropriate modules.
      </p><p>
        The stored configuration file is at
        <code class="filename">/usr/local/var/bind10/b10-config.db</code>.
        (The directory is what was defined at build configure time for
        <code class="option">--localstatedir</code>.
        The default is <code class="filename">/usr/local/var/</code>.)
        The format is loosely based on JSON and is directly parseable
        python, but this may change in a future version.
        This configuration data file is not manually edited by the
        administrator.
      </p><p>
      The configuration manager does not have any command line arguments.
      Normally it is not started manually, but is automatically
      started using the <span class="command"><strong>b10-init</strong></span> master process
      (as covered in <a class="xref" href="#bind10" title="Chapter 4. Starting BIND 10 with bind10">Chapter 4, <i>Starting BIND 10 with <span class="command"><strong>bind10</strong></span></i></a>).
    </p></div><div class="chapter" title="Chapter 7. Remote control daemon"><div class="titlepage"><div><div><h2 class="title"><a name="cmdctl"></a>Chapter 7. Remote control daemon</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#cmdctl.spec">7.1. Configuration specification for b10-cmdctl</a></span></dt></dl></div><p>
      <span class="command"><strong>b10-cmdctl</strong></span> is the gateway between
      administrators and the BIND 10 system.
      It is a HTTPS server that uses standard HTTP Digest
      Authentication for username and password validation.
      It provides a REST-ful interface for accessing and controlling
      BIND 10.
    </p><p>
      When <span class="command"><strong>b10-cmdctl</strong></span> starts, it firsts
      asks <span class="command"><strong>b10-cfgmgr</strong></span> about what modules are
      running and what their configuration is (over the
      <span class="command"><strong>b10-msgq</strong></span> channel). Then it will start listening
      on HTTPS for clients &#8212; the user interface &#8212; such
      as <span class="command"><strong>bindctl</strong></span>.
    </p><p>
      <span class="command"><strong>b10-cmdctl</strong></span> directly sends commands
      (received from the user interface) to the specified component.
      Configuration changes are actually commands to
      <span class="command"><strong>b10-cfgmgr</strong></span> so are sent there.
    </p><p>The HTTPS server requires a private key,
      such as a RSA PRIVATE KEY.
      The default location is at
      <code class="filename">/usr/local/etc/bind10/cmdctl-keyfile.pem</code>.
      (A sample key is at
      <code class="filename">/usr/local/share/bind10/cmdctl-keyfile.pem</code>.)
      It also uses a certificate located at
      <code class="filename">/usr/local/etc/bind10/cmdctl-certfile.pem</code>.
      (A sample certificate is at
      <code class="filename">/usr/local/share/bind10/cmdctl-certfile.pem</code>.)
      This may be a self-signed certificate or purchased from a
      certification authority.
    </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      The HTTPS server doesn't support a certificate request from a
      client (at this time).

      The <span class="command"><strong>b10-cmdctl</strong></span> daemon does not provide a
      public service. If any client wants to control BIND 10, then
      a certificate needs to be first received from the BIND 10
      administrator.
      The BIND 10 installation provides a sample PEM bundle that matches
      the sample key and certificate.
    </p></div><p>
      The <span class="command"><strong>b10-cmdctl</strong></span> daemon also requires
      the user account file located at
      <code class="filename">/usr/local/etc/bind10/cmdctl-accounts.csv</code>.
      This comma-delimited file lists the accounts with a user name,
      hashed password, and salt.
    </p><p>
      The administrator may create a user account with the
      <span class="command"><strong>b10-cmdctl-usermgr</strong></span> tool.
    </p><p>
      By default the HTTPS server listens on the localhost port 8080.
      The port can be set by using the <code class="option">--port</code> command line option.
      The address to listen on can be set using the <code class="option">--address</code> command
      line argument.
      Each HTTPS connection is stateless and times out in 1200 seconds
      by default.  This can be
      redefined by using the <code class="option">--idle-timeout</code> command line argument.
    </p><div class="section" title="7.1. Configuration specification for b10-cmdctl"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cmdctl.spec"></a>7.1. Configuration specification for b10-cmdctl</h2></div></div></div><p>
        The configuration items for <span class="command"><strong>b10-cmdctl</strong></span> are:
        <code class="varname">accounts_file</code> which defines the path to the
        user accounts database (the default is
        <code class="filename">/usr/local/etc/bind10/cmdctl-accounts.csv</code>);
        <code class="varname">cert_file</code> which defines the path to the
        PEM certificate file (the default is
        <code class="filename">/usr/local/etc/bind10/cmdctl-certfile.pem</code>);
        and
	<code class="varname">key_file</code> which defines the path to the
	PEM private key file (the default is
        <code class="filename">/usr/local/etc/bind10/cmdctl-keyfile.pem</code>).
      </p></div></div><div class="chapter" title="Chapter 8. Control and configure user interface"><div class="titlepage"><div><div><h2 class="title"><a name="bindctl"></a>Chapter 8. Control and configure user interface</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#bindctl_commandline_options">8.1. bindctl command-line options</a></span></dt><dt><span class="section"><a href="#bindctl_general_syntax">8.2. General syntax of bindctl commands</a></span></dt><dt><span class="section"><a href="#bindctl_help">8.3. Bindctl help</a></span></dt><dt><span class="section"><a href="#bindctl_command_arguments">8.4. Command arguments</a></span></dt><dt><span class="section"><a href="#bindctl_module_commands">8.5. Module commands</a></span></dt><dt><span class="section"><a href="#idm66896944">8.6. Configuration commands</a></span></dt><dd><dl><dt><span class="section"><a href="#bindctl_configuration_command_list">8.6.1. List of configuration commands</a></span></dt><dt><span class="section"><a href="#bindctl_configuration_data_types">8.6.2. Configuration data types</a></span></dt></dl></dd><dt><span class="section"><a href="#idm66828080">8.7. The execute command</a></span></dt><dd><dl><dt><span class="section"><a href="#bindctl_execute_directives">8.7.1. Execute directives</a></span></dt><dt><span class="section"><a href="#bindctl_execute_notes">8.7.2. Notes on execute scripts</a></span></dt></dl></dd></dl></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      For the current release, <span class="command"><strong>bindctl</strong></span>
      is the only user interface. It is expected that upcoming
      releases will provide another interactive command-line
      interface and a web-based interface for controlling and
      configuring BIND 10.
    </p></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      <span class="command"><strong>bindctl</strong></span> has an internal command history, as
      well as tab-completion for most of the commands and arguments.
      However, these are only enabled if the python readline module
      is available on the system. If not, neither of these
      features will be supported.
    </p></div><p>
      The <span class="command"><strong>bindctl</strong></span> tool provides an interactive
      prompt for configuring, controlling, and querying the BIND 10
      components.
      It communicates directly with a REST-ful interface over HTTPS
      provided by <span class="command"><strong>b10-cmdctl</strong></span>. It doesn't
      communicate to any other components directly.
    </p><div class="section" title="8.1. bindctl command-line options"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bindctl_commandline_options"></a>8.1. bindctl command-line options</h2></div></div></div><div class="variablelist"><dl><dt><span class="term">-a <em class="replaceable"><code>&lt;address&gt;</code></em>, --address=<em class="replaceable"><code>&lt;address&gt;</code></em></span></dt><dd>
                  IP address that BIND 10's <span class="command"><strong>b10-cmdctl</strong></span>
                  module is listening on. By default, this is 127.0.0.1.
              </dd><dt><span class="term">-c <em class="replaceable"><code>&lt;certificate file&gt;</code></em>, --certificate-chain=<em class="replaceable"><code>&lt;certificate file&gt;</code></em></span></dt><dd>
                  PEM-formatted server certificate file. When this option is
                  given, <span class="command"><strong>bindctl</strong></span> will verify the server
                  certificate using the given file as the root of the
                  certificate chain. If not specified, <span class="command"><strong>bindctl
                  </strong></span> does not validate the certificate.
              </dd><dt><span class="term">--csv-file-dir=<em class="replaceable"><code>&lt;csv file&gt;</code></em></span></dt><dd>
                  <span class="command"><strong>bindctl</strong></span> stores the username and
                  password for logging in in a file called
                  <code class="filename">default_user.csv</code>;
                  this option specifies the directory where this file is
                  stored and read from. When not specified,
                  <code class="filename">~/.bind10/</code> is used.
                  <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>Currently, this file contains an unencrypted password.</div>
              </dd><dt><span class="term">-h, --help</span></dt><dd>
                  Shows a short overview of the command-line options of
                  <span class="command"><strong>bindctl</strong></span>, and exits.
              </dd><dt><span class="term">--version</span></dt><dd>
                  Shows the version of <span class="command"><strong>bindctl</strong></span>, and exits.
              </dd><dt><span class="term">-p <em class="replaceable"><code>&lt;port number&gt;</code></em>, --port=<em class="replaceable"><code>&lt;port number&gt;</code></em></span></dt><dd>
                  Port number that BIND 10's <span class="command"><strong>b10-cmdctl</strong></span>
                  module is listening on. By default, this is port 8080.
              </dd></dl></div></div><div class="section" title="8.2. General syntax of bindctl commands"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bindctl_general_syntax"></a>8.2. General syntax of bindctl commands</h2></div></div></div>
        The <span class="command"><strong>bindctl</strong></span> tool is an interactive
        command-line tool, with dynamic commands depending on the
        BIND 10 modules that are running. There are a number of
        fixed commands that have no module and that are always
        available.

        The general syntax of a command is

        <pre class="screen"><strong class="userinput"><code>&lt;module&gt; &lt;command&gt; <em class="replaceable"><code>[argument(s)]</code></em></code></strong></pre>

        For example, the Init module has a 'shutdown' command to shut down
        BIND 10, with an optional argument 'help':

        <pre class="screen">&gt; <strong class="userinput"><code>Init shutdown help</code></strong>
Command  shutdown 	(Shut down BIND 10)
		help (Get help for command)
This command has no parameters
        </pre>
        There are no mandatory arguments, only the optional 'help'.
    </div><div class="section" title="8.3. Bindctl help"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bindctl_help"></a>8.3. Bindctl help</h2></div></div></div><span class="command"><strong>help</strong></span> is both a command and an option that is available to all other commands. When run as a command directly, it shows the available modules.
        <pre class="screen">&gt; <strong class="userinput"><code>help</code></strong>
usage: &lt;module name&gt; &lt;command name&gt; [param1 = value1 [, param2 = value2]]
Type Tab character to get the hint of module/command/parameters.
Type "help(? h)" for help on bindctl.
Type "&lt;module_name&gt; help" for help on the specific module.
Type "&lt;module_name&gt; &lt;command_name&gt; help" for help on the specific command.

Available module names:
<span class="emphasis"><em>(list of modules)</em></span>
        </pre>

        When 'help' is used as a command to a module, it shows the supported commands for the module; for example:
        <pre class="screen">&gt; <strong class="userinput"><code>Init help</code></strong>
Module  Init 	Master process
Available commands:
    help        Get help for module.
    shutdown    Shut down BIND 10
    ping        Ping the Init process
    show_processes
            List the running BIND 10 processes
        </pre>

    And when added to a module command, it shows the description and parameters of that specific command; for example:
    <pre class="screen">&gt; <strong class="userinput"><code>Auth loadzone help</code></strong>
Command  loadzone 	((Re)load a specified zone)
		help (Get help for command)
Parameters:
    class (string, optional)
    origin (string, mandatory)
    </pre></div><div class="section" title="8.4. Command arguments"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bindctl_command_arguments"></a>8.4. Command arguments</h2></div></div></div><p>
            Commands can have arguments, which can be either optional or
            mandatory. They can be specified by name
            (e.g. <span class="command"><strong><em class="replaceable"><code>&lt;command&gt;</code></em> <em class="replaceable"><code>&lt;argument name&gt;=&lt;argument value&gt;</code></em></strong></span>), or positionally,
            (e.g. <span class="command"><strong><em class="replaceable"><code>&lt;command&gt;</code></em> <em class="replaceable"><code>&lt;argument value 1&gt;</code></em> <em class="replaceable"><code>&lt;argument value 2&gt;</code></em></strong></span>).
        </p><p>
            <span class="command"><strong><em class="replaceable"><code>&lt;command&gt;</code></em> <em class="replaceable"><code>help</code></em></strong></span>
            shows the arguments a command supports and which of those are
            mandatory, and in which order the arguments are expected if
            positional arguments are used.
        </p><p>
            For example, the <span class="command"><strong>loadzone</strong></span> command of the Auth
            module, as shown in the last example of the previous section, has
            two arguments, one of which is optional. The positional arguments in
            this case are class first and origin second; for example:
            <pre class="screen">&gt; <strong class="userinput"><code>Auth loadzone IN example.com.</code></strong></pre>
            But since the class is optional (defaulting to IN), leaving it out
            works as well:
            <pre class="screen">&gt; <strong class="userinput"><code>Auth loadzone example.com.</code></strong></pre>
        </p><p>
            The arguments can also be provided with their names, in which
            case the order does not matter:
            <pre class="screen">&gt; <strong class="userinput"><code>Auth loadzone origin="example.com." class="IN"</code></strong></pre>
        </p></div><div class="section" title="8.5. Module commands"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bindctl_module_commands"></a>8.5. Module commands</h2></div></div></div>
        Each module has its own set of commands (if any), which will only be
        available if the module is running. For instance, the
        Auth module has a <span class="command"><strong>loadzone</strong></span> command.
        The commands a module provides are documented in
        this guide in the section of that module or in the module's
        corresponding manual page.
    </div><div class="section" title="8.6. Configuration commands"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66896944"></a>8.6. Configuration commands</h2></div></div></div>
        Configuration commands are used to view and change the configuration
        of BIND 10 and its modules. Module configuration is only shown if
        that module is running, but similar to commands, there are a number
        of top-level configuration items that are always available (for
        instance <code class="varname">tsig_keys</code> and
        <code class="varname">data_sources</code>).

        Configuration changes (set, unset, add and remove) are done locally
        first, and have no immediate effect. The changes can be viewed with
        <span class="command"><strong>config diff</strong></span>, and either reverted
        (<span class="command"><strong>config revert</strong></span>), or committed
        (<span class="command"><strong>config commit</strong></span>).
        In the latter case, all local changes are submitted
        to the configuration manager, which verifies them, and if they are
        accepted, applied and saved in persistent storage.

        When identifying items in configuration commands, the format is
        <pre class="screen"><strong class="userinput"><code>Module/example/item</code></strong></pre>
        Sub-elements of names, lists and sets (see <a class="xref" href="#bindctl_configuration_data_types" title="8.6.2. Configuration data types">Section 8.6.2, &#8220;Configuration data types&#8221;</a>) are separated with the '/'
        character, and list indices are identified with [<em class="replaceable"><code>&lt;index&gt;</code></em>]; for example:

        <pre class="screen"><strong class="userinput"><code>Module/example/list[2]/foo</code></strong></pre><div class="section" title="8.6.1. List of configuration commands"><div class="titlepage"><div><div><h3 class="title"><a name="bindctl_configuration_command_list"></a>8.6.1. List of configuration commands</h3></div></div></div>
        The following configuration commands are available:
        <div class="variablelist"><dl><dt><span class="term">show [all] [item name]</span></dt><dd>
                Shows the current configuration of the given item. If 'all'
                is given, it will recurse through the entire set, and show
                every nested value.
              </dd><dt><span class="term">show_json [item name]</span></dt><dd>
                Shows the full configuration of the given item in JSON format.
              </dd><dt><span class="term">add &lt;item name&gt; [value]</span></dt><dd>
                Add an entry to configuration list or a named set (see <a class="xref" href="#bindctl_configuration_data_types" title="8.6.2. Configuration data types">Section 8.6.2, &#8220;Configuration data types&#8221;</a>).
                When adding to a list, the command has one optional
                argument, a value to add to the list. The value must
                be in correct JSON and complete. When adding to a
                named set, it has one mandatory parameter (the name to
                add), and an optional parameter value, similar to when
                adding to a list. In either case, when no value is
                given, an entry will be constructed with default
                values.
              </dd><dt><span class="term">remove</span></dt><dd>
                Remove an item from a configuration list or a named set.
                When removing an item for a list, either the index needs to
                be specified, or the complete value of the element to remove
                must be specified (in JSON format).
              </dd><dt><span class="term">set &lt;item name&gt; &lt;value&gt;</span></dt><dd>
                  Directly set the value of the given item to the given value.
              </dd><dt><span class="term">unset &lt;item name&gt;</span></dt><dd>
                  Remove any user-specified value for the given item.
              </dd><dt><span class="term">diff</span></dt><dd>
                  Show all current local changes that have not been
                  committed yet.
              </dd><dt><span class="term">revert</span></dt><dd>
                  Revert all local changes without committing them.
              </dd><dt><span class="term">commit</span></dt><dd>
                  Send all local changes to the configuration manager, which
                  will validate them, and apply them if validation succeeds.
              </dd><dt><span class="term">go</span></dt><dd>
                  Go to a specific configuration part, similar to the 'cd'
                  command in a shell.
                  <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>There are a number of problems with the current
                  implementation of go within <span class="command"><strong>bindctl</strong></span>,
                  and we recommend not using it for general cases.</div>
              </dd></dl></div></div><div class="section" title="8.6.2. Configuration data types"><div class="titlepage"><div><div><h3 class="title"><a name="bindctl_configuration_data_types"></a>8.6.2. Configuration data types</h3></div></div></div>
        Configuration data can be of different types, which can be modified
        in ways that depend on the types. There are a few syntax
        restrictions on these types, but only basic ones. Modules may impose
        additional restrictions on the values of elements.
        <div class="variablelist"><dl><dt><span class="term">integer</span></dt><dd>
                        A basic integer; can be set directly with <span class="command"><strong>config set</strong></span>, to any integer value.
                    </dd><dt><span class="term">real</span></dt><dd>
                        A basic floating point number; can be set directly with <span class="command"><strong>config set</strong></span>, to any floating point value.
                    </dd><dt><span class="term">boolean</span></dt><dd>
                        A basic boolean value; can be set directly with <span class="command"><strong>config set</strong></span>, to either <span class="command"><strong>true</strong></span> or <span class="command"><strong>false</strong></span>.
                    </dd><dt><span class="term">string</span></dt><dd>
                        A basic string value; can be set directly with <span class="command"><strong>config set,</strong></span> so any string. Double quotation marks are optional.
                    </dd><dt><span class="term">null</span></dt><dd>
                        This is a special type representing 'no value at all'; usable in compound structures that have optional elements that are not set.
                    </dd><dt><span class="term">maps</span></dt><dd><p class="simpara">
                        Maps are (pre-defined) compound collections of other
                        elements of any other type. They are not usually
                        modified directly, but their elements are. Every
                        top-level element for a module is a map containing
                        the configuration values for that map, which can
                        themselves be maps again. For instance, the Auth
                        module configuration is a map containing the
                        elements '<code class="varname">listen_on</code>' (list) and '<code class="varname">tcp_recv_timeout</code>'
                        (integer). When changing one of its values, they can
                        be modified directly with <span class="command"><strong>config set
                        Auth/tcp_recv_timeout 3000</strong></span>.
                    </p><p class="simpara">
                        Some map entries are optional. If they are, and
                        currently have a value, the value can be unset by
                        using either <span class="command"><strong>config unset
                        <em class="replaceable"><code>&lt;item name&gt;</code></em>
                        </strong></span> or <span class="command"><strong>config set
                        <em class="replaceable"><code>&lt;item name&gt;</code></em>
                        null</strong></span>.

                    </p><p class="simpara">
                        Maps <span class="emphasis"><em>can</em></span> be modified as a whole,
                        but using the full JSON representation of
                        the entire map to set.

                        Since this involves a lot of text, this is usually
                        not recommended.
                    </p><p class="simpara">
                        Another example is the Logging virtual module, which
                        is, like any module, a map, but it only contains one
                        element: a list of loggers. Normally, an
                        administrator would only modify that list (or its
                        elements) directly, but it is possible to set the
                        entire map in one command; for example:
                        <span class="command"><strong> config set Logging { "loggers": [] } </strong></span>
                    </p></dd><dt><span class="term">list</span></dt><dd><p class="simpara">
                        A list is a compound list of other elements of the
                        same type. Elements can be added with <span class="command"><strong>config
                        add <em class="replaceable"><code>&lt;list name&gt; [value]</code></em></strong></span>, and removed with
                        <span class="command"><strong>config remove <em class="replaceable"><code>&lt;list name&gt; [value]</code></em></strong></span> or
                        <span class="command"><strong>config remove <em class="replaceable"><code>&lt;list name&gt;</code></em><em class="replaceable"><code>&lt;index&gt;</code></em></strong></span>.
                        The index is of the form <span class="emphasis"><em>square bracket, number,
                        square bracket</em></span> (e.g.
                        <span class="command"><strong>[0]</strong></span>), and it immediately follows
                        the list name (there is no separator or space
                        between them). List indices start with 0 for the
                        first element.
                    </p><p class="simpara">
                        For addition, if the value is omitted, an entry with
                        default values will be added. For removal, either
                        the index or the full value (in JSON format) needs
                        to be specified.
                    </p><p class="simpara">
                        Lists can also be used with
                        <span class="command"><strong>config set</strong></span>,
                        but like maps, only by specifying the
                        entire list value in JSON format.
                    </p><p class="simpara">
                        For example, this command shows the port number used for the second element of the list <code class="varname">listen_on</code> in the Auth module:
                        <span class="command"><strong> config show Auth/listen_on[1]/port</strong></span>
                    </p></dd><dt><span class="term">named set</span></dt><dd><p class="simpara">
                        Named sets are similar to lists, in that they are
                        sets of elements of the same type, but they are not
                        indexed by numbers, but by strings.
                    </p><p class="simpara">
                        Values can be added with
                        <span class="command"><strong>config add <em class="replaceable"><code>&lt;item name&gt; &lt;string&gt; [value]</code></em></strong></span>
                        where 'string' is the name of the element. If 'value'
                        is ommitted, default values will be used. Elements
                        can be removed with <span class="command"><strong>config remove
                        <em class="replaceable"><code>&lt;item
                        name&gt; &lt;string&gt;</code></em></strong></span>
                    </p><p class="simpara">
                        Elements in a named set can be addressed similarly
                        to maps.
                    </p><p class="simpara">
                        For example, the <span class="command"><strong>Init/components</strong></span>
                        elements is a named set;
                        adding, showing, and then removing an element
                        can be done with the following three commands (note
                        the '/'-character versus the space before
                        'example_module'):
                    </p><p class="simpara">
                        <span class="command"><strong>config add Init/components example_module</strong></span>
                    </p><p class="simpara">
                        <span class="command"><strong>config show Init/components/example_module</strong></span>
                    </p><p class="simpara">
                        <span class="command"><strong>config remove Init/components example_module</strong></span>
                    </p></dd><dt><span class="term">any</span></dt><dd>
                        The 'any' type is a special type that can have any
                        form. Apart from that, it must consist of elements as
                        described in this chapter, there is no restriction
                        on which element types are used. This type is used
                        in places where different data formats could be
                        used. Element modification commands depend on the
                        actual type of the value. For instance, if the value
                        of an 'any' element is a list, <span class="command"><strong>config add
                        </strong></span> and <span class="command"><strong>config remove</strong></span> work
                        as for other lists.
                    </dd></dl></div></div></div><div class="section" title="8.7. The execute command"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66828080"></a>8.7. The execute command</h2></div></div></div>
        The <span class="command"><strong>execute</strong></span> command executes a set of commands,
        either from a file
        or from a pre-defined set. Currently, the only predefined set is
        <span class="command"><strong>init_authoritative_server</strong></span>, which adds
        <span class="command"><strong>b10-auth</strong></span>, <span class="command"><strong>b10-xfrin</strong></span>, and
        <span class="command"><strong>b10-xfrout</strong></span> to the set of components to be
        started by BIND 10. This
        pre-defined set does not commit the changes, so these modules do not
        show up for commands or configuration until the user enters
        <span class="command"><strong>config commit</strong></span> after
        <span class="command"><strong>execute init_authoritative_server</strong></span>. For example:

        <pre class="screen">&gt; <strong class="userinput"><code>execute init_authoritative_server</code></strong></pre><pre class="screen">&gt; <strong class="userinput"><code>execute file /tmp/example_commands</code></strong></pre>

        The optional argument <span class="command"><strong>show</strong></span> displays the exact set of
        commands that would be executed; for example:

        <pre class="screen">&gt; <strong class="userinput"><code>execute init_authoritative_server show</code></strong>
!echo adding Authoritative server component
config add /Init/components b10-auth
config set /Init/components/b10-auth/kind needed
config set /Init/components/b10-auth/special auth
!echo adding Xfrin component
config add /Init/components b10-xfrin
config set /Init/components/b10-xfrin/address Xfrin
config set /Init/components/b10-xfrin/kind dispensable
!echo adding Xfrout component
config add /Init/components b10-xfrout
config set /Init/components/b10-xfrout/address Xfrout
config set /Init/components/b10-xfrout/kind dispensable
!echo adding Zone Manager component
config add /Init/components b10-zonemgr
config set /Init/components/b10-zonemgr/address Zonemgr
config set /Init/components/b10-zonemgr/kind dispensable
!echo Components added. Please enter "config commit" to
!echo finalize initial setup and run the components.
        </pre>

        The optional <span class="command"><strong>show</strong></span> argument may also be used when
        executing a script from a file; for example:

        <pre class="screen">&gt; <strong class="userinput"><code>execute file /tmp/example_commands show</code></strong></pre><div class="section" title="8.7.1. Execute directives"><div class="titlepage"><div><div><h3 class="title"><a name="bindctl_execute_directives"></a>8.7.1. Execute directives</h3></div></div></div>
            Within sets of commands to be run with the <span class="command"><strong>execute</strong></span>
            command, a number of directives are supported:
            <div class="variablelist"><dl><dt><span class="term">!echo <em class="replaceable"><code>&lt;string&gt;</code></em></span></dt><dd>
                      Prints the given string to <span class="command"><strong>bindctl</strong></span>'s
                      output.
                  </dd><dt><span class="term">!verbose on</span></dt><dd>
                      Enables verbose mode; all following commands that are to
                      be executed are also printed.
                  </dd><dt><span class="term">!verbose off</span></dt><dd>
                      Disables verbose mode; following commands that are to
                      be executed are no longer printed.
                  </dd></dl></div></div><div class="section" title="8.7.2. Notes on execute scripts"><div class="titlepage"><div><div><h3 class="title"><a name="bindctl_execute_notes"></a>8.7.2. Notes on execute scripts</h3></div></div></div>
            Within scripts, you can add or remove modules with the normal
            configuration commands for <span class="command"><strong>Init/components</strong></span>.
            However, as module
            configuration and commands do not show up until the module is
            running, it is currently not possible to add a module and set
            its configuration in one script. This will be addressed in the
            future, but for now the only option is to add and configure
            modules in separate commands and execute scripts.
        </div></div></div><div class="chapter" title="Chapter 9. Common configuration elements"><div class="titlepage"><div><div><h2 class="title"><a name="common"></a>Chapter 9. Common configuration elements</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#common-tsig">9.1. TSIG keys</a></span></dt><dd><dl><dt><span class="section"><a href="#tsig-key-syntax">9.1.1. Key anatomy and syntax</a></span></dt><dt><span class="section"><a href="#tsig-key-ring">9.1.2. Key ring</a></span></dt></dl></dd><dt><span class="section"><a href="#common-acl">9.2. ACLs</a></span></dt><dd><dl><dt><span class="section"><a href="#idm66783280">9.2.1. Matching properties</a></span></dt><dt><span class="section"><a href="#idm66780592">9.2.2. More complicated matches</a></span></dt><dt><span class="section"><a href="#idm66778160">9.2.3. Examples</a></span></dt><dt><span class="section"><a href="#idm66774576">9.2.4. Interaction with <span class="command"><strong>bindctl</strong></span></a></span></dt></dl></dd></dl></div><p>
      Some things are configured in the same or similar manner across
      many modules. So we show them here in one place.
    </p><div class="section" title="9.1. TSIG keys"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="common-tsig"></a>9.1. TSIG keys</h2></div></div></div><p>
        TSIG is a way to sign requests and responses in DNS. It is defined in
        RFC 2845 and uses symmetric cryptography to sign the DNS messages. If
        you want to make any use of TSIG (to authenticate transfers or DDNS,
        for example), you need to set up shared secrets between the endpoints.
      </p><p>
        BIND 10 uses a global key ring for the secrets. It doesn't currently
        mean they would be stored differently, they are just in one place of
        the configuration.
      </p><div class="section" title="9.1.1. Key anatomy and syntax"><div class="titlepage"><div><div><h3 class="title"><a name="tsig-key-syntax"></a>9.1.1. Key anatomy and syntax</h3></div></div></div><p>
          Each key has three attributes. One is a name by which it is referred
          both in DNS packets and the rest of the configuration. Another is the
          algorithm used to compute the signature. And the last part is a
          base64 encoded secret, which might be any blob of data.
        </p><p>
          The parts are written into a string, concatenated together by colons.
          So if you wanted to have a key called "example.key", used as a
          HMAC-MD5 key with secret "secret", you'd write it as:
</p><pre class="screen">"example.key.:c2VjcmV0:hmac-md5"</pre><p>
        </p><p>
          The HMAC-MD5 algorithm is the default, so you can omit it. You could
          write the same key as:
</p><pre class="screen">"example.key.:c2VjcmV0"</pre><p>
        </p><p>
          You can also use these algorithms (which may not be omitted from the
          key definition if used):
          </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">hmac-sha1</li><li class="listitem">hmac-sha224</li><li class="listitem">hmac-sha256</li><li class="listitem">hmac-sha384</li><li class="listitem">hmac-sha512</li></ul></div><p>
        </p><p>
          The name of the key must be a valid DNS name.
        </p></div><div class="section" title="9.1.2. Key ring"><div class="titlepage"><div><div><h3 class="title"><a name="tsig-key-ring"></a>9.1.2. Key ring</h3></div></div></div><p>
          The key ring lives in the configuration in "tsig_keys/keys". Most of
          the system uses the keys from there &#8212; ACLs, authoritative server to
          sign responses to signed queries, and <span class="command"><strong>b10-xfrin</strong></span>
          and <span class="command"><strong>b10-xfrout</strong></span> to sign transfers.
        </p><p>
          The key ring is just a list of strings, each describing one key. So,
          to add a new key, you can do this:
          </p><pre class="screen">&gt; <strong class="userinput"><code>config add tsig_keys/keys "example.key.:c2VjcmV0"</code></strong>
&gt; <strong class="userinput"><code>config show tsig_keys/keys</code></strong>
tsig_keys/keys[0]   "example.key.:c2VjcmV0" string  (modified)
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        </p><p>
          You can keep as many keys as you want in the key ring, but each must
          have a different name.
        </p></div></div><div class="section" title="9.2. ACLs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="common-acl"></a>9.2. ACLs</h2></div></div></div><p>
        An ACL, or Access Control List, is a way to describe if a request
        is allowed or disallowed. The principle is, there's a list of rules.
        Each rule is a name-value mapping (a dictionary, in the JSON
        terminology). Each rule must contain exactly one mapping called
        "action", which describes what should happen if the rule applies.
        There may be more mappings, called matches, which describe the
        conditions under which the rule applies.
      </p><p>
        When there's a query, the first rule is examined. If it matches, the
        action in it is taken. If not, next rule is examined. If there are no
        more rules to examine, a default action is taken.
      </p><p>
        There are three possible "action" values. The "ACCEPT" value means
        the query is handled. If it is "REJECT", the query is not answered,
        but a polite error message is sent back (if that makes sense in the
        context). The "DROP" action acts like a black hole. The query is
        not answered and no error message is sent.
      </p><p>
        If there are multiple matching conditions inside the rule, all of
        them must be satisfied for the rule to apply. This can be used,
        for example, to require the query to be signed by a TSIG key and
        originate from given address.
      </p><p>
        This is encoded in form of JSON. Semi-formal description could look
        something like this. It is described in more details below.

        </p><pre class="screen">ACL := [ RULE, RULE, ... ]
RULE := { "action": "ACCEPT"|"REJECT"|"DROP", MATCH, MATCH, ... }
RULE_RAW := { MATCH, MATCH, ... }
MATCH := FROM_MATCH|KEY_MATCH|NOT_MATCH|OR_MATCH|AND_MATCH|...
FROM_MATCH := "from": [RANGE, RANGE, RANGE, ...] | RANGE
RANGE := "&lt;ip range&gt;"
KEY_MATCH := "key": [KEY, KEY, KEY, ...] | KEY
KEY := "&lt;key name&gt;"
NOT_MATCH := "NOT": RULE_RAW
OR_MATCH := "ANY": [ RULE_RAW, RULE_RAW, ... ]
AND_MATCH := "ALL": [ RULE_RAW, RULE_RAW, ... ]
</pre><p>
      </p><div class="section" title="9.2.1. Matching properties"><div class="titlepage"><div><div><h3 class="title"><a name="idm66783280"></a>9.2.1. Matching properties</h3></div></div></div><p>
          The first thing you can check against is the source address
          of request. The name is <code class="varname">from</code> and the value
          is a string containing either a single IPv4 or IPv6 address,
          or a range in the usual slash notation (eg. "192.0.2.0/24").
        </p><p>
          The other is TSIG key by which the message was signed. The ACL
          contains only the name (under the name "key"), the key itself
	  must be stored in the global key ring (see <a class="xref" href="#tsig-key-ring" title="9.1.2. Key ring">Section 9.1.2, &#8220;Key ring&#8221;</a>).
          This property is applicable only to the DNS context.
        </p><p>
          More properties to match are planned &#8212; the destination
          address, ports, matches against the packet content.
        </p></div><div class="section" title="9.2.2. More complicated matches"><div class="titlepage"><div><div><h3 class="title"><a name="idm66780592"></a>9.2.2. More complicated matches</h3></div></div></div><p>
          From time to time, you need to express something more complex
          than just a single address or key.
        </p><p>
          You can specify a list of values instead of single value. Then
          the property needs to match at least one of the values listed
          &#8212; so you can say <span class="quote">&#8220;<span class="quote">"from": ["192.0.2.0/24",
          "2001:db8::/32"]</span>&#8221;</span> to match any address in the ranges
          set aside for documentation. The keys or any future properties
          will work in a similar way.
        </p><p>
          If that is not enough, you can compose the matching conditions
          to logical expressions. They are called "ANY", "ALL" and "NOT".
          The "ANY" and "ALL" ones contain lists of subexpressions &#8212;
          each subexpression is a similar dictionary, just not containing
          the "action" element. The "NOT" contains single subexpression.
          Their function should be obvious &#8212; "NOT" matches if and
          only if the subexpression does not match. The "ALL" matches exactly
          when each of the subexpressions matches and "ANY" when at least
          one matches.
        </p></div><div class="section" title="9.2.3. Examples"><div class="titlepage"><div><div><h3 class="title"><a name="idm66778160"></a>9.2.3. Examples</h3></div></div></div><p>
          All the examples here is just the JSON representing the ACL,
          nicely formatted and split across lines. They are out of any
          surrounding context. This is similar to what you'd get from
          <span class="command"><strong>config show_json</strong></span> called on the entry containing
          the ACL.
        </p><p>
          In the first example, the ACL accepts queries from two known hosts.
          Each host has an IP addresses (both IPv4 and IPv6) and a TSIG
          key. Other queries are politely rejected. The last entry in the list
          has no conditions &#8212; making it match any query.

          </p><pre class="screen">[
  {
    "from": ["192.0.2.1", "2001:db8::1"],
    "key": "first.key",
    "action": "ACCEPT"
  },
  {
    "from": ["192.0.2.2", "2001:db8::2"],
    "key": "second.key",
    "action": "ACCEPT"
  },
  {
    "action": "REJECT"
  }
]</pre><p>
        </p><p>
          Now we show two ways to accept only the queries from private ranges.
          This is the same as rejecting anything that is outside.

          </p><pre class="screen">[
  {
    "from": [
      "10.0.0.0/8",
      "172.16.0.0/12",
      "192.168.0.0/16",
      "fc00::/7"
    ],
    "action": "ACCEPT"
  },
  {
    "action": "REJECT"
  }
]</pre><p>

          </p><pre class="screen">[
  {
    "NOT": {
       "ANY": [
         {"from": "10.0.0.0/8"},
         {"from": "172.16.0.0/12"},
         {"from": "192.168.0.0/16"},
         {"from": "fc00::/7"}
       ]
    },
    "action": "REJECT"
  },
  {
    "action": "ACCEPT"
  }
]</pre><p>
        </p></div><div class="section" title="9.2.4. Interaction with bindctl"><div class="titlepage"><div><div><h3 class="title"><a name="idm66774576"></a>9.2.4. Interaction with <span class="command"><strong>bindctl</strong></span></h3></div></div></div><p>
          Currently, <span class="command"><strong>bindctl</strong></span> has hard time coping with
          the variable nature of the ACL syntax. This technical limitation
          makes it impossible to edit parts of the entries. You need to
          set the whole entry at once, providing the whole JSON value.
        </p><p>
          This limitation is planned to be solved soon at least partially.
        </p><p>
          You'd do something like this to create the second example.
          Note that the whole JSON must be on a single line.

          </p><pre class="screen">&gt; <strong class="userinput"><code>config add somewhere/acl</code></strong>
&gt; <strong class="userinput"><code>config set somewhere/acl[0] { "from": [ "10.0.0.0/8", "172.16.0.0/12", "192.168.0.0/16", "fc00::/7" ], "action": "ACCEPT" }</code></strong>
&gt; <strong class="userinput"><code>config add somewhere/acl</code></strong>
&gt; <strong class="userinput"><code>config set somewhere/acl[1] { "action": "REJECT" }</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        </p></div></div></div><div class="chapter" title="Chapter 10. bind10 Control and Configuration"><div class="titlepage"><div><div><h2 class="title"><a name="bind10.config"></a>Chapter 10. bind10 Control and Configuration</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#bind10.shutdown">10.1. Stopping bind10</a></span></dt><dt><span class="section"><a href="#bind10.components">10.2. Configuration to start processes</a></span></dt></dl></div><p>
      This chapter explains how to control and configure the
      <span class="command"><strong>b10-init</strong></span> parent.
      The startup of this resident process that runs the BIND 10
      daemons is covered in <a class="xref" href="#bind10" title="Chapter 4. Starting BIND 10 with bind10">Chapter 4, <i>Starting BIND 10 with <span class="command"><strong>bind10</strong></span></i></a>.
    </p><div class="section" title="10.1. Stopping bind10"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bind10.shutdown"></a>10.1. Stopping bind10</h2></div></div></div><p>
        The BIND 10 suite may be shut down by stopping the
        parent <span class="command"><strong>b10-init</strong></span> process. This may be done
        by running the <strong class="userinput"><code>Init shutdown</code></strong> command
        at the <span class="command"><strong>bindctl</strong></span> prompt.
      </p></div><div class="section" title="10.2. Configuration to start processes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bind10.components"></a>10.2. Configuration to start processes</h2></div></div></div><p>
	The processes to be used can be configured for
	<span class="command"><strong>b10-init</strong></span> to start, with the exception
	of the required <span class="command"><strong>b10-sockcreator</strong></span>,
	<span class="command"><strong>b10-msgq</strong></span> and <span class="command"><strong>b10-cfgmgr</strong></span>
	components.
	The configuration is in the <code class="varname">Init/components</code>
	section. Each element represents one component, which is
	an abstraction of a process.
      </p><p>
	To add a process to the set, let's say the resolver (which
	is not started by default), you would do this:
        </p><pre class="screen">&gt; <strong class="userinput"><code>config add Init/components b10-resolver</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-resolver/special resolver</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-resolver/kind needed</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-resolver/priority 10</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
	Now, what it means. We add an entry called
	<span class="quote">&#8220;<span class="quote">b10-resolver</span>&#8221;</span>. It is both a name used to
	reference this component in the configuration and the name
	of the process to start. Then we set some parameters on
	how to start it.
      </p><p>
	The <code class="varname">special</code> setting is for components
	that need some kind of special care during startup or
	shutdown. Unless specified, the component is started in a
	usual way. This is the list of components that need to be
	started in a special way, with the value of special used
	for them:

        </p><div class="table"><a name="idm66757552"></a><p class="title"><b>Table 10.1. Special startup components</b></p><div class="table-contents"><table summary="Special startup components" border="1"><colgroup><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Component</th><th align="left">Special</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">b10-auth</td><td align="left">auth</td><td align="left">Authoritative DNS server</td></tr><tr><td align="left">b10-resolver</td><td align="left">resolver</td><td align="left">DNS resolver</td></tr><tr><td align="left">b10-cmdctl</td><td align="left">cmdctl</td><td align="left">Command control (remote control interface)</td></tr></tbody></table></div></div><p><br class="table-break">
      </p><p>
	The <code class="varname">kind</code> specifies how a failure of the
	component should be handled.  If it is set to
	<span class="quote">&#8220;<span class="quote">dispensable</span>&#8221;</span> (the default unless you set
	something else), it will get started again if it fails. If
	it is set to <span class="quote">&#8220;<span class="quote">needed</span>&#8221;</span> and it fails at startup,
	the whole <span class="command"><strong>b10-init</strong></span> shuts down and exits
	with an error exit code. But if it fails some time later, it
	is just started again. If you set it to <span class="quote">&#8220;<span class="quote">core</span>&#8221;</span>,
	you indicate that the system is not usable without the
	component and if such component fails, the system shuts
	down no matter when the failure happened.  This is the
	behavior of the core components (the ones you can't turn
	off), but you can declare any other components as core as
	well if you wish (but you can turn these off, they just
	can't fail).
      </p><p>
	The <code class="varname">priority</code> defines order in which the
	components should start.  The ones with higher numbers are
	started sooner than the ones with lower ones. If you don't
	set it, 0 (zero) is used as the priority.  Usually, leaving
	it at the default is enough.
      </p><p>
        There are other parameters we didn't use in our example.
        One of them is <code class="varname">address</code>. It is the address
        used by the component on the <span class="command"><strong>b10-msgq</strong></span>
        message bus. The special components already know their
        address, but the usual ones don't. The address is by
        convention the thing after <span class="emphasis"><em>b10-</em></span>, with
        the first letter capitalized (eg. <span class="command"><strong>b10-stats</strong></span>
        would have <span class="quote">&#8220;<span class="quote">Stats</span>&#8221;</span> as its address).

      </p><p>
	The last one is <code class="varname">process</code>. It is the name
	of the process to be started.  It defaults to the name of
	the component if not set, but you can use this to override
	it. (The special components also already know their
        executable name.)
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          The configuration is quite powerful, but that includes
          a lot of space for mistakes. You could turn off the
          <span class="command"><strong>b10-cmdctl</strong></span>, but then you couldn't
          change it back the usual way, as it would require it to
          be running (you would have to find and edit the configuration
          directly).  Also, some modules might have dependencies:
          <span class="command"><strong>b10-stats-httpd</strong></span> needs
          <span class="command"><strong>b10-stats</strong></span>, <span class="command"><strong>b10-xfrout</strong></span>
          needs <span class="command"><strong>b10-auth</strong></span> to be running, etc.



        </p><p>
          In short, you should think twice before disabling something here.
        </p></div><p>
        It is possible to start some components multiple times (currently
        <span class="command"><strong>b10-auth</strong></span> and <span class="command"><strong>b10-resolver</strong></span>).
        You might want to do that to gain more performance (each one uses only
        single core). Just put multiple entries under different names, like
        this, with the same config:
        </p><pre class="screen">&gt; <strong class="userinput"><code>config add Init/components b10-resolver-2</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-resolver-2/special resolver</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-resolver-2/kind needed</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      </p><p>
        However, this is work in progress and the support is not yet complete.
        For example, each resolver will have its own cache, each authoritative
        server will keep its own copy of in-memory data and there could be
        problems with locking the sqlite database, if used. The configuration
        might be changed to something more convenient in future.
	Other components don't expect such a situation, so it would
	probably not do what you want. Such support is yet to be
	implemented.
      </p><p>
        The running processes started by <span class="command"><strong>b10-init</strong></span>
        may be listed by running <strong class="userinput"><code>Init show_processes</code></strong>
        using <span class="command"><strong>bindctl</strong></span>.
      </p></div></div><div class="chapter" title="Chapter 11. Authoritative Server"><div class="titlepage"><div><div><h2 class="title"><a name="authserver"></a>Chapter 11. Authoritative Server</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#idm66731952">11.1. Server Configurations</a></span></dt><dt><span class="section"><a href="#datasrc">11.2. Data Source Backends</a></span></dt><dd><dl><dt><span class="section"><a href="#datasource-types">11.2.1. Data source types</a></span></dt><dt><span class="section"><a href="#datasrc-examples">11.2.2. Examples</a></span></dt></dl></dd><dt><span class="section"><a href="#idm66675376">11.3. Loading Master Zones Files</a></span></dt></dl></div><p>
      The <span class="command"><strong>b10-auth</strong></span> is the authoritative DNS server.
      It supports EDNS0, DNSSEC, IPv6, and SQLite3 and in-memory zone
      data backends.
      Normally it is started by the <span class="command"><strong>b10-init</strong></span> master
      process.
    </p><div class="section" title="11.1. Server Configurations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66731952"></a>11.1. Server Configurations</h2></div></div></div><p>
        <span class="command"><strong>b10-auth</strong></span> is configured via the
        <span class="command"><strong>b10-cfgmgr</strong></span> configuration manager.
        The module name is <span class="quote">&#8220;<span class="quote">Auth</span>&#8221;</span>.
        The configuration data items are:

        </p><div class="variablelist"><dl><dt><span class="term">database_file</span></dt><dd>This is an optional string to define the path to find
                 the SQLite3 database file.

Note: This may be a temporary setting because the DNS server
can use various data source backends.
              </dd><dt><span class="term">datasources</span></dt><dd>
      <code class="varname">datasources</code> configures data sources.
      The list items include:
      <code class="varname">type</code> to define the required data source type
      (such as <span class="quote">&#8220;<span class="quote">memory</span>&#8221;</span>);
      <code class="varname">class</code> to optionally select the class
      (it defaults to <span class="quote">&#8220;<span class="quote">IN</span>&#8221;</span>);
      and
      <code class="varname">zones</code> to define
      the <code class="varname">file</code> path name,
      the <code class="varname">filetype</code> (<span class="quote">&#8220;<span class="quote">sqlite3</span>&#8221;</span> to load
      from a SQLite3 database file or <span class="quote">&#8220;<span class="quote">text</span>&#8221;</span> to
      load from a master text file),
      and the <code class="varname">origin</code> (default domain).

      By default, this is empty.

      <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Currently this is only used for the memory data source.
        Only the IN class is supported at this time.
        By default, the memory data source is disabled.
        Also, currently the zone file must be canonical such as
        generated by <span class="command"><strong>named-compilezone -D</strong></span>, or
        must be an SQLite3 database.
      </p></div>

              </dd><dt><span class="term">listen_on</span></dt><dd>
      <code class="varname">listen_on</code> is a list of addresses and ports for
      <span class="command"><strong>b10-auth</strong></span> to listen on.
      The list items are the <code class="varname">address</code> string
      and <code class="varname">port</code> number.
      By default, <span class="command"><strong>b10-auth</strong></span> listens on port 53
      on the IPv6 (::) and IPv4 (0.0.0.0) wildcard addresses.
      <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          The default configuration is currently not appropriate for a multi-homed host.
          In case you have multiple public IP addresses, it is possible the
          query UDP packet comes through one interface and the answer goes out
          through another. The answer will probably be dropped by the client, as it
          has a different source address than the one it sent the query to. The
          client would fallback on TCP after several attempts, which works
          well in this situation, but is clearly not ideal.
        </p><p>
          There are plans to solve the problem such that the server handles
          it by itself. But until it is actually implemented, it is recommended to
          alter the configuration &#8212; remove the wildcard addresses and list all
          addresses explicitly. Then the server will answer on the same
          interface the request came on, preserving the correct address.
        </p></div>
              </dd><dt><span class="term">tcp_recv_timeout</span></dt><dd>
                <code class="varname">tcp_recv_timeout</code> is the timeout used on
                incoming TCP connections, in milliseconds. If the query
                is not sent within this time, the connection is closed.
                Setting this to 0 will disable TCP timeouts completely.
              </dd></dl></div><p>

      </p><p>

        The configuration commands are:

        </p><div class="variablelist"><dl><dt><span class="term">loadzone</span></dt><dd>
      <span class="command"><strong>loadzone</strong></span> tells <span class="command"><strong>b10-auth</strong></span>
      to load or reload a zone file. The arguments include:
      <code class="varname">class</code> which optionally defines the class
      (it defaults to <span class="quote">&#8220;<span class="quote">IN</span>&#8221;</span>);
      <code class="varname">origin</code> is the domain name of the zone;
      and
      <code class="varname">datasrc</code> optionally defines the type of datasource
      (it defaults to <span class="quote">&#8220;<span class="quote">memory</span>&#8221;</span>).

      <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Currently this only supports the
        IN class and the memory data source.
      </p></div>
              </dd><dt><span class="term">getstats</span></dt><dd>
      <span class="command"><strong>getstats</strong></span> requests <span class="command"><strong>b10-auth</strong></span>
      to send its statistics data to
      <span class="citerefentry"><span class="refentrytitle">b10-stats</span>(8)</span>
      as a response of the command.
              </dd><dt><span class="term">shutdown</span></dt><dd>Stop the authoritative DNS server.
      This has an optional <code class="varname">pid</code> argument to
      select the process ID to stop.
      (Note that the BIND 10 init process may restart this service
      if configured.)
              </dd></dl></div><p>

      </p></div><div class="section" title="11.2. Data Source Backends"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="datasrc"></a>11.2. Data Source Backends</h2></div></div></div><p>
        Bind 10 has the concept of data sources. A data source is a place
        where authoritative zone data reside and where they can be served
        from. This can be a master file, a database or something completely
        different.
      </p><p>
        Once a query arrives, <span class="command"><strong>b10-auth</strong></span> goes through a
        configured list of data sources and finds the one containing a best
        matching zone. From the equally good ones, the first one is taken.
        This data source is then used to answer the query.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        In the current release, <span class="command"><strong>b10-auth</strong></span>
        can serve data from a SQLite3 data source backend and from master
        files.
        Upcoming versions will be able to use multiple different
        data sources, such as MySQL and Berkeley DB.
      </p></div><p>
        The configuration is located in data_sources/classes. Each item there
        represents one RR class and a list used to answer queries for that
        class. The default contains two classes. The CH class contains a
        built-in data source &#8212; one that serves things like
        <span class="quote">&#8220;<span class="quote">AUTHORS.BIND.</span>&#8221;</span>. The IN class contains single SQLite3
        data source with database file located at
        <code class="filename">/usr/local/var/bind10/zone.sqlite3</code>.
      </p><p>
        Each data source has several options. The first one is
        <code class="varname">type</code>, which specifies the type of data source to
        use. Valid types include the ones listed below, but BIND 10 uses
        dynamically loaded modules for them, so there may be more in your
        case. This option is mandatory.
      </p><p>
        Another option is <code class="varname">params</code>. This option is type
        specific; it holds different data depending on the type
        above. Also, depending on the type, it could be possible to omit it.
      </p><p>
        There are two options related to the so-called cache. If you enable
        cache, zone data from the data source are loaded into memory.
        Then, when answering a query, <span class="command"><strong>b10-auth</strong></span> looks
        into the memory only instead of the data source, which speeds
        answering up. The first option is <code class="varname">cache-enable</code>,
        a boolean value turning the cache on and off (off is the default).
        The second one, <code class="varname">cache-zones</code>, is a list of zone
        origins to load into in-memory.


      </p><div class="section" title="11.2.1. Data source types"><div class="titlepage"><div><div><h3 class="title"><a name="datasource-types"></a>11.2.1. Data source types</h3></div></div></div><p>
          As mentioned, the type used by default is <span class="quote">&#8220;<span class="quote">sqlite3</span>&#8221;</span>.
          It has single configuration option inside <code class="varname">params</code>
          &#8212; <code class="varname">database_file</code>, which contains the path
          to the SQLite3 file containing the data.
        </p><p>
          Another type is called <span class="quote">&#8220;<span class="quote">MasterFiles</span>&#8221;</span>. This one is
          slightly special. The data are stored in RFC1034 master files.
          Because answering directly from them would be impractical,
          this type mandates the cache to be enabled. Also, the list of
          zones (<code class="varname">cache-zones</code>) should be omitted. The
          <code class="varname">params</code> is a dictionary mapping from zone
          origins to the files they reside in.
        </p></div><div class="section" title="11.2.2. Examples"><div class="titlepage"><div><div><h3 class="title"><a name="datasrc-examples"></a>11.2.2. Examples</h3></div></div></div><p>
          As this is one of the more complex configurations of BIND 10,
          we show some examples. They all assume they start with default
          configuration.
        </p><p>
          First, let's disable the built-in data source
          (<span class="quote">&#8220;<span class="quote">VERSION.BIND</span>&#8221;</span> and friends). As it is the only
          data source in the CH class, we can remove the whole class.

          </p><pre class="screen">&gt; <strong class="userinput"><code>config remove data_sources/classes CH</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        </p><p>
          Another one, let's say our default data source contains zones
          <span class="quote">&#8220;<span class="quote">example.org.</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">example.net.</span>&#8221;</span>.
          We want them to be served from memory to make the answering
          faster.

          </p><pre class="screen">&gt; <strong class="userinput"><code>config set data_sources/classes/IN[0]/cache-enable true</code></strong>
&gt; <strong class="userinput"><code>config add data_sources/classes/IN[0]/cache-zones example.org.</code></strong>
&gt; <strong class="userinput"><code>config add data_sources/classes/IN[0]/cache-zones example.net.</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>

          Now every time the zone in the data source is changed by the
          operator, the authoritative server needs to be told to reload it, by
          </p><pre class="screen">&gt; <strong class="userinput"><code>Auth loadzone example.org</code></strong></pre><p>
          You don't need to do this when the zone is modified by
          <span class="command"><strong>b10-xfrin</strong></span>; it does so automatically.
        </p><p>
          Now, the last example is when there are master files we want to
          serve in addition to whatever is inside the SQLite3 database.

          </p><pre class="screen">&gt; <strong class="userinput"><code>config add data_sources/classes/IN</code></strong>
&gt; <strong class="userinput"><code>config set data_sources/classes/IN[1]/type MasterFiles</code></strong>
&gt; <strong class="userinput"><code>config set data_sources/classes/IN[1]/cache-enable true</code></strong>
&gt; <strong class="userinput"><code>config set data_sources/classes/IN[1]/params { "example.org": "/path/to/example.org", "example.com": "/path/to/example.com" }</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>

          Initially, a map value has to be set, but this value may be an
          empty map. After that, key/value pairs can be added with 'config
          add' and keys can be removed with 'config remove'. The initial
          value may be an empty map, but it has to be set before zones are
          added or removed.

          </p><pre class="screen">
&gt; <strong class="userinput"><code>config set data_sources/classes/IN[1]/params {}</code></strong>
&gt; <strong class="userinput"><code>config add data_sources/classes/IN[1]/params another.example.org /path/to/another.example.org</code></strong>
&gt; <strong class="userinput"><code>config add data_sources/classes/IN[1]/params another.example.com /path/to/another.example.com</code></strong>
&gt; <strong class="userinput"><code>config remove data_sources/classes/IN[1]/params another.example.org</code></strong>
          </pre><p>

          <span class="command"><strong>bindctl</strong></span>. To reload a zone, you the same command
          as above.
        </p></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        There's also <code class="varname">Auth/database_file</code> configuration
        variable, pointing to a SQLite3 database file. This is no longer
        used by <span class="command"><strong>b10-auth</strong></span>, but it is left in place for
        now, since other modules use it. Once <span class="command"><strong>b10-xfrin</strong></span>,
        <span class="command"><strong>b10-xfrout</strong></span> and <span class="command"><strong>b10-ddns</strong></span>
        are ported to the new configuration, this will disappear. But for
        now, make sure that if you use any of these modules, the new
        and old configuration correspond. The defaults are consistent, so
        unless you tweaked either the new or the old configuration, you're
        good.
      </p></div></div><div class="section" title="11.3. Loading Master Zones Files"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66675376"></a>11.3. Loading Master Zones Files</h2></div></div></div><p>
        RFC 1035 style DNS master zone files may imported
        into a BIND 10 SQLite3 data source by using the
        <span class="command"><strong>b10-loadzone</strong></span> utility.
      </p><p>
        <span class="command"><strong>b10-loadzone</strong></span> supports the following
        special directives (control entries):

        </p><div class="variablelist"><dl><dt><span class="term">$INCLUDE</span></dt><dd>Loads an additional zone file. This may be recursive.
              </dd><dt><span class="term">$ORIGIN</span></dt><dd>Defines the relative domain name.
              </dd><dt><span class="term">$TTL</span></dt><dd>Defines the time-to-live value used for following
                records that don't include a TTL.
              </dd></dl></div><p>

      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        In the current release, only the SQLite3 back
        end is used by <span class="command"><strong>b10-loadzone</strong></span>.
        Multiple zones are stored in a single SQLite3 zone database.
      </p></div><p>
        If you reload a zone already existing in the database,
        all records from that prior zone disappear and a whole new set
        appears.
      </p></div></div><div class="chapter" title="Chapter 12. Incoming Zone Transfers"><div class="titlepage"><div><div><h2 class="title"><a name="xfrin"></a>Chapter 12. Incoming Zone Transfers</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#idm66661296">12.1. Configuration for Incoming Zone Transfers</a></span></dt><dt><span class="section"><a href="#idm66656816">12.2. TSIG</a></span></dt><dt><span class="section"><a href="#idm66654768">12.3. Enabling IXFR</a></span></dt><dt><span class="section"><a href="#zonemgr">12.4. Secondary Manager</a></span></dt><dt><span class="section"><a href="#idm66642096">12.5. Trigger an Incoming Zone Transfer Manually</a></span></dt><dt><span class="section"><a href="#idm66638896">12.6. Incoming Transfers with In-memory Datasource</a></span></dt></dl></div><p>
      Incoming zones are transferred using the <span class="command"><strong>b10-xfrin</strong></span>
      process which is started by <span class="command"><strong>b10-init</strong></span>.
      When received, the zone is stored in the corresponding BIND 10
      data source, and its records can be served by
      <span class="command"><strong>b10-auth</strong></span>.
      In combination with <span class="command"><strong>b10-zonemgr</strong></span> (for
      automated SOA checks), this allows the BIND 10 server to
      provide <span class="emphasis"><em>secondary</em></span> service.
    </p><p>
      The <span class="command"><strong>b10-xfrin</strong></span> process supports both AXFR and
      IXFR.  Due to some implementation limitations of the current
      development release, however, it only tries AXFR by default,
      and care should be taken to enable IXFR.
    </p><div class="section" title="12.1. Configuration for Incoming Zone Transfers"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66661296"></a>12.1. Configuration for Incoming Zone Transfers</h2></div></div></div><p>
        In practice, you need to specify a list of secondary zones to
        enable incoming zone transfers for these zones (you can still
        trigger a zone transfer manually, without a prior configuration
        (see below)).
      </p><p>
        For example, to enable zone transfers for a zone named "example.com"
        (whose master address is assumed to be 2001:db8::53 here),
        run the following at the <span class="command"><strong>bindctl</strong></span> prompt:

      </p><pre class="screen">&gt; <strong class="userinput"><code>config add Xfrin/zones</code></strong>
&gt; <strong class="userinput"><code>config set Xfrin/zones[0]/name "<code class="option">example.com</code>"</code></strong>
&gt; <strong class="userinput"><code>config set Xfrin/zones[0]/master_addr "<code class="option">2001:db8::53</code>"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>

      (We assume there has been no zone configuration before).
      </p></div><div class="section" title="12.2. TSIG"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66656816"></a>12.2. TSIG</h2></div></div></div>
        If you want to use TSIG for incoming transfers, a system wide TSIG
        key ring must be configured (see <a class="xref" href="#tsig-key-ring" title="9.1.2. Key ring">Section 9.1.2, &#8220;Key ring&#8221;</a>).
        To specify a key to use, set tsig_key value to the name of the key
        to use from the key ring.
&gt; <strong class="userinput"><code>config set Xfrin/zones[0]/tsig_key "<code class="option">example.key</code>"</code></strong></div><div class="section" title="12.3. Enabling IXFR"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66654768"></a>12.3. Enabling IXFR</h2></div></div></div><p>
        As noted above, <span class="command"><strong>b10-xfrin</strong></span> uses AXFR for
        zone transfers by default.  To enable IXFR for zone transfers
        for a particular zone, set the <code class="varname">use_ixfr</code>
        configuration parameter to <span class="quote">&#8220;<span class="quote">true</span>&#8221;</span>.
        In the above example of configuration sequence, you'll need
        to add the following before performing <strong class="userinput"><code>commit</code></strong>:
      </p><pre class="screen">&gt; <strong class="userinput"><code>config set Xfrin/zones[0]/use_ixfr true</code></strong></pre><p>
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      One reason why IXFR is disabled by default in the current
      release is because it does not support automatic fallback from IXFR to
      AXFR when it encounters a primary server that doesn't support
      outbound IXFR (and, not many existing implementations support
      it).  Another, related reason is that it does not use AXFR even
      if it has no knowledge about the zone (like at the very first
      time the secondary server is set up).  IXFR requires the
      "current version" of the zone, so obviously it doesn't work
      in this situation and AXFR is the only workable choice.
      The current release of <span class="command"><strong>b10-xfrin</strong></span> does not
      make this selection automatically.
      These features will be implemented in a near future
      version, at which point we will enable IXFR by default.
      </p></div></div><div class="section" title="12.4. Secondary Manager"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="zonemgr"></a>12.4. Secondary Manager</h2></div></div></div><p>
        The <span class="command"><strong>b10-zonemgr</strong></span> process is started by
        <span class="command"><strong>b10-init</strong></span>.
        It keeps track of SOA refresh, retry, and expire timers
        and other details for BIND 10 to perform as a slave.
        When the <span class="command"><strong>b10-auth</strong></span> authoritative DNS server
        receives a NOTIFY message, <span class="command"><strong>b10-zonemgr</strong></span>
        may tell <span class="command"><strong>b10-xfrin</strong></span> to do a refresh
        to start an inbound zone transfer.
        The secondary manager resets its counters when a new zone is
        transferred in.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Access control (such as allowing notifies) is not yet provided.
        The primary/secondary service is not yet complete.
      </p></div><p>
        The following example shows using <span class="command"><strong>bindctl</strong></span>
        to configure the server to be a secondary for the example zone:

      </p><pre class="screen">&gt; <strong class="userinput"><code>config add Zonemgr/secondary_zones</code></strong>
&gt; <strong class="userinput"><code>config set Zonemgr/secondary_zones[0]/name "<code class="option">example.com</code>"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>

      </p><p>
        If the zone does not exist in the data source already
        (i.e. no SOA record for it), <span class="command"><strong>b10-zonemgr</strong></span>
        will automatically tell <span class="command"><strong>b10-xfrin</strong></span>
        to transfer the zone in.
      </p></div><div class="section" title="12.5. Trigger an Incoming Zone Transfer Manually"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66642096"></a>12.5. Trigger an Incoming Zone Transfer Manually</h2></div></div></div><p>
        To manually trigger a zone transfer to retrieve a remote zone,
        you may use the <span class="command"><strong>bindctl</strong></span> utility.
        For example, at the <span class="command"><strong>bindctl</strong></span> prompt run:

        </p><pre class="screen">&gt; <strong class="userinput"><code>Xfrin retransfer zone_name="<code class="option">foo.example.org</code>" master=<code class="option">192.0.2.99</code></code></strong></pre><p>
      </p></div><div class="section" title="12.6. Incoming Transfers with In-memory Datasource"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66638896"></a>12.6. Incoming Transfers with In-memory Datasource</h2></div></div></div><p>
        In the case of an incoming zone transfer, the received zone is
        first stored in the corresponding BIND 10 datasource. In
        case the secondary zone is served by an in-memory datasource
        with an SQLite3 backend, <span class="command"><strong>b10-auth</strong></span> is
        automatically sent a <code class="varname">loadzone</code> command to
        reload the corresponding zone into memory from the backend.
      </p><p>
	The administrator doesn't have to do anything for
	<span class="command"><strong>b10-auth</strong></span> to serve the new version of the
	zone, except for the configuration such as the one described in
	<a class="xref" href="#datasrc" title="11.2. Data Source Backends">Section 11.2, &#8220;Data Source Backends&#8221;</a>.
      </p></div></div><div class="chapter" title="Chapter 13. Outbound Zone Transfers"><div class="titlepage"><div><div><h2 class="title"><a name="xfrout"></a>Chapter 13. Outbound Zone Transfers</h2></div></div></div><p>
      The <span class="command"><strong>b10-xfrout</strong></span> process is started by
      <span class="command"><strong>b10-init</strong></span>.
      When the <span class="command"><strong>b10-auth</strong></span> authoritative DNS server
      receives an AXFR or IXFR request, <span class="command"><strong>b10-auth</strong></span>
      internally forwards the request to <span class="command"><strong>b10-xfrout</strong></span>,
      which handles the rest of this request processing.
      This is used to provide primary DNS service to share zones
      to secondary name servers.
      The <span class="command"><strong>b10-xfrout</strong></span> is also used to send
      NOTIFY messages to secondary servers.
    </p><p>
      A global or per zone <code class="option">transfer_acl</code> configuration
      can be used to control accessibility of the outbound zone
      transfer service.
      By default, <span class="command"><strong>b10-xfrout</strong></span> allows any clients to
      perform zone transfers for any zones.
    </p><pre class="screen">&gt; <strong class="userinput"><code>config show Xfrout/transfer_acl</code></strong>
Xfrout/transfer_acl[0]	{"action": "ACCEPT"}	any	(default)</pre><p>
      If you want to require TSIG in access control, a system wide TSIG
      key ring must be configured (see <a class="xref" href="#tsig-key-ring" title="9.1.2. Key ring">Section 9.1.2, &#8220;Key ring&#8221;</a>).
      In this example, we allow client matching both the IP address
      and key.
    </p><pre class="screen">&gt; <strong class="userinput"><code>config set tsig_keys/keys ["key.example:&lt;base64-key&gt;"]</code></strong>
&gt; <strong class="userinput"><code>config set Xfrout/zone_config[0]/transfer_acl [{"action": "ACCEPT", "from": "192.0.2.1", "key": "key.example"}]</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>Both <span class="command"><strong>b10-xfrout</strong></span> and <span class="command"><strong>b10-auth</strong></span>
      will use the system wide key ring to check
      TSIGs in the incoming messages and to sign responses.</p><p>
      For further details on ACL configuration, see
      <a class="xref" href="#common-acl" title="9.2. ACLs">Section 9.2, &#8220;ACLs&#8221;</a>.
    </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        The way to specify zone specific configuration (ACLs, etc) is
        likely to be changed.
    </p></div></div><div class="chapter" title="Chapter 14. Dynamic DNS Update"><div class="titlepage"><div><div><h2 class="title"><a name="ddns"></a>Chapter 14. Dynamic DNS Update</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#idm66614960">14.1. Enabling Dynamic Update</a></span></dt><dt><span class="section"><a href="#idm66602544">14.2. Access Control</a></span></dt><dt><span class="section"><a href="#idm66579888">14.3. Miscellaneous Operational Issues</a></span></dt></dl></div><p>
      BIND 10 supports the server side of the Dynamic DNS Update
      (DDNS) protocol as defined in RFC 2136.
      This service is provided by the <span class="command"><strong>b10-ddns</strong></span>
      component, which is started by the <span class="command"><strong>b10-init</strong></span>
      process if configured so.
    </p><p>
      When the <span class="command"><strong>b10-auth</strong></span> authoritative DNS server
      receives an UPDATE request, it internally forwards the request
      to <span class="command"><strong>b10-ddns</strong></span>, which handles the rest of
      this request processing.
      When the processing is completed, <span class="command"><strong>b10-ddns</strong></span>
      will send a response to the client as specified in RFC 2136
      (NOERROR for successful update, REFUSED if rejected due to
      ACL check, etc).
      If the zone has been changed as a result, it will internally
      notify <span class="command"><strong>b10-xfrout</strong></span> so that other secondary
      servers will be notified via the DNS NOTIFY protocol.
      In addition, if <span class="command"><strong>b10-auth</strong></span> serves the updated
      zone (as described in
      <a class="xref" href="#datasrc" title="11.2. Data Source Backends">Section 11.2, &#8220;Data Source Backends&#8221;</a>),
      <span class="command"><strong>b10-ddns</strong></span> will also
      notify <span class="command"><strong>b10-auth</strong></span> so that <span class="command"><strong>b10-auth</strong></span>
      will re-cache the updated zone content if necessary.
    </p><p>
      The <span class="command"><strong>b10-ddns</strong></span> component supports requests over
      both UDP and TCP, and both IPv6 and IPv4; for TCP requests,
      however, it terminates the TCP connection immediately after
      each single request has been processed.  Clients cannot reuse the
      same TCP connection for multiple requests. (This is a current
      implementation limitation of <span class="command"><strong>b10-ddns</strong></span>.
      While RFC 2136 doesn't specify anything about such reuse of TCP
      connection, there is no reason for disallowing it as RFC 1035
      generally allows multiple requests sent over a single TCP
      connection.  BIND 9 supports such reuse.)
    </p><p>
      As of this writing <span class="command"><strong>b10-ddns</strong></span> does not support
      update forwarding for secondary zones.
      If it receives an update request for a secondary zone, it will
      immediately return a <span class="quote">&#8220;<span class="quote">not implemented</span>&#8221;</span> response.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
	  For feature completeness, update forwarding should be
	  eventually supported.  But currently it's considered a lower
	  priority task and there is no specific plan of implementing
	  this feature.

      </p></div><p>
    </p><div class="section" title="14.1. Enabling Dynamic Update"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66614960"></a>14.1. Enabling Dynamic Update</h2></div></div></div><p>
        First off, it must be made sure that a few components on which
        <span class="command"><strong>b10-ddns</strong></span> depends are configured to run,
        which are <span class="command"><strong>b10-auth</strong></span>
        and <span class="command"><strong>b10-zonemgr</strong></span>.
        In addition, <span class="command"><strong>b10-xfrout</strong></span> should also be
        configured to run; otherwise the notification after an update
        (see above) will fail with a timeout, suspending the DDNS
        service while <span class="command"><strong>b10-ddns</strong></span> waits for the
        response (see the description of the <a class="ulink" href="bind10-messages.html#DDNS_UPDATE_NOTIFY_FAIL" target="_top">DDNS_UPDATE_NOTIFY_FAIL</a>
        log message for further details).
        If BIND 10 is already configured to provide authoritative DNS
        service they should normally be configured to run already.
      </p><p>
        Second, for the obvious reason dynamic update requires that the
        underlying data source storing the zone data be writable.
        In the current implementation this means the zone must be stored
        in an SQLite3-based data source.

	Also, in this current version, the <span class="command"><strong>b10-ddns</strong></span>
	component configures itself with the data source referring to the
        <code class="varname">database_file</code> configuration parameter of
        <span class="command"><strong>b10-auth</strong></span>.
        So this information must be configured correctly before starting
        <span class="command"><strong>b10-ddns</strong></span>.

        </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            The way to configure data sources is now being revised.
            Configuration on the data source for DDNS will be very
            likely to be changed in a backward incompatible manner in
            a near future version.
        </p></div><p>
      </p><p>
	In general, if something goes wrong regarding the dependency
	described above, <span class="command"><strong>b10-ddns</strong></span> will log the
	related event at the warning or error level.
	It's advisable to check the log message when you first enable
	DDNS or if it doesn't work as you expect to see if there's any
	warning or error log message.
      </p><p>
        Next, to enable the DDNS service, <span class="command"><strong>b10-ddns</strong></span>
        needs to be explicitly configured to run.
        It can be done by using the <span class="command"><strong>bindctl</strong></span>
        utility.  For example:
      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Init/components b10-ddns</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-ddns/address DDNS</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-ddns/kind dispensable</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
	  In theory <code class="varname">kind</code> could be omitted because
	  "dispensable" is its default.
	  But there's some peculiar behavior (which should be a
	  bug and should be fixed eventually; see Trac ticket #2064)
	  with <span class="command"><strong>bindctl</strong></span> and you'll still need to
	  specify that explicitly.  Likewise, <code class="varname">address</code>
	  may look unnecessary because <span class="command"><strong>b10-ddns</strong></span>
	  would start and work without specifying it.  But for it
	  to shutdown gracefully this parameter should also be
	  specified.
      </p></div><p>
      </p></div><div class="section" title="14.2. Access Control"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66602544"></a>14.2. Access Control</h2></div></div></div><p>
        By default, <span class="command"><strong>b10-ddns</strong></span> rejects any update
        requests from any clients by returning a REFUSED response.
        To allow updates to take effect, an access control rule
        (called update ACL) with a policy allowing updates must explicitly be
        configured.
        Update ACL must be configured per zone basis in the
        <code class="varname">zones</code> configuration parameter of
        <span class="command"><strong>b10-ddns</strong></span>.
        This is a list of per-zone configurations regarding DDNS.
        Each list element consists of the following parameters:
        </p><div class="variablelist"><dl><dt><span class="term">origin</span></dt><dd>The zone's origin name</dd><dt><span class="term">class</span></dt><dd>The RR class of the zone
                (normally <span class="quote">&#8220;<span class="quote">IN</span>&#8221;</span>, and in that case
		can be omitted in configuration)</dd><dt><span class="term">update_acl</span></dt><dd>List of access control rules (ACL) for the zone</dd></dl></div><p>
        The syntax of the ACL is the same as ACLs for other
        components.
        Specific examples are given below.
      </p><p>
        In general, an update ACL rule that allows an update request
        should be configured with a TSIG key.
        This is an example update ACL that allows updates to the zone
        named <span class="quote">&#8220;<span class="quote">example.org</span>&#8221;</span> (of default RR class <span class="quote">&#8220;<span class="quote">IN</span>&#8221;</span>)
        from clients that send requests signed with a TSIG whose
        key name is "key.example.org" (and refuses all others):
      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add DDNS/zones</code></strong>
&gt; <strong class="userinput"><code>config set DDNS/zones[0]/origin example.org</code></strong>
&gt; <strong class="userinput"><code>config add DDNS/zones[0]/update_acl {"action": "ACCEPT", "key": "key.example.org"}</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
      The TSIG key must be configured system wide
      (see <a class="xref" href="#common-tsig" title="9.1. TSIG keys">Section 9.1, &#8220;TSIG keys&#8221;</a>).
      </p><p>
	The full description of ACLs can be found in <a class="xref" href="#common-acl" title="9.2. ACLs">Section 9.2, &#8220;ACLs&#8221;</a>.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          The <span class="command"><strong>b10-ddns</strong></span> component accepts an ACL
          rule that just allows updates from a specific IP address
          (i.e., without requiring TSIG), but this is highly
          discouraged (remember that requests can be made over UDP and
          spoofing the source address of a UDP packet is often pretty
          easy).
          Unless you know what you are doing and that you can accept
          its consequence, any update ACL rule that allows updates
          should have a TSIG key in its constraints.
      </p></div><p>
        Currently update ACL can only control updates per zone basis;
        it's not possible to specify access control with higher
        granularity such as for particular domain names or specific
        types of RRs.

      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Contrary to what RFC 2136 (literally) specifies,
        <span class="command"><strong>b10-ddns</strong></span> checks the update ACL before
        checking the prerequisites of the update request.
        This is a deliberate implementation decision.
        This counter intuitive specification has been repeatedly
        discussed among implementers and in the IETF, and it is now
        widely agreed that it does not make sense to strictly follow
        that part of RFC.
        One known specific bad result of following the RFC is that it
        could leak information about which name or record exists or does not
        exist in the zone as a result of prerequisite checks even if a
        zone is somehow configured to reject normal queries from
        arbitrary clients.
        There have been other troubles that could have been avoided if
        the ACL could be checked before the prerequisite check.
      </p></div></div><div class="section" title="14.3. Miscellaneous Operational Issues"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66579888"></a>14.3. Miscellaneous Operational Issues</h2></div></div></div><p>
        Unlike BIND 9, BIND 10 currently does not support automatic
        re-signing of DNSSEC-signed zone when it's updated via DDNS.
        It could be possible to re-sign the updated zone afterwards
        or make sure the update request also updates related DNSSEC
        records, but that will be pretty error-prone operation.
        In general, it's not advisable to allow DDNS for a signed zone
        at this moment.
      </p><p>
        Also unlike BIND 9, it's currently not possible
        to <span class="quote">&#8220;<span class="quote">freeze</span>&#8221;</span> a zone temporarily in order to
        suspend DDNS while you manually update the zone.
        If you need to make manual updates to a dynamic zone,
        you'll need to temporarily reject any updates to the zone via
        the update ACLs.
      </p><p>
        Dynamic updates are only applicable to primary zones.
        In order to avoid updating secondary zones via DDNS requests,
        <span class="command"><strong>b10-ddns</strong></span> refers to the
        <span class="quote">&#8220;<span class="quote">secondary_zones</span>&#8221;</span> configuration of
        <span class="command"><strong>b10-zonemgr</strong></span>.  Zones listed in
        <span class="quote">&#8220;<span class="quote">secondary_zones</span>&#8221;</span> will never be updated via DDNS
        regardless of the update ACL configuration;
	<span class="command"><strong>b10-ddns</strong></span> will return a NOTAUTH (server
        not authoritative for the zone) response.
        If you have a "conceptual" secondary zone whose content is a
        copy of some external source but is not updated via the
        standard zone transfers and therefore not listed in
        <span class="quote">&#8220;<span class="quote">secondary_zones</span>&#8221;</span>, be careful not to allow DDNS
        for the zone; it would be quite likely to lead to inconsistent
        state between different servers.
        Normally this should not be a problem because the default
        update ACL rejects any update requests, but you may want to
        take an extra care about the configuration if you have such
        type of secondary zones.
      </p><p>
        The difference of two versions of a zone, before and after a
        DDNS transaction, is automatically recorded in the underlying
        data source, and can be retrieved in the form of outbound
        IXFR.
        This is done automatically; it does not require specific
        configuration to make this possible.
      </p></div></div><div class="chapter" title="Chapter 15. Recursive Name Server"><div class="titlepage"><div><div><h2 class="title"><a name="resolverserver"></a>Chapter 15. Recursive Name Server</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#idm66554160">15.1. Access Control</a></span></dt><dt><span class="section"><a href="#idm66548912">15.2. Forwarding</a></span></dt></dl></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      The <span class="command"><strong>b10-resolver</strong></span> is an experimental proof
      of concept.
    </p></div><p>
      The <span class="command"><strong>b10-resolver</strong></span> daemon provides an
      iterative caching and forwarding DNS server.
      The process is started by <span class="command"><strong>b10-init</strong></span>.

    </p><p>
      The main <span class="command"><strong>b10-init</strong></span> process can be configured
      to select to run either the authoritative or resolver or both.
      By default, it doesn't start either one. You may change this using
      <span class="command"><strong>bindctl</strong></span>, for example:

      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Init/components b10-resolver</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-resolver/special resolver</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-resolver/kind needed</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-resolver/priority 10</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>

    </p><p>
       The master <span class="command"><strong>b10-init</strong></span> process will stop and start
       the desired services.
    </p><p>
      By default, the resolver listens on port 53 for 127.0.0.1 and ::1.
      The following example shows how it can be configured to
      listen on an additional address (and port):

      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Resolver/listen_on</code></strong>
&gt; <strong class="userinput"><code>config set Resolver/listen_on[<em class="replaceable"><code>2</code></em>]/address "192.168.1.1"</code></strong>
&gt; <strong class="userinput"><code>config set Resolver/listen_on[<em class="replaceable"><code>2</code></em>]/port 53</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
    </p><p>(Replace the <span class="quote">&#8220;<span class="quote"><em class="replaceable"><code>2</code></em></span>&#8221;</span>
       as needed; run <span class="quote">&#8220;<span class="quote"><strong class="userinput"><code>config show
       Resolver/listen_on</code></strong></span>&#8221;</span> if needed.)</p><div class="section" title="15.1. Access Control"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66554160"></a>15.1. Access Control</h2></div></div></div><p>
        By default, the <span class="command"><strong>b10-resolver</strong></span> daemon only accepts
        DNS queries from the localhost (127.0.0.1 and ::1).
        The <code class="option">Resolver/query_acl</code> configuration may
        be used to reject, drop, or allow specific IPs or networks.
        See <a class="xref" href="#common-acl" title="9.2. ACLs">Section 9.2, &#8220;ACLs&#8221;</a>.
      </p><p>
	The following session is an example of extending the ACL to also
	allow queries from 192.0.2.0/24:
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config show Resolver/query_acl</code></strong>
Resolver/query_acl[0]   {"action": "ACCEPT", "from": "127.0.0.1"}   any (default)
Resolver/query_acl[1]   {"action": "ACCEPT", "from": "::1"} any (default)
&gt; <strong class="userinput"><code>config add Resolver/query_acl</code></strong>
&gt; <strong class="userinput"><code>config set Resolver/query_acl[2] {"action": "ACCEPT", "from": "192.0.2.0/24"}</code></strong>
&gt; <strong class="userinput"><code>config add Resolver/query_acl</code></strong>
&gt; <strong class="userinput"><code>config show Resolver/query_acl</code></strong>
Resolver/query_acl[0]   {"action": "ACCEPT", "from": "127.0.0.1"}   any (modified)
Resolver/query_acl[1]   {"action": "ACCEPT", "from": "::1"} any (modified)
Resolver/query_acl[2]   {"action": "ACCEPT", "from": "192.0.2.0/24"}  any (modified)
Resolver/query_acl[3]   {"action": "REJECT"}    any (modified)
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
	Note that we didn't set the value of the last final rule
	(query_acl[3]) -- in the case of resolver, rejecting all queries is
	the default value of a new rule.  In fact, this rule can even be
	omitted completely, as the default, when a query falls off the list,
	is rejection.
      </p></div><div class="section" title="15.2. Forwarding"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm66548912"></a>15.2. Forwarding</h2></div></div></div><p>

        To enable forwarding, the upstream address and port must be
        configured to forward queries to, such as:

        </p><pre class="screen">
&gt; <strong class="userinput"><code>config set Resolver/forward_addresses [{ "address": "<em class="replaceable"><code>192.168.1.1</code></em>", "port": 53 }]</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>

        (Replace <em class="replaceable"><code>192.168.1.1</code></em> to point to your
        full resolver.)
      </p><p>
        Normal iterative name service can be re-enabled by clearing the
        forwarding address(es); for example:

        </p><pre class="screen">
&gt; <strong class="userinput"><code>config set Resolver/forward_addresses []</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
      </p></div></div><div class="chapter" title="Chapter 16. DHCP"><div class="titlepage"><div><div><h2 class="title"><a name="dhcp"></a>Chapter 16. DHCP</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#dhcp-install-configure">16.1. DHCP Database Installation and Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#idm66539312">16.1.1. Install MySQL</a></span></dt><dt><span class="section"><a href="#idm66538032">16.1.2. Build and Install BIND 10</a></span></dt><dt><span class="section"><a href="#dhcp-database-create">16.1.3. Create MySQL Database and BIND 10 User</a></span></dt></dl></dd></dl></div><p>The Dynamic Host Configuration Protocol for IPv4 (DHCP or
    DHCPv4) and Dynamic Host Configuration Protocol for IPv6 (DHCPv6)
    are protocols that allow one node (server) to provision
    configuration parameters to many hosts and devices (clients). To
    ease deployment in larger networks, additional nodes (relays) may
    be deployed that facilitate communication between servers and
    clients. Even though principles of both DHCPv4 and DHCPv6 are
    somewhat similar, these are two radically different
    protocols. BIND 10 offers two server implementations, one for DHCPv4
    and one for DHCPv6.</p><p>This chapter covers those parts of BIND 10 that are common to
    both servers.  DHCPv4-specific details are covered in <a class="xref" href="#dhcp4" title="Chapter 17. The DHCPv4 Server">Chapter 17, <i>The DHCPv4 Server</i></a>,
    while those details specific to DHCPv6 are described in <a class="xref" href="#dhcp6" title="Chapter 18. The DHCPv6 Server">Chapter 18, <i>The DHCPv6 Server</i></a>
    </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
	In this release of BIND 10, the DHCPv4 and DHCPv6 servers
	must be considered experimental.
      </p></div><div class="section" title="16.1. DHCP Database Installation and Configuration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp-install-configure"></a>16.1. DHCP Database Installation and Configuration</h2></div></div></div><p>
      BIND 10 DHCP stores its leases in a lease database.  The software has been written in
      a way that makes it possible to choose which database product should be used to
      store the lease information.  At present, only support for MySQL is provided, and that support must
      be explicitly included when BIND 10 is built.  This section covers the building of
      BIND 10 with MySQL and the creation of the lease database.
      </p><div class="section" title="16.1.1. Install MySQL"><div class="titlepage"><div><div><h3 class="title"><a name="idm66539312"></a>16.1.1. Install MySQL</h3></div></div></div><p>
          Install MySQL according to the instructions for your system.  The client development
          libraries must be installed.
        </p></div><div class="section" title="16.1.2. Build and Install BIND 10"><div class="titlepage"><div><div><h3 class="title"><a name="idm66538032"></a>16.1.2. Build and Install BIND 10</h3></div></div></div><p>
          Build and install BIND 10 as described in <a class="xref" href="#installation" title="Chapter 3. Installation">Chapter 3, <i>Installation</i></a>, with
          the following modification: to enable the MySQL database code, at the
          "configure" step (see <a class="xref" href="#configure" title="3.4.3. Configure before the build">Section 3.4.3, &#8220;Configure before the build&#8221;</a>), specify the location of the
          MySQL configuration program "mysql_config" with the "--with-dhcp-mysql" switch,
          i.e.
          </p><pre class="screen"><strong class="userinput"><code>./configure [other-options] --with-dhcp-mysql</code></strong></pre><p>
          ...if MySQL was installed in the default location, or:
          </p><pre class="screen"><strong class="userinput"><code>./configure [other-options] --with-dhcp-mysql=<em class="replaceable"><code>path-to-mysql_config</code></em></code></strong></pre><p>
          ...if not.
        </p></div><div class="section" title="16.1.3. Create MySQL Database and BIND 10 User"><div class="titlepage"><div><div><h3 class="title"><a name="dhcp-database-create"></a>16.1.3. Create MySQL Database and BIND 10 User</h3></div></div></div><p>
          The next task is to create both the lease database and the user under which the servers will
          access it. A number of steps are required:
        </p><p>
          1. Log into MySQL as "root":
          </p><pre class="screen">$ <strong class="userinput"><code>mysql -u root -p</code></strong>
Enter password:<strong class="userinput"><code></code></strong>
   :<strong class="userinput"><code></code></strong>
mysql&gt;</pre><p>
        </p><p>
          2. Create the database:
          </p><pre class="screen">mysql&gt; <strong class="userinput"><code>CREATE DATABASE <em class="replaceable"><code>database-name</code></em>;</code></strong></pre><p>
          ... <em class="replaceable"><code>database-name</code></em> is the name you have chosen for the database.
        </p><p>
          3. Create the database tables:
          </p><pre class="screen">mysql&gt; <strong class="userinput"><code>CONNECT <em class="replaceable"><code>database-name</code></em>;</code></strong>
mysql&gt; <strong class="userinput"><code>SOURCE <em class="replaceable"><code>path-to-bind10</code></em>/share/bind10/dhcpdb_create.mysql</code></strong></pre><p>
        </p><p>
          4. Create the user under which BIND 10 will access the database (and give it a password), then grant it access to the database tables:
          </p><pre class="screen">mysql&gt; <strong class="userinput"><code>CREATE USER '<em class="replaceable"><code>user-name</code></em>'@'localhost' IDENTIFIED BY '<em class="replaceable"><code>password</code></em>';</code></strong>
mysql&gt; <strong class="userinput"><code>GRANT ALL ON <em class="replaceable"><code>database-name</code></em>.* TO '<em class="replaceable"><code>user-name</code></em>'@'localhost';</code></strong></pre><p>
        </p><p>
          5. Exit MySQL:
          </p><pre class="screen">mysql&gt; <strong class="userinput"><code>quit</code></strong>
Bye<strong class="userinput"><code></code></strong>
$</pre><p>
       </p></div></div></div><div class="chapter" title="Chapter 17. The DHCPv4 Server"><div class="titlepage"><div><div><h2 class="title"><a name="dhcp4"></a>Chapter 17. The DHCPv4 Server</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#dhcp4-start-stop">17.1. Starting and Stopping the DHCPv4 Server</a></span></dt><dt><span class="section"><a href="#dhcp4-configuration">17.2. Configuring the DHCPv4 Server</a></span></dt><dd><dl><dt><span class="section"><a href="#idm66502448">17.2.1. Database Configuration</a></span></dt><dt><span class="section"><a href="#dhcp4-address-config">17.2.2. Configuration of Address Pools</a></span></dt><dt><span class="section"><a href="#dhcp4-std-options">17.2.3. Standard DHCPv4 options</a></span></dt><dt><span class="section"><a href="#dhcp4-custom-options">17.2.4. Custom DHCPv4 options</a></span></dt><dt><span class="section"><a href="#dhcp4-vendor-opts">17.2.5. DHCPv4 vendor specific options</a></span></dt><dt><span class="section"><a href="#dhcp4-option-spaces">17.2.6. Nested DHCPv4 options (custom option spaces)</a></span></dt></dl></dd><dt><span class="section"><a href="#dhcp4-serverid">17.3. Server Identifier in DHCPv4</a></span></dt><dt><span class="section"><a href="#dhcp4-std">17.4. Supported Standards</a></span></dt><dt><span class="section"><a href="#dhcp4-limit">17.5. DHCPv4 Server Limitations</a></span></dt></dl></div><div class="section" title="17.1. Starting and Stopping the DHCPv4 Server"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp4-start-stop"></a>17.1. Starting and Stopping the DHCPv4 Server</h2></div></div></div><p>
        <span class="command"><strong>b10-dhcp4</strong></span> is the BIND 10 DHCPv4 server and, like other
        parts of BIND 10, is configured through the <span class="command"><strong>bindctl</strong></span>
        program.
      </p><p>
        After starting BIND 10 and entering bindctl, the first step
        in configuring the server is to add it to the list of running BIND 10 services.
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Init/components b10-dhcp4</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-dhcp4/kind dispensable</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
      </p><p>
         To remove <span class="command"><strong>b10-dhcp4</strong></span> from the set of running services,
         the <span class="command"><strong>b10-dhcp4</strong></span> is removed from list of Init components:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config remove Init/components b10-dhcp4</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
      </p><p>
        On start-up, the server will detect available network interfaces
        and will attempt to open UDP sockets on all interfaces that
        are up, running, are not loopback, and have IPv4 address
        assigned.

        The server will then listen to incoming traffic. Currently
        supported client messages are DISCOVER and REQUEST. The server
        will respond to them with OFFER and ACK, respectively.

        Since the DHCPv4 server opens privileged ports, it requires root
        access. Make sure you run this daemon as root.
      </p></div><div class="section" title="17.2. Configuring the DHCPv4 Server"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp4-configuration"></a>17.2. Configuring the DHCPv4 Server</h2></div></div></div><p>
        Once the server is started, it can be configured. To view the
        current configuration, use the following command in <span class="command"><strong>bindctl</strong></span>:
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config show Dhcp4</code></strong></pre><p>
        When starting the DHCPv4 daemon for the first time, the default configuration
        will be available. It will look similar to this:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config show Dhcp4</code></strong>
Dhcp4/interface/	list	(default)
Dhcp4/renew-timer	1000	integer	(default)
Dhcp4/rebind-timer	2000	integer	(default)
Dhcp4/valid-lifetime	4000	integer	(default)
Dhcp4/option-data	[]	list	(default)
Dhcp4/lease-database/type	"memfile"	string	(default)
Dhcp4/lease-database/name	""	string	(default)
Dhcp4/lease-database/user	""	string	(default)
Dhcp4/lease-database/host	""	string	(default)
Dhcp4/lease-database/password	""	string	(default)
Dhcp4/subnet4	[]	list	(default)
</pre><p>
      </p><p>
        To change one of the parameters, simply follow
        the usual <span class="command"><strong>bindctl</strong></span> procedure. For example, to make the
        leases longer, change their valid-lifetime parameter:
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp4/valid-lifetime 7200</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        Please note that most Dhcp4 parameters are of global scope
        and apply to all defined subnets, unless they are overridden on a
        per-subnet basis.
      </p><div class="section" title="17.2.1. Database Configuration"><div class="titlepage"><div><div><h3 class="title"><a name="idm66502448"></a>17.2.1. Database Configuration</h3></div></div></div><p>
      All leases issued by the server are stored in the lease database.  Currently,
      the only supported database is MySQL
      <sup>[<a name="idm66501552" href="#ftn.idm66501552" class="footnote">1</a>]</sup>, and so the server must be configured to
      access the correct database with the appropriate credentials.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Database access information must be configured for the DHCPv4 server, even if
            it has already been configured for the DHCPv6 server.  The servers store their
            information independently, so each server can use a separate
            database or both servers can use the same database.
            </p></div><p>
      Database configuration is controlled through the Dhcp4/lease-database parameters.
      The type of the database must be set to MySQL (although the string entered is "mysql"):
</p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp4/lease-database/type "mysql"</code></strong>
</pre><p>
      Next, the name of the database is to hold the leases must be set: this is the
      name used when the lease database was created (see <a class="xref" href="#dhcp-database-create" title="16.1.3. Create MySQL Database and BIND 10 User">Section 16.1.3, &#8220;Create MySQL Database and BIND 10 User&#8221;</a>).
</p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp4/lease-database/name "<em class="replaceable"><code>database-name</code></em>"</code></strong>
</pre><p>
      If the database is located on a different system to the DHCPv4 server, the
      database host name must also be specified (although note that this configuration
      may have a severe impact on server performance):
</p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp4/lease-database/host "<em class="replaceable"><code>remote-host-name</code></em>"</code></strong>
</pre><p>
      The usual state of affairs will be to have the database on the same machine as the
      DHCPv4 server.  In this case, set the value to the empty string (this is the default):
</p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp4/lease-database/host ""</code></strong>
</pre><p>
      </p><p>
      Finally, the credentials of the account under which the server will access the database
      should be set:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp4/lease-database/user "<em class="replaceable"><code>user-name</code></em>"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/lease-database/password "<em class="replaceable"><code>password</code></em>"</code></strong>
</pre><p>
      If there is no password to the account, set the password to the empty string "". (This is also the default.)
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The password is echoed when entered and is stored in clear text in the BIND 10 configuration
      database.  Improved password security will be added in a future version of BIND 10 DHCP</p></div></div><div class="section" title="17.2.2. Configuration of Address Pools"><div class="titlepage"><div><div><h3 class="title"><a name="dhcp4-address-config"></a>17.2.2. Configuration of Address Pools</h3></div></div></div><p>
        The essential role of DHCPv4 server is address assignment. The server
        has to be configured with at least one subnet and one pool of dynamic
        addresses to be managed. For example, assume that the server
        is connected to a network segment that uses the 192.0.2.0/24
        prefix. The Administrator of that network has decided that addresses from range
        192.0.2.10 to 192.0.2.20 are going to be managed by the Dhcp4
        server. Such a configuration can be achieved in the following way:
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/subnet4</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/subnet4[0]/subnet "192.0.2.0/24"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/subnet4[0]/pool [ "192.0.2.10 - 192.0.2.20" ]</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        Note that subnet is defined as a simple string, but the pool parameter
        is actually a list of pools: for this reason, the pool definition is
        enclosed in square brackets, even though only one range of addresses
        is specified.</p><p>It is possible to define more than one pool in a
        subnet: continuing the previous example, further assume that
        192.0.2.64/26 should be also be managed by the server. It could be written as
        192.0.2.64 to 192.0.2.127. Alternatively, it can be expressed more simply as
        192.0.2.64/26. Both formats are supported by Dhcp4 and can be mixed in the pool list.
        For example, one could define the following pools:
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp4/subnet4[0]/pool [ "192.0.2.10-192.0.2.20", "192.0.2.64/26" ]</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        The number of pools is not limited, but for performance reasons it is recommended to
        use as few as possible. Space and tabulations in pool definitions are ignored, so
        spaces before and after hyphen are optional. They can be used to improve readability.
      </p><p>
         The server may be configured to serve more than one subnet. To add a second subnet,
         use a command similar to the following:
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/subnet4</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/subnet4[1]/subnet "192.0.3.0/24"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/subnet4[1]/pool [ "192.0.3.0/24" ]</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        Arrays are counted from 0. subnet[0] refers to the subnet defined in the
        previous example.  The <span class="command"><strong>config add Dhcp4/subnet4</strong></span> command adds
        another (second) subnet. It can be referred to as
        <span class="command"><strong>Dhcp4/subnet4[1]</strong></span>. In this example, we allow server to
        dynamically assign all addresses available in the whole subnet.
      </p><p>
        When configuring a DHCPv4 server using prefix/length notation, please pay
        attention to the boundary values. When specifying that the server should use
        a given pool, it will be able to allocate also first (typically network
        address) and the last (typically broadcast address) address from that pool.
        In the aforementioned example of pool 192.0.3.0/24, both 192.0.3.0 and
        192.0.3.255 addresses may be assigned as well. This may be invalid in some
        network configurations. If you want to avoid this, please use the "min-max" notation.
      </p></div><div class="section" title="17.2.3. Standard DHCPv4 options"><div class="titlepage"><div><div><h3 class="title"><a name="dhcp4-std-options"></a>17.2.3. Standard DHCPv4 options</h3></div></div></div><p>
        One of the major features of DHCPv4 server is to provide configuration
        options to clients. Although there are several options that require
        special behavior, most options are sent by the server only if the client
        explicitly requested them.  The following example shows how to
        configure DNS servers, which is one of the most frequently used
        options. Options specified in this way are considered global and apply
        to all configured subnets.

        </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/name "domain-name-servers"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/code 6</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/space "dhcp4"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/data "192.0.3.1, 192.0.3.2"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
      </p><p>
      The first line creates new entry in option-data table. It
      contains information on all global options that the server is
      supposed to configure in all subnets. The second line specifies
      option name. For a complete list of currently supported names,
      see <a class="xref" href="#dhcp4-std-options-list" title="Table 17.1. List of standard DHCPv4 options">Table 17.1, &#8220;List of standard DHCPv4 options&#8221;</a> below.
      The third line specifies option code, which must match one of the
      values from that list. Line 4 specifies option space, which must always
      be set to "dhcp4" as these are standard DHCPv4 options. For
      other option spaces, including custom option spaces, see <a class="xref" href="#dhcp4-option-spaces" title="17.2.6. Nested DHCPv4 options (custom option spaces)">Section 17.2.6, &#8220;Nested DHCPv4 options (custom option spaces)&#8221;</a>. The fifth line specifies the format in
      which the data will be entered: use of CSV (comma
      separated values) is recommended. The sixth line gives the actual value to
      be sent to clients. Data is specified as a normal text, with
      values separated by commas if more than one value is
      allowed.
    </p><p>
      Options can also be configured as hexadecimal values. If csv-format is
      set to false, option data must be specified as a hex string. The
      following commands configure the domain-name-servers option for all
      subnets with the following addresses: 192.0.3.1 and 192.0.3.2.
      Note that csv-format is set to false.
      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/name "domain-name-servers"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/code 6</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/space "dhcp4"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/csv-format false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/data "C0 00 03 01 C0 00 03 02"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
        </pre><p>
      </p><p>
        It is possible to override options on a per-subnet basis.  If
        clients connected to most of your subnets are expected to get the
        same values of a given option, you should use global options: you
        can then override specific values for a small number of subnets.
        On the other hand, if you use different values in each subnet,
        it does not make sense to specify global option values
        (Dhcp4/option-data), rather you should set only subnet-specific values
        (Dhcp4/subnet[X]/option-data[Y]).
      </p><p>
        The following commands override the global
        DNS servers option for a particular subnet, setting a single DNS
        server with address 2001:db8:1::3.
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/subnet4[0]/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/subnet4[0]/option-data[0]/name "domain-name-servers"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/subnet4[0]/option-data[0]/code 6</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/subnet4[0]/option-data[0]/space "dhcp4"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/subnet4[0]/option-data[0]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/subnet4[0]/option-data[0]/data "192.0.2.3"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>In a future version of Kea, it will not be necessary to specify
        the option code, space and csv-format fields as they will be set
        automatically.</p></div><p>
        Below is a list of currently supported standard DHCPv4 options. The "Name" and "Code"
        are the values that should be used as a name in the option-data
        structures. "Type" designates the format of the data: the meanings of
        the various types is given in <a class="xref" href="#dhcp-types" title="Table 17.2. List of standard DHCP option types">Table 17.2, &#8220;List of standard DHCP option types&#8221;</a>.
      </p><p>
        Some options are designated as arrays, which means that more than one
        value is allowed in such an option. For example the option time-servers
        allows the specification of more than one IPv4 address, so allowing
        clients to obtain the the addresses of multiple NTP servers.
      </p><p>
        </p><table border="1" cellpadding="5%" id="dhcp4-std-options-list"><caption>Table 17.1. List of standard DHCPv4 options</caption><thead><tr><th>Name</th><th>Code</th><th>Type</th><th>Array?</th></tr></thead><tbody><tr><td>subnet-mask</td><td>1</td><td>ipv4-address</td><td>false</td></tr><tr><td>time-offset</td><td>2</td><td>uint32</td><td>false</td></tr><tr><td>routers</td><td>3</td><td>ipv4-address</td><td>true</td></tr><tr><td>time-servers</td><td>4</td><td>ipv4-address</td><td>true</td></tr><tr><td>name-servers</td><td>5</td><td>ipv4-address</td><td>false</td></tr><tr><td>domain-name-servers</td><td>6</td><td>ipv4-address</td><td>true</td></tr><tr><td>log-servers</td><td>7</td><td>ipv4-address</td><td>true</td></tr><tr><td>cookie-servers</td><td>8</td><td>ipv4-address</td><td>true</td></tr><tr><td>lpr-servers</td><td>9</td><td>ipv4-address</td><td>true</td></tr><tr><td>impress-servers</td><td>10</td><td>ipv4-address</td><td>true</td></tr><tr><td>resource-location-servers</td><td>11</td><td>ipv4-address</td><td>true</td></tr><tr><td>host-name</td><td>12</td><td>string</td><td>false</td></tr><tr><td>boot-size</td><td>13</td><td>uint16</td><td>false</td></tr><tr><td>merit-dump</td><td>14</td><td>string</td><td>false</td></tr><tr><td>domain-name</td><td>15</td><td>fqdn</td><td>false</td></tr><tr><td>swap-server</td><td>16</td><td>ipv4-address</td><td>false</td></tr><tr><td>root-path</td><td>17</td><td>string</td><td>false</td></tr><tr><td>extensions-path</td><td>18</td><td>string</td><td>false</td></tr><tr><td>ip-forwarding</td><td>19</td><td>boolean</td><td>false</td></tr><tr><td>non-local-source-routing</td><td>20</td><td>boolean</td><td>false</td></tr><tr><td>policy-filter</td><td>21</td><td>ipv4-address</td><td>true</td></tr><tr><td>max-dgram-reassembly</td><td>22</td><td>uint16</td><td>false</td></tr><tr><td>default-ip-ttl</td><td>23</td><td>uint8</td><td>false</td></tr><tr><td>path-mtu-aging-timeout</td><td>24</td><td>uint32</td><td>false</td></tr><tr><td>path-mtu-plateau-table</td><td>25</td><td>uint16</td><td>true</td></tr><tr><td>interface-mtu</td><td>26</td><td>uint16</td><td>false</td></tr><tr><td>all-subnets-local</td><td>27</td><td>boolean</td><td>false</td></tr><tr><td>broadcast-address</td><td>28</td><td>ipv4-address</td><td>false</td></tr><tr><td>perform-mask-discovery</td><td>29</td><td>boolean</td><td>false</td></tr><tr><td>mask-supplier</td><td>30</td><td>boolean</td><td>false</td></tr><tr><td>router-discovery</td><td>31</td><td>boolean</td><td>false</td></tr><tr><td>router-solicitation-address</td><td>32</td><td>ipv4-address</td><td>false</td></tr><tr><td>static-routes</td><td>33</td><td>ipv4-address</td><td>true</td></tr><tr><td>trailer-encapsulation</td><td>34</td><td>boolean</td><td>false</td></tr><tr><td>arp-cache-timeout</td><td>35</td><td>uint32</td><td>false</td></tr><tr><td>ieee802-3-encapsulation</td><td>36</td><td>boolean</td><td>false</td></tr><tr><td>default-tcp-ttl</td><td>37</td><td>uint8</td><td>false</td></tr><tr><td>tcp-keepalive-internal</td><td>38</td><td>uint32</td><td>false</td></tr><tr><td>tcp-keepalive-garbage</td><td>39</td><td>boolean</td><td>false</td></tr><tr><td>nis-domain</td><td>40</td><td>string</td><td>false</td></tr><tr><td>nis-servers</td><td>41</td><td>ipv4-address</td><td>true</td></tr><tr><td>ntp-servers</td><td>42</td><td>ipv4-address</td><td>true</td></tr><tr><td>vendor-encapsulated-options</td><td>43</td><td>empty</td><td>false</td></tr><tr><td>netbios-name-servers</td><td>44</td><td>ipv4-address</td><td>true</td></tr><tr><td>netbios-dd-server</td><td>45</td><td>ipv4-address</td><td>true</td></tr><tr><td>netbios-node-type</td><td>46</td><td>uint8</td><td>false</td></tr><tr><td>netbios-scope</td><td>47</td><td>string</td><td>false</td></tr><tr><td>font-servers</td><td>48</td><td>ipv4-address</td><td>true</td></tr><tr><td>x-display-manager</td><td>49</td><td>ipv4-address</td><td>true</td></tr><tr><td>dhcp-requested-address</td><td>50</td><td>ipv4-address</td><td>false</td></tr><tr><td>dhcp-option-overload</td><td>52</td><td>uint8</td><td>false</td></tr><tr><td>dhcp-message</td><td>56</td><td>string</td><td>false</td></tr><tr><td>dhcp-max-message-size</td><td>57</td><td>uint16</td><td>false</td></tr><tr><td>vendor-class-identifier</td><td>60</td><td>binary</td><td>false</td></tr><tr><td>nwip-domain-name</td><td>62</td><td>string</td><td>false</td></tr><tr><td>nwip-suboptions</td><td>63</td><td>binary</td><td>false</td></tr><tr><td>user-class</td><td>77</td><td>binary</td><td>false</td></tr><tr><td>fqdn</td><td>81</td><td>record</td><td>false</td></tr><tr><td>dhcp-agent-options</td><td>82</td><td>empty</td><td>false</td></tr><tr><td>authenticate</td><td>90</td><td>binary</td><td>false</td></tr><tr><td>client-last-transaction-time</td><td>91</td><td>uint32</td><td>false</td></tr><tr><td>associated-ip</td><td>92</td><td>ipv4-address</td><td>true</td></tr><tr><td>subnet-selection</td><td>118</td><td>ipv4-address</td><td>false</td></tr><tr><td>domain-search</td><td>119</td><td>binary</td><td>false</td></tr><tr><td>vivco-suboptions</td><td>124</td><td>binary</td><td>false</td></tr><tr><td>vivso-suboptions</td><td>125</td><td>binary</td><td>false</td></tr></tbody></table><p>
      </p><p>
        </p><table border="1" cellpadding="5%" id="dhcp-types"><caption>Table 17.2. List of standard DHCP option types</caption><thead><tr><th>Name</th><th>Meaning</th></tr></thead><tbody><tr><td>binary</td><td>An arbitrary string of bytes, specified as a set of hexadecimal digits.</td></tr><tr><td>boolean</td><td>Boolean value with allowed values true or false</td></tr><tr><td>empty</td><td>No value, data is carried in suboptions</td></tr><tr><td>fqdn</td><td>Fully qualified domain name (e.g. www.example.com)</td></tr><tr><td>ipv4-address</td><td>IPv4 address in the usual dotted-decimal notation (e.g. 192.0.2.1)</td></tr><tr><td>ipv6-address</td><td>IPv6 address in the usual colon notation (e.g. 2001:db8::1)</td></tr><tr><td>record</td><td>Structured data that may comprise any types (except "record" and "empty")</td></tr><tr><td>string</td><td>Any text</td></tr><tr><td>uint8</td><td>8 bit unsigned integer with allowed values 0 to 255</td></tr><tr><td>uint16</td><td>16 bit unsinged integer with allowed values 0 to 65535</td></tr><tr><td>uint32</td><td>32 bit unsigned integer with allowed values 0 to 4294967295</td></tr></tbody></table><p>
      </p></div><div class="section" title="17.2.4. Custom DHCPv4 options"><div class="titlepage"><div><div><h3 class="title"><a name="dhcp4-custom-options"></a>17.2.4. Custom DHCPv4 options</h3></div></div></div><p>It is also possible to define options other than the standard ones.
      Assume that we want to define a new DHCPv4 option called "foo" which will have
      code 222 and will convey a single unsigned 32 bit integer value. We can define
      such an option by using the following commands:
      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/option-def</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/name "foo"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/code 222</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/type "uint32"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/array false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/record-types ""</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/space "dhcp4"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/encapsulate ""</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      The "false" value of the "array" parameter determines that the option
      does NOT comprise an array of "uint32" values but rather a single value.
      Two other parameters have been left blank: "record-types" and "encapsulate".
      The former specifies the comma separated list of option data fields if the
      option comprises a record of data fields. The "record-fields" value should
      be non-empty if the "type" is set to "record". Otherwise it must be left
      blank. The latter parameter specifies the name of the option space being
      encapsulated by the particular option. If the particular option does not
      encapsulate any option space it should be left blank.
      Note that the above set of comments define the format of the new option and do not
      set its values.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          In the current release the default values are not propagated to the
          parser when the new configuration is being set. Therefore, all
          parameters must be specified at all times, even if their values are
          left blank.
        </p></div><p>Once the new option format is defined, its value is set
      in the same way as for a standard option. For example the following
      commands set a global value that applies to all subnets.
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/name "foo"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/code 222</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/space "dhcp4"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/data "12345"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      </p><p>New options can take more complex forms than simple use of
      primitives (uint8, string, ipv4-address etc): it is possible to
      define an option comprising a number of existing primitives.
      </p><p>Assume we
      want to define a new option that will consist of an IPv4
      address, followed by unsigned 16 bit integer, followed by a text
      string. Such an option could be defined in the following way:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/option-def</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/name "bar"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/code 223</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/space "dhcp4"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/type "record"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/array false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/record-types "ipv4-address, uint16, string"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/encapsulate ""</code></strong>
</pre><p>
      The "type" is set to "record" to indicate that the option contains
      multiple values of different types.  These types are given as a comma-separated
      list in the "record-types" field and should be those listed in <a class="xref" href="#dhcp-types" title="Table 17.2. List of standard DHCP option types">Table 17.2, &#8220;List of standard DHCP option types&#8221;</a>.
      </p><p>
      The values of the option are set as follows:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/name "bar"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/space "dhcp4"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/code 223</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/data "192.0.2.100, 123, Hello World"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      </p>
      "csv-format" is set "true" to indicate that the "data" field comprises a command-separated
      list of values.  The values in the "data" must correspond to the types set in
      the "record-types" field of the option definition.
    </div><div class="section" title="17.2.5. DHCPv4 vendor specific options"><div class="titlepage"><div><div><h3 class="title"><a name="dhcp4-vendor-opts"></a>17.2.5. DHCPv4 vendor specific options</h3></div></div></div><p>
      Currently there are three option spaces defined: dhcp4 (to
      be used in DHCPv4 daemon) and dhcp6 (for the DHCPv6 daemon); there
      is also vendor-encapsulated-options-space, which is empty by default, but options
      can be defined in it. Those options are called vendor-specific
      information options. The following examples show how to define
      an option "foo" with code 1 that consists of an IPv4 address, an
      unsigned 16 bit integer and a string. The "foo" option is conveyed
      in a vendor specific information option.
      </p><p>
      The first step is to define the format of the option:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/option-def</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/name "foo"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/code 1</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/space "vendor-encapsulated-options-space"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/type "record"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/array false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/record-types "ipv4-address, uint16, string"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/encapsulates ""</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
     (Note that the option space is set to "vendor-encapsulated-options-space".)
     Once the option format is defined, the next step is to define actual values
     for that option:
     </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/name "foo"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/space "vendor-encapsulated-options-space"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/code 1</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/data "192.0.2.3, 123, Hello World"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
    We also set up a dummy value for vendor-opts, the option that conveys our sub-option "foo".
    This is required else the option will not be included in messages sent to the client.
     </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[1]/name "vendor-encapsulated-options"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[1]/space "dhcp4"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[1]/code 43</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[1]/csv-format false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[1]/data ""</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          With this version of BIND 10, the "vendor-encapsulated-options" option
          must be specified in the configuration although it has no configurable
          parameters. If it is not specified, the server will assume that it is
          not configured and will not send it to a client. In the future there
          will be no need to include this option in the configuration.
        </p></div></div><div class="section" title="17.2.6. Nested DHCPv4 options (custom option spaces)"><div class="titlepage"><div><div><h3 class="title"><a name="dhcp4-option-spaces"></a>17.2.6. Nested DHCPv4 options (custom option spaces)</h3></div></div></div><p>It is sometimes useful to define completely new option
      space. This is the case when user creates new option in the
      standard option space ("dhcp4 or "dhcp6") and wants this option
      to convey sub-options. Thanks to being in the separate space,
      sub-option codes will have a separate numbering scheme and may
      overlap with codes of standard options.
      </p><p>Note that creation of a new option space when defining
      sub-options for a standard option is not required, because it is
      created by default if the standard option is meant to convey any
      sub-options (see <a class="xref" href="#dhcp4-vendor-opts" title="17.2.5. DHCPv4 vendor specific options">Section 17.2.5, &#8220;DHCPv4 vendor specific options&#8221;</a>).
      </p><p>
      Assume that we want to have a DHCPv4 option called "container" with
      code 222 that conveys two sub-options with codes 1 and 2.
      First we need to define the new sub-options:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/option-def</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/name "subopt1"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/code 1</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/space "isc"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/type "ipv4-address"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/record-types ""</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/array false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[0]/encapsulate ""</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>

&gt; <strong class="userinput"><code>config add Dhcp4/option-def</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[1]/name "subopt2"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[1]/code 2</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[1]/space "isc"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[1]/type "string"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[1]/record-types ""</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[1]/array false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-def[1]/encapsulate ""</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
    Note that we have defined the options to belong to a new option space
    (in this case, "isc").
    </p><p>
    The next step is to define a regular DHCPv4 option with our desired
    code and specify that it should include options from the new option space:
</p><pre class="screen">
&gt; <strong class="userinput"><code>add Dhcp4/option-def</code></strong>
&gt; <strong class="userinput"><code>set Dhcp4/option-def[2]/name "container"</code></strong>
&gt; <strong class="userinput"><code>set Dhcp4/option-def[2]/code 222</code></strong>
&gt; <strong class="userinput"><code>set Dhcp4/option-def[2]/space "dhcp4"</code></strong>
&gt; <strong class="userinput"><code>set Dhcp4/option-def[2]/type "empty"</code></strong>
&gt; <strong class="userinput"><code>set Dhcp4/option-def[2]/array false</code></strong>
&gt; <strong class="userinput"><code>set Dhcp4/option-def[2]/record-types ""</code></strong>
&gt; <strong class="userinput"><code>set Dhcp4/option-def[2]/encapsulate "isc"</code></strong>
&gt; <strong class="userinput"><code>commit</code></strong>
</pre><p>
    The name of the option space in which the sub-options are defined
    is set in the "encapsulate" field. The "type" field is set to "empty"
    to indicate that this option does not carry any data other than
    sub-options.
    </p><p>
    Finally, we can set values for the new options:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp4/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/name "subopt1"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/space "isc"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/code 1</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[0]/data "192.0.2.3"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
<strong class="userinput"><code></code></strong>
&gt; <strong class="userinput"><code>config add Dhcp4/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[1]/name "subopt2"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[1]/space "isc"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[1]/code 2</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[1]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[1]/data "Hello world"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
<strong class="userinput"><code></code></strong>
&gt; <strong class="userinput"><code>config add Dhcp4/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[2]/name "container"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[2]/space "dhcp4"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[2]/code 222</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[2]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp4/option-data[2]/data ""</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
    Even though the "container" option does not carry any data except
    sub-options, the "data" field must be explicitly set to an empty value.
    This is required because in the current version of BIND 10 DHCP, the
    default configuration values are not propagated to the configuration parsers:
    if the "data" is not set the parser will assume that this
    parameter is not specified and an error will be reported.
    </p><p>Note that it is possible to create an option which carries some data
    in addition to the sub-options defined in the encapsulated option space.  For example,
    if the "container" option from the previous example was required to carry an uint16
    value as well as the sub-options, the "type" value would have to be set to "uint16" in
    the option definition. (Such an option would then have the following
    data structure: DHCP header, uint16 value, sub-options.) The value specified
    with the "data" parameter - which should be a valid integer enclosed in quotes,
    e.g. "123" - would then be assigned to the uint16 field in the "container" option.
    </p></div></div><div class="section" title="17.3. Server Identifier in DHCPv4"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp4-serverid"></a>17.3. Server Identifier in DHCPv4</h2></div></div></div><p>
        The DHCPv4 protocol uses a "server identifier" for clients to be able
        to discriminate between several servers present on the same link: this
        value is an IPv4 address of the server. When started for the first time,
        the DHCPv4 server will choose one of its IPv4 addresses as its server-id,
        and store the chosen value to a file. That file will be read by the server
        and the contained value used whenever the server is subsequently started.
      </p><p>
        It is unlikely that this parameter should ever need to be changed.
        However, if such a need arises, stop the server, edit the file and restart
        the server. (The file is named b10-dhcp4-serverid and by default is
        stored in the "var" subdirectory of the directory in which BIND 10 is installed.
        This can be changed when BIND 10 is built by using "--localstatedir"
        on the "configure" command line.)  The file is a text file that should
        contain an IPv4 address. Spaces are ignored, and no extra characters are allowed
        in this file.
      </p></div><div class="section" title="17.4. Supported Standards"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp4-std"></a>17.4. Supported Standards</h2></div></div></div><p>The following standards and draft standards are currently
      supported:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><a class="ulink" href="http://tools.ietf.org/html/rfc2131" target="_top">RFC 2131</a>: Supported messages are DISCOVER, OFFER,
            REQUEST, RELEASE, ACK, and NAK.</li><li class="listitem"><a class="ulink" href="http://tools.ietf.org/html/rfc2132" target="_top">RFC 2132</a>: Supported options are: PAD (0),
            END(255), Message Type(53), DHCP Server Identifier (54),
            Domain Name (15), DNS Servers (6), IP Address Lease Time
            (51), Subnet mask (1), and Routers (3).</li></ul></div></div><div class="section" title="17.5. DHCPv4 Server Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp4-limit"></a>17.5. DHCPv4 Server Limitations</h2></div></div></div><p>These are the current limitations of the DHCPv4 server
      software. Most of them are reflections of the current stage of
      development and should be treated as <span class="quote">&#8220;<span class="quote">not implemented
      yet</span>&#8221;</span>, rather than actual limitations.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
            On startup, the DHCPv4 server does not get the full configuration from
            BIND 10.  To remedy this, after starting BIND 10, modify any parameter
            and commit the changes, e.g.
            </p><pre class="screen">
&gt; <strong class="userinput"><code>config show Dhcp4/renew-timer</code></strong>
Dhcp4/renew-timer	1000	integer	(default)
&gt; <strong class="userinput"><code>config set Dhcp4/renew-timer 1001</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
          </p></li><li class="listitem">During the initial IPv4 node configuration, the
            server is expected to send packets to a node that does not
            have IPv4 address assigned yet. The server requires
            certain tricks (or hacks) to transmit such packets. This
            is not implemented yet, therefore DHCPv4 server supports
            relayed traffic only (that is, normal point to point
            communication).</li><li class="listitem">Upon start, the server will open sockets on all
            interfaces that are not loopback, are up and running and
            have IPv4 address.</li><li class="listitem">The DHCPv4 server does not support
            BOOTP. That is a design choice and the limitation is
            permanent. If you have legacy nodes that can't use DHCP and
            require BOOTP support, please use the latest version of ISC DHCP,
            available from <a class="ulink" href="http://www.isc.org/software/dhcp" target="_top">http://www.isc.org/software/dhcp</a>.</li><li class="listitem">Interface detection is currently working on Linux
            only. See <a class="xref" href="#iface-detect" title="19.1. Interface detection">Section 19.1, &#8220;Interface detection&#8221;</a> for details.</li><li class="listitem">The DHCPv4 server does not  verify that
            assigned address is unused. According to <a class="ulink" href="http://tools.ietf.org/html/rfc2131" target="_top">RFC 2131</a>, the
            allocating server should verify that address is not used by
            sending ICMP echo request.</li><li class="listitem">Address rebinding (REBIND) and duplication report (DECLINE)
            are not supported yet.</li><li class="listitem">DNS Update is not yet supported.</li></ul></div></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.idm66501552" href="#idm66501552" class="para">1</a>] </sup>
      The server comes with an in-memory database ("memfile") configured as the default
      database. This is used for internal testing and is not supported.  In addition,
      it does not store lease information on disk: lease information will be lost if the
      server is restarted.
      </p></div></div></div><div class="chapter" title="Chapter 18. The DHCPv6 Server"><div class="titlepage"><div><div><h2 class="title"><a name="dhcp6"></a>Chapter 18. The DHCPv6 Server</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#dhcp6-start-stop">18.1. Starting and Stopping the DHCPv6 Server</a></span></dt><dt><span class="section"><a href="#dhcp6-configuration">18.2. DHCPv6 Server Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#idm64310576">18.2.1. Database Configuration</a></span></dt><dt><span class="section"><a href="#idm63165104">18.2.2. Subnet and Address Pool</a></span></dt><dt><span class="section"><a href="#dhcp6-std-options">18.2.3. Standard DHCPv6 options</a></span></dt><dt><span class="section"><a href="#dhcp6-custom-options">18.2.4. Custom DHCPv6 options</a></span></dt><dt><span class="section"><a href="#dhcp6-vendor-opts">18.2.5. DHCPv6 vendor specific options</a></span></dt><dt><span class="section"><a href="#dhcp6-option-spaces">18.2.6. Nested DHCPv6 options (custom option spaces)</a></span></dt><dt><span class="section"><a href="#dhcp6-config-subnets">18.2.7. Subnet Selection</a></span></dt></dl></dd><dt><span class="section"><a href="#dhcp6-serverid">18.3. Server Identifier in DHCPv6</a></span></dt><dt><span class="section"><a href="#dhcp6-std">18.4. Supported Standards</a></span></dt><dt><span class="section"><a href="#dhcp6-limit">18.5. DHCPv6 Server Limitations</a></span></dt></dl></div><div class="section" title="18.1. Starting and Stopping the DHCPv6 Server"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp6-start-stop"></a>18.1. Starting and Stopping the DHCPv6 Server</h2></div></div></div><p>
        <span class="command"><strong>b10-dhcp6</strong></span> is the BIND 10 DHCPv6 server and, like other
        parts of BIND 10, is configured through the <span class="command"><strong>bindctl</strong></span>
        program.
      </p><p>
        After starting BIND 10 and starting <span class="command"><strong>bindctl</strong></span>, the first step
        in configuring the server is to add <span class="command"><strong>b10-dhcp6</strong></span> to the list of running BIND 10 services.
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Init/components b10-dhcp6</code></strong>
&gt; <strong class="userinput"><code>config set Init/components/b10-dhcp6/kind dispensable</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
      </p><p>
         To remove <span class="command"><strong>b10-dhcp6</strong></span> from the set of running services,
         the <span class="command"><strong>b10-dhcp4</strong></span> is removed from list of Init components:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config remove Init/components b10-dhcp6</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
      </p><p>
        During start-up the server will detect available network interfaces
        and will attempt to open UDP sockets on all interfaces that
        are up, running, are not loopback, are multicast-capable, and
        have IPv6 address assigned. It will then listen to incoming traffic.
      </p></div><div class="section" title="18.2. DHCPv6 Server Configuration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp6-configuration"></a>18.2. DHCPv6 Server Configuration</h2></div></div></div><p>
        Once the server has been started, it can be configured. To view the
        current configuration, use the following command in <span class="command"><strong>bindctl</strong></span>:
        </p><pre class="screen">&gt; <strong class="userinput"><code>config show Dhcp6</code></strong></pre><p>
        When starting the Dhcp6 daemon for the first time, the default configuration
        will be available. It will look similar to this:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config show Dhcp6</code></strong>
Dhcp6/interface/	list	(default)
Dhcp6/renew-timer	1000	integer	(default)
Dhcp6/rebind-timer	2000	integer	(default)
Dhcp6/preferred-lifetime	3000	integer	(default)
Dhcp6/valid-lifetime	4000	integer	(default)
Dhcp6/option-data	[]	list	(default)
Dhcp6/lease-database/type	"memfile"	string	(default)
Dhcp6/lease-database/name	""	string	(default)
Dhcp6/lease-database/user	""	string	(default)
Dhcp6/lease-database/host	""	string	(default)
Dhcp6/lease-database/password	""	string	(default)
Dhcp6/subnet6/	list
</pre><p>
      </p><p>
        To change one of the parameters, simply follow
        the usual <span class="command"><strong>bindctl</strong></span> procedure. For example, to make the
        leases longer, change their valid-lifetime parameter:
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp6/valid-lifetime 7200</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        Most Dhcp6 parameters are of global scope
        and apply to all defined subnets, unless they are overridden on a
        per-subnet basis.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          With this version of BIND 10, there are a number of known limitations
          and problems in the DHCPv6 server. See <a class="xref" href="#dhcp6-limit" title="18.5. DHCPv6 Server Limitations">Section 18.5, &#8220;DHCPv6 Server Limitations&#8221;</a>.
        </p></div><div class="section" title="18.2.1. Database Configuration"><div class="titlepage"><div><div><h3 class="title"><a name="idm64310576"></a>18.2.1. Database Configuration</h3></div></div></div><p>
      All leases issued by the server are stored in the lease database.  Currently,
      the only supported database is MySQL
      <sup>[<a name="idm64309680" href="#ftn.idm64309680" class="footnote">2</a>]</sup>, and so the server must be configured to
      access the correct database with the appropriate credentials.
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Database access information must be configured for the DHCPv6 server, even if
            it has already been configured for the DHCPv4 server.  The servers store their
            information independently, so each server can use a separate
            database or both servers can use the same database.
          </p></div><p>
      Database configuration is controlled through the Dhcp6/lease-database parameters.
      The type of the database must be set to MySQL (although the string entered is "mysql"):
</p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp6/lease-database/type "mysql"</code></strong>
</pre><p>
      Next, the name of the database is to hold the leases must be set: this is the
      name used when the lease database was created (see <a class="xref" href="#dhcp-database-create" title="16.1.3. Create MySQL Database and BIND 10 User">Section 16.1.3, &#8220;Create MySQL Database and BIND 10 User&#8221;</a>).
</p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp6/lease-database/name "<em class="replaceable"><code>database-name</code></em>"</code></strong>
</pre><p>
      If the database is located on a different system to the DHCPv6 server, the
      database host name must also be specified (although note that this configuration
      may have a severe impact on server performance):
</p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp6/lease-database/host "<em class="replaceable"><code>remote-host-name</code></em>"</code></strong>
</pre><p>
      The usual state of affairs will be to have the database on the same machine as the
      DHCPv6 server.  In this case, set the value to the empty string (this is the default):
</p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp6/lease-database/host ""</code></strong>
</pre><p>
      </p><p>
      Finally, the credentials of the account under which the server will access the database
      should be set:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp6/lease-database/user "<em class="replaceable"><code>user-name</code></em>"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/lease-database/password "<em class="replaceable"><code>password</code></em>"</code></strong>
</pre><p>
      If there is no password to the account, set the password to the empty string "". (This is also the default.)
      </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The password is echoed when entered and is stored in clear text in the BIND 10 configuration
      database.  Improved password security will be added in a future version of BIND 10 DHCP</p></div></div><div class="section" title="18.2.2. Subnet and Address Pool"><div class="titlepage"><div><div><h3 class="title"><a name="idm63165104"></a>18.2.2. Subnet and Address Pool</h3></div></div></div><p>
        The essential role of a DHCPv6 server is address assignment. For this,
        the server has to be configured with at least one subnet and one pool of dynamic
        addresses to be managed. For example, assume that the server
        is connected to a network segment that uses the 2001:db8:1::/64
        prefix. The Administrator of that network has decided that addresses from range
        2001:db8:1::1 to 2001:db8:1::ffff are going to be managed by the Dhcp6
        server. Such a configuration can be achieved in the following way:
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/subnet6</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[0]/subnet "2001:db8:1::/64"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[0]/pool [ "2001:db8:1::0 - 2001:db8:1::ffff" ]</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        Note that subnet is defined as a simple string, but the pool parameter
        is actually a list of pools: for this reason, the pool definition is
        enclosed in square brackets, even though only one range of addresses
        is specified.</p><p>It is possible to define more than one pool in a
        subnet: continuing the previous example, further assume that
        2001:db8:1:0:5::/80 should be also be managed by the server. It could be written as
        2001:db8:1:0:5:: to 2001:db8:1::5:ffff:ffff:ffff, but typing so many 'f's
        is cumbersome. It can be expressed more simply as 2001:db8:1:0:5::/80. Both
        formats are supported by Dhcp6 and can be mixed in the pool list.
        For example, one could define the following pools:
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[0]/pool [ "2001:db8:1::1 - 2001:db8:1::ffff", "2001:db8:1:0:5::/80" ]</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        The number of pools is not limited, but for performance reasons it is recommended to
        use as few as possible.
      </p><p>
         The server may be configured to serve more than one subnet. To add a second subnet,
         use a command similar to the following:
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/subnet6</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[1]/subnet "2001:db8:beef::/48"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[1]/pool [ "2001:db8:beef::/48" ]</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
        Arrays are counted from 0. subnet[0] refers to the subnet defined in the
        previous example.  The <span class="command"><strong>config add Dhcp6/subnet6</strong></span> command adds
        another (second) subnet. It can be referred to as
        <span class="command"><strong>Dhcp6/subnet6[1]</strong></span>. In this example, we allow server to
        dynamically assign all addresses available in the whole subnet. Although
        very wasteful, it is certainly a valid configuration to dedicate the
        whole /48 subnet for that purpose.
      </p><p>
        When configuring a DHCPv6 server using prefix/length notation, please pay
        attention to the boundary values. When specifying that the server should use
        a given pool, it will be able to allocate also first (typically network
        address) address from that pool. For example for pool 2001:db8::/64 the
        2001:db8:: address may be assigned as well. If you want to avoid this,
        please use the "min-max" notation.
      </p></div><div class="section" title="18.2.3. Standard DHCPv6 options"><div class="titlepage"><div><div><h3 class="title"><a name="dhcp6-std-options"></a>18.2.3. Standard DHCPv6 options</h3></div></div></div><p>
        One of the major features of DHCPv6 server is to provide configuration
        options to clients. Although there are several options that require
        special behavior, most options are sent by the server only if the client
        explicitly requested them.  The following example shows how to
        configure DNS servers, which is one of the most frequently used
        options. Numbers in the first column are added for easier reference and
        will not appear on screen. Options specified in this way are considered
        global and apply to all configured subnets.

        </p><pre class="screen">
1. &gt; <strong class="userinput"><code>config add Dhcp6/option-data</code></strong>
2. &gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/name "dns-servers"</code></strong>
3. &gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/code 23</code></strong>
4. &gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/space "dhcp6"</code></strong>
5. &gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/csv-format true</code></strong>
6. &gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/data "2001:db8::cafe, 2001:db8::babe"</code></strong>
7. &gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
      </p><p>
      The first line creates new entry in option-data table. It
      contains information on all global options that the server is
      supposed to configure in all subnets. The second line specifies
      option name. For a complete list of currently supported names,
      see <a class="xref" href="#dhcp6-std-options-list" title="Table 18.1. List of standard DHCPv6 options">Table 18.1, &#8220;List of standard DHCPv6 options&#8221;</a> below.
      The third line specifies option code, which must match one of the
      values from that
      list. Line 4 specifies option space, which must always
      be set to "dhcp6" as these are standard DHCPv6 options. For
      other name spaces, including custom option spaces, see <a class="xref" href="#dhcp6-option-spaces" title="18.2.6. Nested DHCPv6 options (custom option spaces)">Section 18.2.6, &#8220;Nested DHCPv6 options (custom option spaces)&#8221;</a>. The fifth line specifies the format in
      which the data will be entered: use of CSV (comma
      separated values) is recommended. The sixth line gives the actual value to
      be sent to clients. Data is specified as a normal text, with
      values separated by commas if more than one value is
      allowed.
    </p><p>
      Options can also be configured as hexadecimal values. If csv-format is
      set to false, the option data must be specified as a string of hexadecimal
      numbers. The
      following commands configure the DNS-SERVERS option for all
      subnets with the following addresses: 2001:db8:1::cafe and
      2001:db8:1::babe.
      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/name "dns-servers"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/code 23</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/space "dhcp6"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/csv-format false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/data "2001 0DB8 0001 0000 0000 0000</code></strong>
        <strong class="userinput"><code>0000 CAFE 2001 0DB8 0001 0000 0000 0000 0000 BABE"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
        </pre><p>
       (The value for the setting of the "data" element is split across two
        lines in this document for clarity: when entering the command, the
        whole string should be entered on the same line.)
      </p><p>
      It is possible to override options on a per-subnet basis.  If
      clients connected to most of your subnets are expected to get the
      same values of a given option, you should use global options: you
      can then override specific values for a small number of subnets.
      On the other hand, if you use different values in each subnet,
      it does not make sense to specify global option values
      (Dhcp6/option-data), rather you should set only subnet-specific values
      (Dhcp6/subnet[X]/option-data[Y]).
     </p><p>
      The following commands override the global
      DNS servers option for a particular subnet, setting a single DNS
      server with address 2001:db8:1::3.
      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/subnet6[0]/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[0]/option-data[0]/name "dns-servers"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[0]/option-data[0]/code 23</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[0]/option-data[0]/space "dhcp6"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[0]/option-data[0]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[0]/option-data[0]/data "2001:db8:1::3"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
    </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        In future versions of BIND 10 DHCP, it will not be necessary to specify
        option code, space and csv-format fields, as those fields will be set
        automatically.
      </p></div><p>
      Below is a list of currently supported standard DHCPv6 options. The "Name" and "Code"
      are the values that should be used as a name in the option-data
      structures. "Type" designates the format of the data: the meanings of
      the various types is given in <a class="xref" href="#dhcp-types" title="Table 17.2. List of standard DHCP option types">Table 17.2, &#8220;List of standard DHCP option types&#8221;</a>.
    </p><p>
      Some options are designated as arrays, which means that more than one
      value is allowed in such an option. For example the option dns-servers
      allows the specification of more than one IPv6 address, so allowing
      clients to obtain the the addresses of multiple DNS servers.
    </p><p>
      </p><table border="1" cellpadding="5%" id="dhcp6-std-options-list"><caption>Table 18.1. List of standard DHCPv6 options</caption><thead><tr><th>Name</th><th>Code</th><th>Type</th><th>Array?</th></tr><tr></tr></thead><tbody><tr><td>preference</td><td>7</td><td>uint8</td><td>false</td></tr><tr><td>sip-server-dns</td><td>21</td><td>fqdn</td><td>true</td></tr><tr><td>sip-server-addr</td><td>22</td><td>ipv6-address</td><td>true</td></tr><tr><td>dns-servers</td><td>23</td><td>ipv6-address</td><td>true</td></tr><tr><td>domain-search</td><td>24</td><td>fqdn</td><td>true</td></tr><tr><td>nis-servers</td><td>27</td><td>ipv6-address</td><td>true</td></tr><tr><td>nisp-servers</td><td>28</td><td>ipv6-address</td><td>true</td></tr><tr><td>nis-domain-name</td><td>29</td><td>fqdn</td><td>true</td></tr><tr><td>nisp-domain-name</td><td>30</td><td>fqdn</td><td>true</td></tr><tr><td>sntp-servers</td><td>31</td><td>ipv6-address</td><td>true</td></tr><tr><td>information-refresh-time</td><td>32</td><td>uint32</td><td>false</td></tr><tr><td>bcmcs-server-dns</td><td>33</td><td>fqdn</td><td>true</td></tr><tr><td>bcmcs-server-addr</td><td>34</td><td>ipv6-address</td><td>true</td></tr><tr><td>geoconf-civic</td><td>36</td><td>record</td><td>false</td></tr><tr><td>remote-id</td><td>37</td><td>record</td><td>false</td></tr><tr><td>subscriber-id</td><td>38</td><td>binary</td><td>false</td></tr><tr><td>client-fqdn</td><td>39</td><td>record</td><td>false</td></tr><tr><td>pana-agent</td><td>40</td><td>ipv6-address</td><td>true</td></tr><tr><td>new-posix-timezone</td><td>41</td><td>string</td><td>false</td></tr><tr><td>new-tzdb-timezone</td><td>42</td><td>string</td><td>false</td></tr><tr><td>ero</td><td>43</td><td>uint16</td><td>true</td></tr><tr><td>lq-query</td><td>44</td><td>record</td><td>false</td></tr><tr><td>client-data</td><td>45</td><td>empty</td><td>false</td></tr><tr><td>clt-time</td><td>46</td><td>uint32</td><td>false</td></tr><tr><td>lq-relay-data</td><td>47</td><td>record</td><td>false</td></tr><tr><td>lq-client-link</td><td>48</td><td>ipv6-address</td><td>true</td></tr></tbody></table><p>
    </p></div><div class="section" title="18.2.4. Custom DHCPv6 options"><div class="titlepage"><div><div><h3 class="title"><a name="dhcp6-custom-options"></a>18.2.4. Custom DHCPv6 options</h3></div></div></div><p>It is also possible to define options other than the standard ones.
      Assume that we want to define a new DHCPv6 option called "foo" which will have
      code 100 and will convey a single unsigned 32 bit integer value. We can define
      such an option by using the following commands:
      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/option-def</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/name "foo"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/code 100</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/type "uint32"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/array false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/record-types ""</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/space "dhcp6"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/encapsulate ""</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      The "false" value of the "array" parameter determines that the option
      does NOT comprise an array of "uint32" values but rather a single value.
      Two other parameters have been left blank: "record-types" and "encapsulate".
      The former specifies the comma separated list of option data fields if the
      option comprises a record of data fields. The "record-fields" value should
      be non-empty if the "type" is set to "record". Otherwise it must be left
      blank. The latter parameter specifies the name of the option space being
      encapsulated by the particular option. If the particular option does not
      encapsulate any option space it should be left blank.
      Note that the above set of comments define the format of the new option and do not
      set its values.
      </p><p>Once the new option format is defined, its value is set
      in the same way as for a standard option. For example the following
      commands set a global value that applies to all subnets.
        </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/name "foo"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/code 100</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/space "dhcp6"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/data "12345"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      </p><p>New options can take more complex forms than simple use of
      primitives (uint8, string, ipv6-address etc): it is possible to
      define an option comprising a number of existing primitives.
      </p><p>
      Assume we
      want to define a new option that will consist of an IPv6
      address, followed by unsigned 16 bit integer, followed by a text
      string. Such an option could be defined in the following way:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/option-def</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/name "bar"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/code 101</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/space "dhcp6"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/type "record"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/array false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/record-types "ipv6-address, uint16, string"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/encapsulate ""</code></strong>
</pre><p>
      The "type" is set to "record" to indicate that the option contains
      multiple values of different types.  These types are given as a comma-separated
      list in the "record-types" field and should be those listed in <a class="xref" href="#dhcp-types" title="Table 17.2. List of standard DHCP option types">Table 17.2, &#8220;List of standard DHCP option types&#8221;</a>.
      </p><p>
      The values of the option are set as follows:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/name "bar"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/space "dhcp6"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/code 101</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/data "2001:db8:1::10, 123, Hello World"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      </p>
      "csv-format" is set "true" to indicate that the "data" field comprises a command-separated
      list of values.  The values in the "data" must correspond to the types set in
      the "record-types" field of the option definition.
    </div><div class="section" title="18.2.5. DHCPv6 vendor specific options"><div class="titlepage"><div><div><h3 class="title"><a name="dhcp6-vendor-opts"></a>18.2.5. DHCPv6 vendor specific options</h3></div></div></div><p>
      Currently there are three option spaces defined: dhcp4 (to be used
      in DHCPv4 daemon) and dhcp6 (for the DHCPv6 daemon); there is also
      vendor-opts-space, which is empty by default, but options can be
      defined in it. Those options are called vendor-specific information
      options. The following examples show how to define an option "foo"
      with code 1 that consists of an IPv6 address, an unsigned 16 bit integer
      and a string. The "foo" option is conveyed in a vendor specific
      information option. This option comprises a single uint32 value
      that is set to "12345". The sub-option "foo" follows the data
      field holding this value.
      </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/option-def</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/name "foo"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/code 1</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/space "vendor-opts-space"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/type "record"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/array false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/record-types "ipv6-address, uint16, string"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/encapsulates ""</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
     (Note that the option space is set to "vendor-opts-space".)
     Once the option format is defined, the next step is to define actual values
     for that option:
     </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/name "foo"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/space "vendor-opts-space"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/code 1</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/data "2001:db8:1::10, 123, Hello World"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
    We should also define values for the vendor-opts, that will convey our option foo.
     </p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[1]/name "vendor-opts"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[1]/space "dhcp6"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[1]/code 17</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[1]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[1]/data "12345"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
      </p></div><div class="section" title="18.2.6. Nested DHCPv6 options (custom option spaces)"><div class="titlepage"><div><div><h3 class="title"><a name="dhcp6-option-spaces"></a>18.2.6. Nested DHCPv6 options (custom option spaces)</h3></div></div></div><p>It is sometimes useful to define completely new option
      spaces.  This is useful if the user wants his new option to
      convey sub-options that use separate numbering scheme, for
      example sub-options with codes 1 and 2. Those option codes
      conflict with standard DHCPv6 options, so a separate option
      space must be defined.
      </p><p>Note that it is not required to create new option space when
      defining sub-options for a standard option because it is by
      default created if the standard option is meant to convey
      any sub-options (see <a class="xref" href="#dhcp6-vendor-opts" title="18.2.5. DHCPv6 vendor specific options">Section 18.2.5, &#8220;DHCPv6 vendor specific options&#8221;</a>).
      </p><p>
      Assume that we want to have a DHCPv6 option called "container"
      with code 102 that conveys two sub-options with codes 1 and 2.
      First we need to define the new sub-options:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/option-def</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/name "subopt1"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/code 1</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/space "isc"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/type "ipv6-address"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/record-types ""</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/array false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[0]/encapsulate ""</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
&gt; <strong class="userinput"><code></code></strong>
&gt; <strong class="userinput"><code>config add Dhcp6/option-def</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[1]/name "subopt2"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[1]/code 2</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[1]/space "isc"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[1]/type "string"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[1]/record-types ""</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[1]/array false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[1]/encapsulate ""</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
    Note that we have defined the options to belong to a new option space
    (in this case, "isc").
    </p><p>
The next step is to define a regular DHCPv6 option and specify that it
should include options from the isc option space:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/option-def</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[2]/name "container"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[2]/code 102</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[2]/space "dhcp6"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[2]/type "empty"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[2]/array false</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[2]/record-types ""</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-def[2]/encapsulate "isc"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
    The name of the option space in which the sub-options are defined
    is set in the "encapsulate" field. The "type" field is set to "empty"
    which imposes that this option does not carry any data other than
    sub-options.
    </p><p>
    Finally, we can set values for the new options:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/name "subopt1"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/space "isc"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/code 1</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[0]/data "2001:db8::abcd"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
&gt; <strong class="userinput"><code></code></strong>
&gt; <strong class="userinput"><code>config add Dhcp6/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[1]/name "subopt2"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[1]/space "isc"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[1]/code 2</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[1]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[1]/data "Hello world"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
&gt; <strong class="userinput"><code></code></strong>
&gt; <strong class="userinput"><code>config add Dhcp6/option-data</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[2]/name "container"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[2]/space "dhcp6"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[2]/code 102</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[2]/csv-format true</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/option-data[2]/data ""</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
    Even though the "container" option does not carry any data except
    sub-options, the "data" field must be explicitly set to an empty value.
    This is required because in the current version of BIND 10 DHCP, the
    default configuration values are not propagated to the configuration parsers:
    if the "data" is not set the parser will assume that this
    parameter is not specified and an error will be reported.
    </p><p>Note that it is possible to create an option which carries some data
    in addition to the sub-options defined in the encapsulated option space.  For example,
    if the "container" option from the previous example was required to carry an uint16
    value as well as the sub-options, the "type" value would have to be set to "uint16" in
    the option definition. (Such an option would then have the following
    data structure: DHCP header, uint16 value, sub-options.) The value specified
    with the "data" parameter - which should be a valid integer enclosed in quotes,
    e.g. "123" - would then be assigned to the uint16 field in the "container" option.
    </p></div><div class="section" title="18.2.7. Subnet Selection"><div class="titlepage"><div><div><h3 class="title"><a name="dhcp6-config-subnets"></a>18.2.7. Subnet Selection</h3></div></div></div><p>
          The DHCPv6 server may receive requests from local (connected
          to the same subnet as the server) and remote (connecting via
          relays) clients.
          </p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          Currently relayed DHCPv6 traffic is not supported.  The server will
          only respond to local DHCPv6 requests - see <a class="xref" href="#dhcp6-limit" title="18.5. DHCPv6 Server Limitations">Section 18.5, &#8220;DHCPv6 Server Limitations&#8221;</a>
          </p></div><p>
          As it may have many subnet configurations defined, it
          must select appropriate subnet for a given request. To do this, the server first
          checks if there is only one subnet defined and source of the packet is
          link-local. If this is the case, the server assumes that the only subnet
          defined is local and client is indeed connected to it. This check
          simplifies small deployments.
          </p><p>
          If there are two or more subnets defined, the server can not assume
          which of those (if any) subnets are local. Therefore an optional
          "interface" parameter is available within a subnet definition to designate that a given subnet
          is local, i.e. reachable directly over specified interface. For example
          the server that is intended to serve a local subnet over eth0 may be configured
          as follows:
</p><pre class="screen">
&gt; <strong class="userinput"><code>config add Dhcp6/subnet6</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[1]/subnet "2001:db8:beef::/48"</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[1]/pool [ "2001:db8:beef::/48" ]</code></strong>
&gt; <strong class="userinput"><code>config set Dhcp6/subnet6[1]/interface "eth0"</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong>
</pre><p>
        </p></div></div><div class="section" title="18.3. Server Identifier in DHCPv6"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp6-serverid"></a>18.3. Server Identifier in DHCPv6</h2></div></div></div><p>The DHCPv6 protocol uses a "server identifier" (also known
      as a DUID) for clients to be able to discriminate between several
      servers present on the same link.  There are several types of
      DUIDs defined, but <a class="ulink" href="http://tools.ietf.org/html/rfc3315" target="_top">RFC 3315</a> instructs servers to use DUID-LLT if
      possible. This format consists of a link-layer (MAC) address and a
      timestamp. When started for the first time, the DHCPv6 server will
      automatically generate such a DUID and store the chosen value to
      a file.  That file is read by the server
      and the contained value used whenever the server is subsequently started.
      </p><p>
        It is unlikely that this parameter should ever need to be changed.
        However, if such a need arises, stop the server, edit the file and restart
        the server. (The file is named b10-dhcp6-serverid and by default is
        stored in the "var" subdirectory of the directory in which BIND 10 is installed.
        This can be changed when BIND 10 is built by using "--localstatedir"
        on the "configure" command line.)  The file is a text file that contains
        double digit hexadecimal values
        separated by colons. This format is similar to typical MAC address
        format. Spaces are ignored. No extra characters are allowed in this
        file.
      </p></div><div class="section" title="18.4. Supported Standards"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp6-std"></a>18.4. Supported Standards</h2></div></div></div><p>The following standards and draft standards are currently
      supported:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><a class="ulink" href="http://tools.ietf.org/html/rfc3315" target="_top">RFC 3315</a>: Supported messages are SOLICIT,
            ADVERTISE, REQUEST, RELEASE, RENEW, and REPLY.</li><li class="listitem"><a class="ulink" href="http://tools.ietf.org/html/rfc3646" target="_top">RFC 3646</a>: Supported option is DNS_SERVERS.</li></ul></div></div><div class="section" title="18.5. DHCPv6 Server Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dhcp6-limit"></a>18.5. DHCPv6 Server Limitations</h2></div></div></div><p> These are the current limitations and known problems
      with the DHCPv6 server
      software. Most of them are reflections of the early stage of
      development and should be treated as <span class="quote">&#8220;<span class="quote">not implemented
      yet</span>&#8221;</span>, rather than actual limitations.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
            On startup, the DHCPv6 server does not get the full configuration from
            BIND 10.  To remedy this, after starting BIND 10, modify any parameter
            and commit the changes, e.g.
            </p><pre class="screen">
&gt; <strong class="userinput"><code>config show Dhcp6/renew-timer</code></strong>
Dhcp6/renew-timer	1000	integer	(default)
&gt; <strong class="userinput"><code>config set Dhcp6/renew-timer 1001</code></strong>
&gt; <strong class="userinput"><code>config commit</code></strong></pre><p>
          </p></li><li class="listitem">Relayed traffic is not supported.</li><li class="listitem">Temporary addresses are not supported.</li><li class="listitem">Prefix delegation is not supported.</li><li class="listitem">Rebinding (REBIND), confirmation (CONFIRM),
          and duplication report (DECLINE) are not yet supported.</li><li class="listitem">DNS Update is not supported.</li><li class="listitem">Interface detection is currently working on Linux
          only. See <a class="xref" href="#iface-detect" title="19.1. Interface detection">Section 19.1, &#8220;Interface detection&#8221;</a> for details.</li></ul></div></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.idm64309680" href="#idm64309680" class="para">2</a>] </sup>
      The server comes with an in-memory database ("memfile") configured as the default
      database. This is used for internal testing and is not supported.  In addition,
      it does not store lease information on disk: lease information will be lost if the
      server is restarted.
      </p></div></div></div><div class="chapter" title="Chapter 19. libdhcp++ library"><div class="titlepage"><div><div><h2 class="title"><a name="libdhcp"></a>Chapter 19. libdhcp++ library</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#iface-detect">19.1. Interface detection</a></span></dt></dl></div><p>
      libdhcp++ is a common library written in C++ that handles
      many DHCP-related tasks, including:
      </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">DHCPv4 and DHCPv6 packets parsing, manipulation and assembly</li><li class="listitem">Option parsing, manipulation and assembly</li><li class="listitem">Network interface detection</li><li class="listitem">Socket operations such as creation, data transmission and reception and socket closing.</li></ul></div><p>
    </p><p>
    While this library is currently used by BIND 10 DHCP, it is designed to
    be a portable, universal library, useful for any kind of DHCP-related software.
    </p><div class="section" title="19.1. Interface detection"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="iface-detect"></a>19.1. Interface detection</h2></div></div></div><p>Both the DHCPv4 and DHCPv6 components share network
      interface detection routines. Interface detection is
      currently only supported on Linux systems.</p><p>For non-Linux systems, there is currently a stub
      implementation provided. The interface manager detects loopback
      interfaces only as their name (lo or lo0) can be easily predicted.
      Please contact the BIND 10 development team if you are interested
      in running DHCP components on systems other than Linux.</p></div></div><div class="chapter" title="Chapter 20. Statistics"><div class="titlepage"><div><div><h2 class="title"><a name="statistics"></a>Chapter 20. Statistics</h2></div></div></div><p>
      The <span class="command"><strong>b10-stats</strong></span> process is started by
      <span class="command"><strong>b10-init</strong></span>.
      It periodically collects statistics data from various modules
      and aggregates it.

    </p><p>

       This stats daemon provides commands to identify if it is
       running, show specified or all statistics data, and show specified
       or all statistics data schema.

       For example, using <span class="command"><strong>bindctl</strong></span>:

       </p><pre class="screen">
&gt; <strong class="userinput"><code>Stats show</code></strong>
{
    "Auth": {
        "opcode.iquery": 0,
        "opcode.notify": 10,
        "opcode.query": 869617,
        ...
        "queries.tcp": 1749,
        "queries.udp": 867868
    },
    "Init": {
        "boot_time": "2011-01-20T16:59:03Z"
    },
    "Stats": {
        "boot_time": "2011-01-20T16:59:05Z",
        "last_update_time": "2011-01-20T17:04:05Z",
        "lname": "4d3869d9_a@jreed.example.net",
        "report_time": "2011-01-20T17:04:06Z",
        "timestamp": 1295543046.823504
    }
}
       </pre><p>
    </p></div><div class="chapter" title="Chapter 21. Logging"><div class="titlepage"><div><div><h2 class="title"><a name="logging"></a>Chapter 21. Logging</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#idm68223536">21.1. Logging configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#idm68222256">21.1.1. Loggers</a></span></dt><dt><span class="section"><a href="#idm68180784">21.1.2. Output Options</a></span></dt><dt><span class="section"><a href="#idm68158768">21.1.3. Example session</a></span></dt></dl></dd><dt><span class="section"><a href="#idm68133552">21.2. Logging Message Format</a></span></dt></dl></div><div class="section" title="21.1. Logging configuration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm68223536"></a>21.1. Logging configuration</h2></div></div></div><p>

        The logging system in BIND 10 is configured through the
        Logging module. All BIND 10 modules will look at the
        configuration in Logging to see what should be logged and
        to where.



      </p><div class="section" title="21.1.1. Loggers"><div class="titlepage"><div><div><h3 class="title"><a name="idm68222256"></a>21.1.1. Loggers</h3></div></div></div><p>

          Within BIND 10, a message is logged through a component
          called a "logger". Different parts of BIND 10 log messages
          through different loggers, and each logger can be configured
          independently of one another.

        </p><p>

          In the Logging module, you can specify the configuration
          for zero or more loggers; any that are not specified will
          take appropriate default values.

        </p><p>

          The three most important elements of a logger configuration
          are the <code class="option">name</code> (the component that is
          generating the messages), the <code class="option">severity</code>
          (what to log), and the <code class="option">output_options</code>
          (where to log).

        </p><div class="section" title="21.1.1.1. name (string)"><div class="titlepage"><div><div><h4 class="title"><a name="idm68219184"></a>21.1.1.1. name (string)</h4></div></div></div><p>
          Each logger in the system has a name, the name being that
          of the component using it to log messages. For instance,
          if you want to configure logging for the resolver module,
          you add an entry for a logger named <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>. This
          configuration will then be used by the loggers in the
          Resolver module, and all the libraries used by it.
              </p><p>

          If you want to specify logging for one specific library
          within the module, you set the name to
          <em class="replaceable"><code>module.library</code></em>.  For example, the
          logger used by the nameserver address store component
          has the full name of <span class="quote">&#8220;<span class="quote">Resolver.nsas</span>&#8221;</span>. If
          there is no entry in Logging for a particular library,
          it will use the configuration given for the module.



        </p><p>



          To illustrate this, suppose you want the cache library
          to log messages of severity DEBUG, and the rest of the
          resolver code to log messages of severity INFO. To achieve
          this you specify two loggers, one with the name
          <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span> and severity INFO, and one with
          the name <span class="quote">&#8220;<span class="quote">Resolver.cache</span>&#8221;</span> with severity
          DEBUG. As there are no entries for other libraries (e.g.
          the nsas), they will use the configuration for the module
          (<span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>), so giving the desired behavior.

        </p><p>

          One special case is that of a module name of <span class="quote">&#8220;<span class="quote">*</span>&#8221;</span>
          (asterisks), which is interpreted as <span class="emphasis"><em>any</em></span>
          module. You can set global logging options by using this,
          including setting the logging configuration for a library
          that is used by multiple modules (e.g. <span class="quote">&#8220;<span class="quote">*.config</span>&#8221;</span>
          specifies the configuration library code in whatever
          module is using it).

        </p><p>

          If there are multiple logger specifications in the
          configuration that might match a particular logger, the
          specification with the more specific logger name takes
          precedence. For example, if there are entries for
          both <span class="quote">&#8220;<span class="quote">*</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>, the
          resolver module &#8212; and all libraries it uses &#8212;
          will log messages according to the configuration in the
          second entry (<span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>). All other modules
          will use the configuration of the first entry
          (<span class="quote">&#8220;<span class="quote">*</span>&#8221;</span>). If there was also a configuration
          entry for <span class="quote">&#8220;<span class="quote">Resolver.cache</span>&#8221;</span>, the cache library
          within the resolver would use that in preference to the
          entry for <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>.

        </p><p>

          One final note about the naming. When specifying the
          module name within a logger, use the name of the module
          as specified in <span class="command"><strong>bindctl</strong></span>, e.g.
          <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span> for the resolver module,
          <span class="quote">&#8220;<span class="quote">Xfrout</span>&#8221;</span> for the xfrout module, etc. When
          the message is logged, the message will include the name
          of the logger generating the message, but with the module
          name replaced by the name of the process implementing
          the module (so for example, a message generated by the
          <span class="quote">&#8220;<span class="quote">Auth.cache</span>&#8221;</span> logger will appear in the output
          with a logger name of <span class="quote">&#8220;<span class="quote">b10-auth.cache</span>&#8221;</span>).

        </p></div><div class="section" title="21.1.1.2. severity (string)"><div class="titlepage"><div><div><h4 class="title"><a name="idm68207152"></a>21.1.1.2. severity (string)</h4></div></div></div><p>

          This specifies the category of messages logged.
          Each message is logged with an associated severity which
          may be one of the following (in descending order of
          severity):
        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"> FATAL </li><li class="listitem"> ERROR </li><li class="listitem"> WARN </li><li class="listitem"> INFO </li><li class="listitem"> DEBUG </li></ul></div><p>

          When the severity of a logger is set to one of these
          values, it will only log messages of that severity, and
          the severities above it. The severity may also be set to
          NONE, in which case all messages from that logger are
          inhibited.



        </p></div><div class="section" title="21.1.1.3. output_options (list)"><div class="titlepage"><div><div><h4 class="title"><a name="idm68201136"></a>21.1.1.3. output_options (list)</h4></div></div></div><p>

          Each logger can have zero or more
          <code class="option">output_options</code>. These specify where log
          messages are sent to. These are explained in detail below.

        </p><p>

          The other options for a logger are:

        </p></div><div class="section" title="21.1.1.4. debuglevel (integer)"><div class="titlepage"><div><div><h4 class="title"><a name="idm68199216"></a>21.1.1.4. debuglevel (integer)</h4></div></div></div><p>

          When a logger's severity is set to DEBUG, this value
          specifies what debug messages should be printed. It ranges
          from 0 (least verbose) to 99 (most verbose).
        </p><p>

          If severity for the logger is not DEBUG, this value is ignored.

        </p></div><div class="section" title="21.1.1.5. additive (true or false)"><div class="titlepage"><div><div><h4 class="title"><a name="idm68185008"></a>21.1.1.5. additive (true or false)</h4></div></div></div><p>

          If this is true, the <code class="option">output_options</code> from
          the parent will be used. For example, if there are two
          loggers configured; <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span> and
          <span class="quote">&#8220;<span class="quote">Resolver.cache</span>&#8221;</span>, and <code class="option">additive</code>
          is true in the second, it will write the log messages
          not only to the destinations specified for
          <span class="quote">&#8220;<span class="quote">Resolver.cache</span>&#8221;</span>, but also to the destinations
          as specified in the <code class="option">output_options</code> in
          the logger named <span class="quote">&#8220;<span class="quote">Resolver</span>&#8221;</span>.



      </p></div></div><div class="section" title="21.1.2. Output Options"><div class="titlepage"><div><div><h3 class="title"><a name="idm68180784"></a>21.1.2. Output Options</h3></div></div></div><p>

          The main settings for an output option are the
          <code class="option">destination</code> and a value called
          <code class="option">output</code>, the meaning of which depends on
          the destination that is set.

        </p><div class="section" title="21.1.2.1. destination (string)"><div class="titlepage"><div><div><h4 class="title"><a name="idm68178992"></a>21.1.2.1. destination (string)</h4></div></div></div><p>

            The destination is the type of output. It can be one of:

          </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"> console </li><li class="listitem"> file </li><li class="listitem"> syslog </li></ul></div></div><div class="section" title="21.1.2.2. output (string)"><div class="titlepage"><div><div><h4 class="title"><a name="idm68175024"></a>21.1.2.2. output (string)</h4></div></div></div><p>

          Depending on what is set as the output destination, this
          value is interpreted as follows:

        </p><div class="variablelist"><dl><dt><span class="term"><code class="option">destination</code> is <span class="quote">&#8220;<span class="quote">console</span>&#8221;</span></span></dt><dd><p>
                 The value of output must be one of <span class="quote">&#8220;<span class="quote">stdout</span>&#8221;</span>
                 (messages printed to standard output) or
                 <span class="quote">&#8220;<span class="quote">stderr</span>&#8221;</span> (messages printed to standard
                 error).
              </p><p>
                Note: if output is set to <span class="quote">&#8220;<span class="quote">stderr</span>&#8221;</span> and a lot of
                messages are produced in a short time (e.g. if the logging
                level is set to DEBUG), you may occasionally see some messages
                jumbled up together.  This is due to a combination of the way
                that messages are written to the screen and the unbuffered
                nature of the standard error stream.  If this occurs, it is
                recommended that output be set to <span class="quote">&#8220;<span class="quote">stdout</span>&#8221;</span>.
              </p></dd><dt><span class="term"><code class="option">destination</code> is <span class="quote">&#8220;<span class="quote">file</span>&#8221;</span></span></dt><dd><p>
                The value of output is interpreted as a file name;
                log messages will be appended to this file.
              </p></dd><dt><span class="term"><code class="option">destination</code> is <span class="quote">&#8220;<span class="quote">syslog</span>&#8221;</span></span></dt><dd><p>
                The value of output is interpreted as the
                <span class="command"><strong>syslog</strong></span> facility (e.g.
                <span class="emphasis"><em>local0</em></span>) that should be used
                for log messages.
              </p></dd></dl></div><p>

          The other options for <code class="option">output_options</code> are:

        </p><div class="section" title="21.1.2.2.1. flush (true of false)"><div class="titlepage"><div><div><h5 class="title"><a name="idm68163760"></a>21.1.2.2.1. flush (true of false)</h5></div></div></div><p>
            Flush buffers after each log message. Doing this will
            reduce performance but will ensure that if the program
            terminates abnormally, all messages up to the point of
            termination are output.
          </p></div><div class="section" title="21.1.2.2.2. maxsize (integer)"><div class="titlepage"><div><div><h5 class="title"><a name="idm68162608"></a>21.1.2.2.2. maxsize (integer)</h5></div></div></div><p>
            Only relevant when destination is file, this is maximum
            file size of output files in bytes. When the maximum
            size is reached, the file is renamed and a new file opened.
            (For example, a ".1" is appended to the name &#8212;
            if a ".1" file exists, it is renamed ".2",
            etc.)
          </p><p>
            If this is 0, no maximum file size is used.
          </p></div><div class="section" title="21.1.2.2.3. maxver (integer)"><div class="titlepage"><div><div><h5 class="title"><a name="idm68161072"></a>21.1.2.2.3. maxver (integer)</h5></div></div></div><p>
            Maximum number of old log files to keep around when
            rolling the output file. Only relevant when
            <code class="option">destination</code> is <span class="quote">&#8220;<span class="quote">file</span>&#8221;</span>.
          </p></div></div></div><div class="section" title="21.1.3. Example session"><div class="titlepage"><div><div><h3 class="title"><a name="idm68158768"></a>21.1.3. Example session</h3></div></div></div><p>

          In this example we want to set the global logging to
          write to the file <code class="filename">/var/log/my_bind10.log</code>,
          at severity WARN. We want the authoritative server to
          log at DEBUG with debuglevel 40, to a different file
          (<code class="filename">/tmp/debug_messages</code>).

        </p><p>

          Start <span class="command"><strong>bindctl</strong></span>.

        </p><p>

           </p><pre class="screen">["login success "]
&gt; <strong class="userinput"><code>config show Logging</code></strong>
Logging/loggers	[]	list
</pre><p>

        </p><p>

          By default, no specific loggers are configured, in which
          case the severity defaults to INFO and the output is
          written to stderr.

        </p><p>

          Let's first add a default logger:

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code>config add Logging/loggers</code></strong>
&gt; <strong class="userinput"><code>config show Logging</code></strong>
Logging/loggers/	list	(modified)
</pre><p>

        </p><p>

          The loggers value line changed to indicate that it is no
          longer an empty list:

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code>config show Logging/loggers</code></strong>
Logging/loggers[0]/name	""	string	(default)
Logging/loggers[0]/severity	"INFO"	string	(default)
Logging/loggers[0]/debuglevel	0	integer	(default)
Logging/loggers[0]/additive	false	boolean	(default)
Logging/loggers[0]/output_options	[]	list	(default)
</pre><p>

        </p><p>

          The name is mandatory, so we must set it. We will also
          change the severity as well. Let's start with the global
          logger.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code>config set Logging/loggers[0]/name *</code></strong>
&gt; <strong class="userinput"><code>config set Logging/loggers[0]/severity WARN</code></strong>
&gt; <strong class="userinput"><code>config show Logging/loggers</code></strong>
Logging/loggers[0]/name	"*"	string	(modified)
Logging/loggers[0]/severity	"WARN"	string	(modified)
Logging/loggers[0]/debuglevel	0	integer	(default)
Logging/loggers[0]/additive	false	boolean	(default)
Logging/loggers[0]/output_options	[]	list	(default)
</pre><p>

        </p><p>

          Of course, we need to specify where we want the log
          messages to go, so we add an entry for an output option.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config add Logging/loggers[0]/output_options</code></strong>
&gt; <strong class="userinput"><code> config show Logging/loggers[0]/output_options</code></strong>
Logging/loggers[0]/output_options[0]/destination	"console"	string	(default)
Logging/loggers[0]/output_options[0]/output	"stdout"	string	(default)
Logging/loggers[0]/output_options[0]/flush	false	boolean	(default)
Logging/loggers[0]/output_options[0]/maxsize	0	integer	(default)
Logging/loggers[0]/output_options[0]/maxver	0	integer	(default)
</pre><p>


        </p><p>

          These aren't the values we are looking for.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config set Logging/loggers[0]/output_options[0]/destination file</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[0]/output_options[0]/output /var/log/bind10.log</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[0]/output_options[0]/maxsize 204800</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[0]/output_options[0]/maxver 8</code></strong>
</pre><p>

        </p><p>

          Which would make the entire configuration for this logger
          look like:

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config show all Logging/loggers</code></strong>
Logging/loggers[0]/name	"*"	string	(modified)
Logging/loggers[0]/severity	"WARN"	string	(modified)
Logging/loggers[0]/debuglevel	0	integer	(default)
Logging/loggers[0]/additive	false	boolean	(default)
Logging/loggers[0]/output_options[0]/destination	"file"	string	(modified)
Logging/loggers[0]/output_options[0]/output	"/var/log/bind10.log"	string	(modified)
Logging/loggers[0]/output_options[0]/flush	false	boolean	(default)
Logging/loggers[0]/output_options[0]/maxsize	204800	integer	(modified)
Logging/loggers[0]/output_options[0]/maxver	8	integer	(modified)
</pre><p>

        </p><p>

          That looks OK, so let's commit it before we add the
          configuration for the authoritative server's logger.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config commit</code></strong></pre><p>

        </p><p>

          Now that we have set it, and checked each value along
          the way, adding a second entry is quite similar.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config add Logging/loggers</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[1]/name Auth</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[1]/severity DEBUG</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[1]/debuglevel 40</code></strong>
&gt; <strong class="userinput"><code> config add Logging/loggers[1]/output_options</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[1]/output_options[0]/destination file</code></strong>
&gt; <strong class="userinput"><code> config set Logging/loggers[1]/output_options[0]/output /tmp/auth_debug.log</code></strong>
&gt; <strong class="userinput"><code> config commit</code></strong>
</pre><p>

        </p><p>

          And that's it. Once we have found whatever it was we
          needed the debug messages for, we can simply remove the
          second logger to let the authoritative server use the
          same settings as the rest.

        </p><p>

          </p><pre class="screen">&gt; <strong class="userinput"><code> config remove Logging/loggers[1]</code></strong>
&gt; <strong class="userinput"><code> config commit</code></strong>
</pre><p>

        </p><p>

          And every module will now be using the values from the
          logger named <span class="quote">&#8220;<span class="quote">*</span>&#8221;</span>.

        </p></div></div><div class="section" title="21.2. Logging Message Format"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm68133552"></a>21.2. Logging Message Format</h2></div></div></div><p>
          Each message written by BIND 10 to the configured logging
          destinations comprises a number of components that identify
          the origin of the message and, if the message indicates
          a problem, information about the problem that may be
          useful in fixing it.
      </p><p>
          Consider the message below logged to a file:
          </p><pre class="screen">2011-06-15 13:48:22.034 ERROR [b10-resolver.asiolink]
    ASIODNS_OPENSOCK error 111 opening TCP socket to 127.0.0.1(53)</pre><p>
      </p><p>
        Note: the layout of messages written to the system logging
        file (syslog) may be slightly different.  This message has
        been split across two lines here for display reasons; in the
        logging file, it will appear on one line.)
      </p><p>
        The log message comprises a number of components:

          </p><div class="variablelist"><dl><dt><span class="term">2011-06-15 13:48:22.034</span></dt><dd><p>
              The date and time at which the message was generated.
          </p></dd><dt><span class="term">ERROR</span></dt><dd><p>
              The severity of the message.
          </p></dd><dt><span class="term">[b10-resolver.asiolink]</span></dt><dd><p>
            The source of the message.  This comprises two components:
            the BIND 10 process generating the message (in this
            case, <span class="command"><strong>b10-resolver</strong></span>) and the module
            within the program from which the message originated
            (which in the example is the asynchronous I/O link
            module, asiolink).
          </p></dd><dt><span class="term">ASIODNS_OPENSOCK</span></dt><dd><p>
            The message identification.  Every message in BIND 10
            has a unique identification, which can be used as an
            index into the <a class="ulink" href="bind10-messages.html" target="_top"><em class="citetitle">BIND 10 Messages
            Manual</em></a> (<a class="ulink" href="http://bind10.isc.org/docs/bind10-messages.html" target="_top">http://bind10.isc.org/docs/bind10-messages.html</a>) from which more information can be obtained.
          </p></dd><dt><span class="term">error 111 opening TCP socket to 127.0.0.1(53)</span></dt><dd><p>
              A brief description of the cause of the problem.
              Within this text, information relating to the condition
              that caused the message to be logged will be included.
              In this example, error number 111 (an operating
              system-specific error number) was encountered when
              trying to open a TCP connection to port 53 on the
              local system (address 127.0.0.1).  The next step
              would be to find out the reason for the failure by
              consulting your system's documentation to identify
              what error number 111 means.
          </p></dd></dl></div><p>
      </p></div></div></div></body></html>
